import{c as l,A as B,_ as W,u as X,r as x,w as Y,a as y,o as v,b as _,d as a,e as A,f as i,n as R,t as S,g as d,h as E,i as F,S as ye,D as be,F as J,j as Q,k as Oe,E as Ce,C as je,l as Z,p as $e,m as Le,q as De,s as K,v as ze,x as Ne,y as ee,z as Te,B as He,G as Ve}from"./index-5519999e.js";import{s as G,d as xe,u as te,g as Fe}from"./utils-5dfaf7e4.js";var Ee={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M391 240.9c-.8-6.6-8.9-9.4-13.6-4.7l-43.7 43.7L200 146.3a8.03 8.03 0 00-11.3 0l-42.4 42.3a8.03 8.03 0 000 11.3L280 333.6l-43.9 43.9a8.01 8.01 0 004.7 13.6L401 410c5.1.6 9.5-3.7 8.9-8.9L391 240.9zm10.1 373.2L240.8 633c-6.6.8-9.4 8.9-4.7 13.6l43.9 43.9L146.3 824a8.03 8.03 0 000 11.3l42.4 42.3c3.1 3.1 8.2 3.1 11.3 0L333.7 744l43.7 43.7A8.01 8.01 0 00391 783l18.9-160.1c.6-5.1-3.7-9.4-8.8-8.8zm221.8-204.2L783.2 391c6.6-.8 9.4-8.9 4.7-13.6L744 333.6 877.7 200c3.1-3.1 3.1-8.2 0-11.3l-42.4-42.3a8.03 8.03 0 00-11.3 0L690.3 279.9l-43.7-43.7a8.01 8.01 0 00-13.6 4.7L614.1 401c-.6 5.2 3.7 9.5 8.8 8.9zM744 690.4l43.9-43.9a8.01 8.01 0 00-4.7-13.6L623 614c-5.1-.6-9.5 3.7-8.9 8.9L633 783.1c.8 6.6 8.9 9.4 13.6 4.7l43.7-43.7L824 877.7c3.1 3.1 8.2 3.1 11.3 0l42.4-42.3c3.1-3.1 3.1-8.2 0-11.3L744 690.4z"}}]},name:"fullscreen-exit",theme:"outlined"};const Re=Ee;function ue(n){for(var e=1;e<arguments.length;e++){var t=arguments[e]!=null?Object(arguments[e]):{},s=Object.keys(t);typeof Object.getOwnPropertySymbols=="function"&&(s=s.concat(Object.getOwnPropertySymbols(t).filter(function(c){return Object.getOwnPropertyDescriptor(t,c).enumerable}))),s.forEach(function(c){Ae(n,c,t[c])})}return n}function Ae(n,e,t){return e in n?Object.defineProperty(n,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):n[e]=t,n}var ne=function(e,t){var s=ue({},e,t.attrs);return l(B,ue({},s,{icon:Re}),null)};ne.displayName="FullscreenExitOutlined";ne.inheritAttrs=!1;const Be=ne;var Ue={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M290 236.4l43.9-43.9a8.01 8.01 0 00-4.7-13.6L169 160c-5.1-.6-9.5 3.7-8.9 8.9L179 329.1c.8 6.6 8.9 9.4 13.6 4.7l43.7-43.7L370 423.7c3.1 3.1 8.2 3.1 11.3 0l42.4-42.3c3.1-3.1 3.1-8.2 0-11.3L290 236.4zm352.7 187.3c3.1 3.1 8.2 3.1 11.3 0l133.7-133.6 43.7 43.7a8.01 8.01 0 0013.6-4.7L863.9 169c.6-5.1-3.7-9.5-8.9-8.9L694.8 179c-6.6.8-9.4 8.9-4.7 13.6l43.9 43.9L600.3 370a8.03 8.03 0 000 11.3l42.4 42.4zM845 694.9c-.8-6.6-8.9-9.4-13.6-4.7l-43.7 43.7L654 600.3a8.03 8.03 0 00-11.3 0l-42.4 42.3a8.03 8.03 0 000 11.3L734 787.6l-43.9 43.9a8.01 8.01 0 004.7 13.6L855 864c5.1.6 9.5-3.7 8.9-8.9L845 694.9zm-463.7-94.6a8.03 8.03 0 00-11.3 0L236.3 733.9l-43.7-43.7a8.01 8.01 0 00-13.6 4.7L160.1 855c-.6 5.1 3.7 9.5 8.9 8.9L329.2 845c6.6-.8 9.4-8.9 4.7-13.6L290 787.6 423.7 654c3.1-3.1 3.1-8.2 0-11.3l-42.4-42.4z"}}]},name:"fullscreen",theme:"outlined"};const qe=Ue;function de(n){for(var e=1;e<arguments.length;e++){var t=arguments[e]!=null?Object(arguments[e]):{},s=Object.keys(t);typeof Object.getOwnPropertySymbols=="function"&&(s=s.concat(Object.getOwnPropertySymbols(t).filter(function(c){return Object.getOwnPropertyDescriptor(t,c).enumerable}))),s.forEach(function(c){Ge(n,c,t[c])})}return n}function Ge(n,e,t){return e in n?Object.defineProperty(n,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):n[e]=t,n}var se=function(e,t){var s=de({},e,t.attrs);return l(B,de({},s,{icon:qe}),null)};se.displayName="FullscreenOutlined";se.inheritAttrs=!1;const Ye=se;var Je={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M408 442h480c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8H408c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8zm-8 204c0 4.4 3.6 8 8 8h480c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8H408c-4.4 0-8 3.6-8 8v56zm504-486H120c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8h784c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8zm0 632H120c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8h784c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8zM142.4 642.1L298.7 519a8.84 8.84 0 000-13.9L142.4 381.9c-5.8-4.6-14.4-.5-14.4 6.9v246.3a8.9 8.9 0 0014.4 7z"}}]},name:"menu-unfold",theme:"outlined"};const Qe=Je;function ve(n){for(var e=1;e<arguments.length;e++){var t=arguments[e]!=null?Object(arguments[e]):{},s=Object.keys(t);typeof Object.getOwnPropertySymbols=="function"&&(s=s.concat(Object.getOwnPropertySymbols(t).filter(function(c){return Object.getOwnPropertyDescriptor(t,c).enumerable}))),s.forEach(function(c){We(n,c,t[c])})}return n}function We(n,e,t){return e in n?Object.defineProperty(n,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):n[e]=t,n}var le=function(e,t){var s=ve({},e,t.attrs);return l(B,ve({},s,{icon:Qe}),null)};le.displayName="MenuUnfoldOutlined";le.inheritAttrs=!1;const Pe=le;var Xe={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M512 64C264.6 64 64 264.6 64 512s200.6 448 448 448 448-200.6 448-448S759.4 64 512 64zm0 820c-205.4 0-372-166.6-372-372s166.6-372 372-372 372 166.6 372 372-166.6 372-372 372zm-88-532h-48c-4.4 0-8 3.6-8 8v304c0 4.4 3.6 8 8 8h48c4.4 0 8-3.6 8-8V360c0-4.4-3.6-8-8-8zm224 0h-48c-4.4 0-8 3.6-8 8v304c0 4.4 3.6 8 8 8h48c4.4 0 8-3.6 8-8V360c0-4.4-3.6-8-8-8z"}}]},name:"pause-circle",theme:"outlined"};const Ze=Xe;function me(n){for(var e=1;e<arguments.length;e++){var t=arguments[e]!=null?Object(arguments[e]):{},s=Object.keys(t);typeof Object.getOwnPropertySymbols=="function"&&(s=s.concat(Object.getOwnPropertySymbols(t).filter(function(c){return Object.getOwnPropertyDescriptor(t,c).enumerable}))),s.forEach(function(c){Ke(n,c,t[c])})}return n}function Ke(n,e,t){return e in n?Object.defineProperty(n,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):n[e]=t,n}var ie=function(e,t){var s=me({},e,t.attrs);return l(B,me({},s,{icon:Ze}),null)};ie.displayName="PauseCircleOutlined";ie.inheritAttrs=!1;const Me=ie;var et={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M512 64C264.6 64 64 264.6 64 512s200.6 448 448 448 448-200.6 448-448S759.4 64 512 64zm0 820c-205.4 0-372-166.6-372-372s166.6-372 372-372 372 166.6 372 372-166.6 372-372 372z"}},{tag:"path",attrs:{d:"M719.4 499.1l-296.1-215A15.9 15.9 0 00398 297v430c0 13.1 14.8 20.5 25.3 12.9l296.1-215a15.9 15.9 0 000-25.8zm-257.6 134V390.9L628.5 512 461.8 633.1z"}}]},name:"play-circle",theme:"outlined"};const tt=et;function pe(n){for(var e=1;e<arguments.length;e++){var t=arguments[e]!=null?Object(arguments[e]):{},s=Object.keys(t);typeof Object.getOwnPropertySymbols=="function"&&(s=s.concat(Object.getOwnPropertySymbols(t).filter(function(c){return Object.getOwnPropertyDescriptor(t,c).enumerable}))),s.forEach(function(c){nt(n,c,t[c])})}return n}function nt(n,e,t){return e in n?Object.defineProperty(n,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):n[e]=t,n}var ae=function(e,t){var s=pe({},e,t.attrs);return l(B,pe({},s,{icon:tt}),null)};ae.displayName="PlayCircleOutlined";ae.inheritAttrs=!1;const Se=ae;var st={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M912 192H328c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8h584c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8zm0 284H328c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8h584c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8zm0 284H328c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8h584c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8zM104 228a56 56 0 10112 0 56 56 0 10-112 0zm0 284a56 56 0 10112 0 56 56 0 10-112 0zm0 284a56 56 0 10112 0 56 56 0 10-112 0z"}}]},name:"unordered-list",theme:"outlined"};const lt=st;function fe(n){for(var e=1;e<arguments.length;e++){var t=arguments[e]!=null?Object(arguments[e]):{},s=Object.keys(t);typeof Object.getOwnPropertySymbols=="function"&&(s=s.concat(Object.getOwnPropertySymbols(t).filter(function(c){return Object.getOwnPropertyDescriptor(t,c).enumerable}))),s.forEach(function(c){it(n,c,t[c])})}return n}function it(n,e,t){return e in n?Object.defineProperty(n,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):n[e]=t,n}var ce=function(e,t){var s=fe({},e,t.attrs);return l(B,fe({},s,{icon:lt}),null)};ce.displayName="UnorderedListOutlined";ce.inheritAttrs=!1;const at=ce;var ct={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M762 164h-64c-4.4 0-8 3.6-8 8v688c0 4.4 3.6 8 8 8h64c4.4 0 8-3.6 8-8V172c0-4.4-3.6-8-8-8zm-508 0v72.4c0 9.5 4.2 18.4 11.4 24.5L564.6 512 265.4 763.1c-7.2 6.1-11.4 15-11.4 24.5V860c0 6.8 7.9 10.5 13.1 6.1L689 512 267.1 157.9A7.95 7.95 0 00254 164z"}}]},name:"vertical-left",theme:"outlined"};const ot=ct;function ge(n){for(var e=1;e<arguments.length;e++){var t=arguments[e]!=null?Object(arguments[e]):{},s=Object.keys(t);typeof Object.getOwnPropertySymbols=="function"&&(s=s.concat(Object.getOwnPropertySymbols(t).filter(function(c){return Object.getOwnPropertyDescriptor(t,c).enumerable}))),s.forEach(function(c){rt(n,c,t[c])})}return n}function rt(n,e,t){return e in n?Object.defineProperty(n,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):n[e]=t,n}var oe=function(e,t){var s=ge({},e,t.attrs);return l(B,ge({},s,{icon:ot}),null)};oe.displayName="VerticalLeftOutlined";oe.inheritAttrs=!1;const ke=oe;var ut={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M326 164h-64c-4.4 0-8 3.6-8 8v688c0 4.4 3.6 8 8 8h64c4.4 0 8-3.6 8-8V172c0-4.4-3.6-8-8-8zm444 72.4V164c0-6.8-7.9-10.5-13.1-6.1L335 512l421.9 354.1c5.2 4.4 13.1.7 13.1-6.1v-72.4c0-9.4-4.2-18.4-11.4-24.5L459.4 512l299.2-251.1c7.2-6.1 11.4-15.1 11.4-24.5z"}}]},name:"vertical-right",theme:"outlined"};const dt=ut;function he(n){for(var e=1;e<arguments.length;e++){var t=arguments[e]!=null?Object(arguments[e]):{},s=Object.keys(t);typeof Object.getOwnPropertySymbols=="function"&&(s=s.concat(Object.getOwnPropertySymbols(t).filter(function(c){return Object.getOwnPropertyDescriptor(t,c).enumerable}))),s.forEach(function(c){vt(n,c,t[c])})}return n}function vt(n,e,t){return e in n?Object.defineProperty(n,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):n[e]=t,n}var re=function(e,t){var s=he({},e,t.attrs);return l(B,he({},s,{icon:dt}),null)};re.displayName="VerticalRightOutlined";re.inheritAttrs=!1;const we=re;const mt={class:"music-box"},pt={key:0,class:"info"},ft={key:1,class:"info"},gt=["src"],ht={class:"center"},_t={class:"prev-next"},yt={class:"progress-box"},bt={class:"ctrl"},Ot=["title"],Ct={class:"mode"},$t={__name:"MusicCtrl",props:{musicCurrentTime:{type:Number,default:0},musicDuration:{type:Number,default:0},prevMusic:{type:String,default:""},nextMusic:{type:String,default:""},musicMode:{type:String,default:""}},emits:["toggleMusicList","showSearch","handleDurationChange","handlePlay","handlePause","handlePrev","handleNext","showLyric"],setup(n,{emit:e}){const t=n,{useMusicStore:s}=X(),c=x(0);Y(()=>t.musicCurrentTime,u=>{c.value=u},{immediate:!0,deep:!0});const b=()=>{e("toggleMusicList")},j=()=>{e("showSearch")},P=u=>{s.changeMode(u)},L=u=>{s.toggleMute(u)},g=x({});Y(()=>[s.activeIndex,s.settings.playing],()=>{g.value=s.musicList[s.activeIndex]||{}},{immediate:!0,deep:!0});const w=u=>G(u),T=u=>{e("handleDurationChange",u)},N=()=>{e("handlePlay")},H=()=>{e("handlePause")},D=()=>{e("handlePrev")},V=()=>{e("handleNext")},k=()=>{e("showLyric")};return(u,o)=>{const p=y("a-tooltip"),O=y("a-slider"),m=y("a-divider");return v(),_("div",mt,[a(s).musicList.length?(v(),_("div",ft,[i("div",{class:"cover",onClick:k},[i("img",{class:R({playing:a(s).settings.playing}),src:g.value.cover,onerror:"this.src='./images/music.png'",alt:""},null,10,gt)]),A(" "+S(g.value.name)+" - "+S(g.value.singer),1)])):(v(),_("div",pt,[A(" 暂无音乐，请选择"),i("span",{class:"add",onClick:j},"添加")])),i("div",ht,[i("div",_t,[l(p,{title:`上一首${n.prevMusic?"：":""}${n.prevMusic}`},{default:d(()=>[l(a(we),{onClick:D})]),_:1},8,["title"]),l(p,{title:a(s).settings.playing?"点击暂停":"点击播放"},{default:d(()=>[a(s).settings.playing?(v(),E(a(Me),{key:1,class:"pause",onClick:H})):(v(),E(a(Se),{key:0,class:"play",onClick:N}))]),_:1},8,["title"]),l(p,{title:`下一首${n.nextMusic?"：":""}${n.nextMusic}`},{default:d(()=>[l(a(ke),{onClick:V})]),_:1},8,["title"])]),i("div",yt,[i("p",null,S(a(G)(c.value)),1),l(O,{class:"play-slider",min:0,max:n.musicDuration,onChange:T,value:c.value,"onUpdate:value":o[0]||(o[0]=r=>c.value=r),tipFormatter:w},null,8,["max","value"]),i("p",null,S(a(G)(n.musicDuration)),1)])]),i("div",bt,[i("div",{class:"volume",title:`当前音量：${a(s).settings.volume}`},[a(s).settings.mute||a(s).settings.volume===0?(v(),_("i",{key:0,class:"ifishfont ifish-volumeDisable",onClick:o[1]||(o[1]=r=>L(!0))})):a(s).settings.volume>=0&&a(s).settings.volume<30?(v(),_("i",{key:1,class:"ifishfont ifish-volumeLow",onClick:o[2]||(o[2]=r=>L(!1))})):a(s).settings.volume>=30&&a(s).settings.volume<60?(v(),_("i",{key:2,class:"ifishfont ifish-volumeMiddle",onClick:o[3]||(o[3]=r=>L(!1))})):(v(),_("i",{key:3,class:"ifishfont ifish-volumeHigh",onClick:o[4]||(o[4]=r=>L(!1))})),l(O,{class:"volume-slider",min:0,max:100,value:a(s).settings.volume,"onUpdate:value":o[5]||(o[5]=r=>a(s).settings.volume=r)},null,8,["value"])],8,Ot),i("div",Ct,[l(p,{title:n.musicMode},{default:d(()=>[a(s).settings.mode==="listCycle"?(v(),_("i",{key:0,class:"ifishfont ifish-musicListLoop",title:"列表循环",onClick:o[6]||(o[6]=r=>P("singleCycle"))})):F("",!0),a(s).settings.mode==="singleCycle"?(v(),_("i",{key:1,class:"ifishfont ifish-musicSingleCycle",title:"单曲循环",onClick:o[7]||(o[7]=r=>P("randomPlay"))})):F("",!0),a(s).settings.mode==="randomPlay"?(v(),_("i",{key:2,class:"ifishfont ifish-musicRandomPlay",title:"随机播放",onClick:o[8]||(o[8]=r=>P("listCycle"))})):F("",!0)]),_:1},8,["title"])]),l(m,{type:"vertical"}),l(p,{title:"播放列表",placement:"topRight"},{default:d(()=>[l(a(Pe),{onClick:b})]),_:1})])])}}},Lt=W($t,[["__scopeId","data-v-1b8fd605"]]);const xt={class:"music-box"},Pt={class:"title"},Mt={class:"music-list"},St=["onClick"],kt={class:"music-cover"},wt=["src"],It={class:"music-info"},jt=["onClick"],Dt=["onClick"],zt=["onClick"],Nt={__name:"MusicList",props:{open:{type:Boolean,default:!1}},emits:["close","showSearch"],setup(n,{emit:e}){const{useMusicStore:t}=X(),s=()=>{e("close")},c=()=>{e("showSearch")},b=()=>{t.musicList=[]},j=g=>{t.playMusic(g)},P=g=>{g<t.activeIndex?(t.musicList.splice(g,1),t.activeIndex--):(g===t.activeIndex&&(t.settings.currentTime=0,t.activeIndex===t.musicList.length-1&&(t.activeIndex=0),t.activeIndex++,t.activeIndex--),t.musicList.splice(g,1))},L=g=>{xe(g.url)};return(g,w)=>{const T=y("a-input"),N=y("a-popconfirm"),H=y("a-empty"),D=y("a-menu-item"),V=y("a-menu"),k=y("a-dropdown"),u=y("perfect-scrollbar"),o=y("a-drawer");return v(),E(o,{width:"360px",title:"播放列表",placement:"right",open:n.open,onClose:s,rootClassName:"disclaimers-root"},{default:d(()=>[i("div",xt,[l(T,{onClick:c,readonly:"",placeholder:"搜索",style:{"border-radius":"20px"}},{prefix:d(()=>[l(a(ye))]),_:1}),i("div",null,[i("p",Pt,[i("span",null,[l(a(at)),A("播放列表（共 "+S(a(t).musicList.length)+" 首）",1)]),l(N,{title:"确认清空列表？",onConfirm:b},{default:d(()=>[i("span",null,[l(a(be)),A("清空列表")])]),_:1})]),a(t).musicList.length?F("",!0):(v(),E(H,{key:0,class:"list-empty"},{description:d(()=>[i("span",{class:"description"},[A(" 暂无歌曲，请"),i("a",{onClick:c},"搜索添加")])]),_:1})),l(u,{class:"scroll-bar"},{default:d(()=>[i("div",Mt,[(v(!0),_(J,null,Q(a(t).musicList,(p,O)=>(v(),_("div",{class:R(["music-item",{active:a(t).activeIndex===O}]),key:O,onClick:m=>j(O)},[i("div",kt,[i("img",{src:p.cover,onerror:"this.src='./images/music.png'",alt:""},null,8,wt)]),i("div",It,[i("p",null,S(p.name),1),i("span",null,S(p.singer),1)]),i("div",{class:"music-action",onClick:w[0]||(w[0]=Oe(()=>{},["stop"]))},[l(k,{placement:"bottomLeft",arrow:""},{overlay:d(()=>[l(V,null,{default:d(()=>[l(D,null,{default:d(()=>[i("a",{href:"javascript:;",onClick:m=>j(O)},"播放",8,jt)]),_:2},1024),l(D,null,{default:d(()=>[i("a",{href:"javascript:;",onClick:m=>P(O)},"移除",8,Dt)]),_:2},1024),l(D,null,{default:d(()=>[i("a",{href:"javascript:;",onClick:m=>L(p)},"下载",8,zt)]),_:2},1024)]),_:2},1024)]),default:d(()=>[l(a(Ce))]),_:2},1024)])],10,St))),128))])]),_:1})])])]),_:1},8,["open"])}}},Tt=W(Nt,[["__scopeId","data-v-5a8bf248"]]);const Ht=n=>($e("data-v-2f05ab74"),n=n(),Le(),n),Vt={class:"search"},Ft={key:0,class:"search-history"},Et={class:"title"},Rt={class:"search-history-box"},At=["onClick"],Bt={class:"text",title:"点击搜索"},Ut={class:"search-list"},qt=Ht(()=>i("p",{class:"title"},"搜索结果：",-1)),Gt=["onClick"],Yt={title:"立即播放"},Jt={class:"search-action"},Qt=["onClick"],Wt=["onClick"],Xt=["onClick"],Zt=["onClick"],_e=15,Kt={__name:"MusicSearch",setup(n){const{useMusicStore:e}=X(),t=x(""),s=x([]),c=x(!1),b=u=>{e.searchHistory.indexOf(u)<0&&e.searchHistory.unshift(u),L(u)};let j=x(1),P=x(!1);const L=u=>{t.value=u,c.value=!0;const o=`https://api.lolimi.cn/API/qqdg/api.php?msg=${u}&p=${j.value}&sc=${_e}`;Z.get(o).then(p=>{p.data.code===1?(s.value=[...s.value,...p.data.data],p.data.data.length<_e&&(P.value=!0)):P.value=!0,c.value=!1})},g=u=>{if(P.value)return;let o=u.target;o.scrollTop+o.clientHeight>=o.scrollHeight&&(j.value++,L(t.value))},w=()=>{e.searchHistory=[]},T=u=>{const o=e.searchHistory.indexOf(u);e.searchHistory.splice(o,1)},N=async(u,o)=>{const{cover:p,name:O,singer:m,url:r,content:M}=await k(u);e.musicList.push({id:te(21),cover:p,name:O,singer:m,url:r,content:M}),e.playMusic(e.musicList.length-1)},H=async(u,o)=>{const{cover:p,name:O,singer:m,url:r,content:M}=await k(u);e.musicList.push({id:te(21),cover:p,name:O,singer:m,url:r,content:M})},D=async(u,o)=>{const{cover:p,name:O,singer:m,url:r,content:M}=await k(u);e.musicList.splice(e.activeIndex+1,0,{id:te(21),cover:p,name:O,singer:m,url:r,content:M})},V=async(u,o)=>{const{url:p}=await k(u);p&&xe(p)},k=async(u,o)=>{const p=new Promise((r,M)=>{Z.get(`https://xiaoapi.cn/API/yy_sq.php?msg=${u.song}-${u.singer}&n=1`).then(f=>{f.data.code===200?r(f.data):M()})}),O=new Promise((r,M)=>{Z.get(`https://api.lolimi.cn/API/kggc/api.php?msg=${u.song}-${u.singer}&n=1`).then(f=>{f.data.code===1?r(f.data.data):M()})}),m=await Promise.all([p,O]);return{...m[0],...m[1]}};return(u,o)=>{const p=y("a-input"),O=y("a-col"),m=y("a-button"),r=y("a-row"),M=y("a-empty"),f=y("a-menu-item"),h=y("a-menu"),U=y("a-dropdown"),z=y("perfect-scrollbar"),q=y("a-spin");return v(),_("div",Vt,[l(r,{gutter:12},{default:d(()=>[l(O,{span:20},{default:d(()=>[l(p,{value:t.value,"onUpdate:value":o[0]||(o[0]=C=>t.value=C),onPressEnter:o[1]||(o[1]=C=>b(C.target.value)),placeholder:"输入歌曲、歌手",allowClear:"",style:{"border-radius":"16px"}},{prefix:d(()=>[l(a(ye))]),_:1},8,["value"])]),_:1}),l(O,{span:3},{default:d(()=>[l(m,{type:"primary",shape:"round",onClick:o[2]||(o[2]=C=>b(t.value))},{default:d(()=>[A("搜索")]),_:1})]),_:1})]),_:1}),a(e).searchHistory.length?(v(),_("div",Ft,[i("p",Et,[A(" 搜索历史： "),i("span",{class:"clear",onClick:w},[l(a(be)),A("清空历史搜索")])]),i("div",Rt,[(v(!0),_(J,null,Q(a(e).searchHistory,(C,$)=>(v(),_("p",{key:$,onClick:I=>L(C)},[i("span",Bt,S(C),1),l(a(je),{title:"点击移除",onClick:Oe(I=>T(C),["stop"])},null,8,["onClick"])],8,At))),128))])])):F("",!0),i("div",Ut,[qt,l(q,{spinning:c.value,tip:"加载中..."},{default:d(()=>[l(z,{class:"scroll-bar",onPsScrollY:g},{default:d(()=>[s.value.length?F("",!0):(v(),E(M,{key:0})),i("ul",null,[(v(!0),_(J,null,Q(s.value,(C,$)=>(v(),_("li",{key:$,onClick:I=>N(C,$)},[i("p",Yt,S(C.song)+" - "+S(C.singers),1),i("div",Jt,[l(U,{placement:"bottomLeft",arrow:""},{overlay:d(()=>[l(h,null,{default:d(()=>[l(f,null,{default:d(()=>[i("a",{href:"javascript:;",onClick:I=>H(C,$)},"添加到播放列表",8,Qt)]),_:2},1024),l(f,null,{default:d(()=>[i("a",{href:"javascript:;",onClick:I=>N(C,$)},"立即播放",8,Wt)]),_:2},1024),l(f,null,{default:d(()=>[i("a",{href:"javascript:;",onClick:I=>D(C,$)},"下一首播放",8,Xt)]),_:2},1024),l(f,null,{default:d(()=>[i("a",{href:"javascript:;",onClick:I=>V(C,$)},"下载",8,Zt)]),_:2},1024)]),_:2},1024)]),default:d(()=>[l(a(Ce))]),_:2},1024)])],8,Gt))),128))])]),_:1})]),_:1},8,["spinning"])])])}}},en=W(Kt,[["__scopeId","data-v-2f05ab74"]]);const Ie=n=>($e("data-v-ea1b5d86"),n=n(),Le(),n),tn={class:"bg"},nn=["src"],sn=Ie(()=>i("div",{class:"mask"},null,-1)),ln={class:"music-info"},an=["src"],cn={class:"progress-box"},on={class:"prev-next"},rn={class:"mode"},un={class:"music-list"},dn=["onClick"],vn={class:"music-cover"},mn=["src"],pn={class:"music-info"},fn=Ie(()=>i("span",null,"播放列表",-1)),gn={class:"music-lyric"},hn={key:0,class:"no-lyric"},_n={class:"action"},yn={__name:"MusicFullScreen",props:{open:{type:Boolean,default:!1},musicCurrentTime:{type:Number,default:0},musicDuration:{type:Number,default:0},prevMusic:{type:String,default:""},nextMusic:{type:String,default:""},musicMode:{type:String,default:""}},emits:["close","handleDurationChange","handlePlay","handlePause","handlePrev","handleNext"],setup(n,{emit:e}){const t=n,{useMusicStore:s}=X(),c=x(!1),b=x(null),{isFullscreen:j,toggle:P,exit:L}=De(b),g=x({});Y(()=>[s.activeIndex,s.settings.playing],()=>{g.value=s.musicList[s.activeIndex]||{}},{immediate:!0,deep:!0});const w=x(0);Y(()=>t.musicCurrentTime,f=>{w.value=f},{immediate:!0,deep:!0});const T=K(()=>{var h,U,z;let f=[];return(U=(h=g.value)==null?void 0:h.content)!=null&&U.length?f=H((z=g.value)==null?void 0:z.content):N(),f}),N=()=>{Z.get(`https://api.lolimi.cn/API/kggc/api.php?msg=${g.value.name}-${g.value.singer}&n=1`).then(f=>{const{content:h}=f.data.data||{};f.data.code===1&&(s.musicList[s.activeIndex].content=h)})},H=f=>{const h=[];return f.split(`
`).map(z=>{let q=z.match(/\[(.*?)\]/);if(q){let C=q[1];/^(0\d|1\d|2[0-3]):([0-5]\d)\.(?:\d{2})$/.test(C)&&h.push({time:C,lyric:z.replace(/\[.*?\]/g,"")})}}),h},D=()=>{L(),e("close")},V=f=>{s.playMusic(f)},k=f=>{s.changeMode(f)},u=f=>G(f),o=f=>{e("handleDurationChange",f)},p=()=>{e("handlePlay")},O=()=>{e("handlePause")},m=()=>{e("handlePrev")},r=()=>{e("handleNext")},M=()=>{e("toggleMusicList")};return(f,h)=>{const U=y("a-slider"),z=y("a-tooltip"),q=y("perfect-scrollbar"),C=y("a-popover");return v(),_("div",{ref_key:"fullscreenRef",ref:b,class:R(["music-fullscreen",{open:n.open}])},[i("div",tn,[i("img",{src:g.value.cover,alt:""},null,8,nn),sn]),i("div",ln,[i("img",{class:R(["cover",{playing:c.value||a(s).settings.playing}]),onClick:h[0]||(h[0]=$=>c.value=!c.value),src:g.value.cover,alt:""},null,10,an),i("p",null,S(g.value.name),1),i("span",null,S(g.value.singer),1),i("div",cn,[i("p",null,S(a(G)(w.value)),1),l(U,{class:"play-slider",min:0,max:n.musicDuration,onChange:o,value:w.value,"onUpdate:value":h[1]||(h[1]=$=>w.value=$),tipFormatter:u},null,8,["max","value"]),i("p",null,S(a(G)(n.musicDuration)),1)]),i("div",on,[i("div",rn,[l(z,{title:n.musicMode},{default:d(()=>[a(s).settings.mode==="listCycle"?(v(),_("i",{key:0,class:"ifishfont ifish-musicListLoop",title:"列表循环",onClick:h[2]||(h[2]=$=>k("singleCycle"))})):F("",!0),a(s).settings.mode==="singleCycle"?(v(),_("i",{key:1,class:"ifishfont ifish-musicSingleCycle",title:"单曲循环",onClick:h[3]||(h[3]=$=>k("randomPlay"))})):F("",!0),a(s).settings.mode==="randomPlay"?(v(),_("i",{key:2,class:"ifishfont ifish-musicRandomPlay",title:"随机播放",onClick:h[4]||(h[4]=$=>k("listCycle"))})):F("",!0)]),_:1},8,["title"])]),l(z,{title:`上一首${n.prevMusic?"：":""}${n.prevMusic}`},{default:d(()=>[l(a(we),{onClick:m})]),_:1},8,["title"]),l(z,{title:a(s).settings.playing?"点击暂停":"点击播放"},{default:d(()=>[a(s).settings.playing?(v(),E(a(Me),{key:1,class:"pause",onClick:O})):(v(),E(a(Se),{key:0,class:"play",onClick:p}))]),_:1},8,["title"]),l(z,{title:`下一首${n.nextMusic?"：":""}${n.nextMusic}`},{default:d(()=>[l(a(ke),{onClick:r})]),_:1},8,["title"]),l(C,{placement:"rightBottom"},{content:d(()=>[l(q,{class:"scroll-music"},{default:d(()=>[i("div",un,[(v(!0),_(J,null,Q(a(s).musicList,($,I)=>(v(),_("div",{class:R(["music-item",{active:a(s).activeIndex===I}]),key:I,onClick:xn=>V(I)},[i("div",vn,[i("img",{src:$.cover,onerror:"this.src='./images/music.png'",alt:""},null,8,mn)]),i("div",pn,[i("p",null,S($.name),1),i("span",null,S($.singer),1)])],10,dn))),128))])]),_:1})]),title:d(()=>[fn]),default:d(()=>[l(a(Pe),{onClick:M})]),_:1})])]),i("div",gn,[T.value.length?F("",!0):(v(),_("p",hn,"暂无歌词")),l(q,{class:"scroll-bar"},{default:d(()=>[(v(!0),_(J,null,Q(T.value,($,I)=>(v(),_("p",{class:R({active:I===6}),key:I},S($.lyric),3))),128))]),_:1})]),i("div",_n,[l(a(ze),{class:"close",title:"关闭歌词",onClick:D}),a(j)?(v(),E(a(Be),{key:0,title:"关闭全屏",onClick:a(P)},null,8,["onClick"])):(v(),E(a(Ye),{key:1,title:"开启全屏",onClick:a(P)},null,8,["onClick"]))])],2)}}},bn=W(yn,[["__scopeId","data-v-ea1b5d86"]]);const On={class:"music"},Cn=["src","loop"],$n=["title"],Ln={__name:"Index",setup(n){const{useMusicStore:e}=X();Ne(()=>{e.settings.playing=!1});const t=x(!1),s=x(!1),c=x(!1),b=x(null),j=x({});Y(()=>[e.activeIndex,e.settings.playing],()=>{j.value=e.musicList[e.activeIndex]||{},ee(()=>{b.value&&(L.value=parseInt(b.value.duration),b.value.volume=e.settings.volume/100,e.settings.playing&&b.value.play())})},{immediate:!0,deep:!0}),Y(()=>[e.settings.volume,e.settings.mute],()=>{b.value&&ee(()=>{b.value.volume=e.settings.volume/100,b.value.muted=e.settings.mute})},{immediate:!0,deep:!0});const P=x(0),L=x(1e3),g=()=>{L.value=parseInt(b.value.duration),P.value=b.value.currentTime=e.settings.currentTime},w=m=>{const{currentTime:r,duration:M}=m.target;P.value=e.settings.currentTime=parseInt(r),L.value=parseInt(M)},T=()=>{e.toggleVisible()},N=()=>{!e.musicList.length||e.activeIndex<0||(e.settings.playing=!0,b.value.play())},H=()=>{!e.musicList.length||e.activeIndex<0||(e.settings.playing=!1,b.value.pause())},D=K(()=>{if(!e.musicList.length||e.activeIndex<0)return"";let m=e.activeIndex===0?e.musicList.length-1:e.activeIndex-1;return e.musicList[m]?e.musicList[m].name:""}),V=()=>{if(!e.musicList.length||e.activeIndex<0)return;let m=e.activeIndex===0?e.musicList.length-1:e.activeIndex-1;e.playMusic(m)},k=K(()=>{if(!e.musicList.length||e.activeIndex<0)return"";let m=e.activeIndex===e.musicList.length-1?0:e.activeIndex+1;return e.musicList[m]?e.musicList[m].name:""}),u=()=>{if(!e.musicList.length||e.activeIndex<0)return;let m=e.activeIndex===e.musicList.length-1?0:e.activeIndex+1;e.playMusic(m)},o=()=>{e.settings.mode==="listCycle"?(e.musicList.length===1&&(e.activeIndex--,e.activeIndex++),u()):e.settings.mode==="singleCycle"?e.playMusic(e.activeIndex):e.settings.mode==="randomPlay"&&e.playMusic(Fe(0,e.musicList.length-1,e.activeIndex))},p=m=>{e.settings.currentTime=m,b.value&&ee(()=>{b.value.currentTime=m})},O=K(()=>({listCycle:"列表循环",singleCycle:"单曲循环",randomPlay:"随机播放"})[e.settings.mode]);return(m,r)=>{var f;const M=y("IDialog");return v(),_("div",On,[Te(i("audio",{ref_key:"audioRef",ref:b,controls:"",src:(f=j.value)==null?void 0:f.url,loop:a(e).settings.mode==="singleCycle",onTimeupdate:w,onLoadeddata:g,onEnded:o,onError:o},null,40,Cn),[[He,!1]]),i("div",{class:R(["toggle-icon bf",[a(e).visible?"down":"up"]]),title:a(e).visible?"隐藏播放器":"显示播放器",onClick:T},[l(a(Ve))],10,$n),i("div",{class:R(["music-ctrl bf",[a(e).visible?"show":""]])},[l(Lt,{musicCurrentTime:P.value,musicDuration:L.value,prevMusic:D.value,nextMusic:k.value,musicMode:O.value,onShowSearch:r[0]||(r[0]=h=>s.value=!0),onToggleMusicList:r[1]||(r[1]=h=>t.value=!t.value),onShowLyric:r[2]||(r[2]=h=>c.value=!0),onHandlePlay:N,onHandlePause:H,onHandlePrev:V,onHandleNext:u,onHandleDurationChange:p},null,8,["musicCurrentTime","musicDuration","prevMusic","nextMusic","musicMode"])],2),l(Tt,{open:t.value,onShowSearch:r[3]||(r[3]=h=>s.value=!0),onClose:r[4]||(r[4]=h=>t.value=!1)},null,8,["open"]),l(M,{title:"搜索音乐",visible:s.value,zIndex:1002,onOk:r[5]||(r[5]=h=>s.value=!1),onCancel:r[6]||(r[6]=h=>s.value=!1)},{default:d(()=>[l(en)]),_:1},8,["visible"]),l(bn,{open:c.value,musicCurrentTime:P.value,musicDuration:L.value,prevMusic:D.value,nextMusic:k.value,musicMode:O.value,onClose:r[7]||(r[7]=h=>c.value=!1),onToggleMusicList:r[8]||(r[8]=h=>t.value=!t.value),onHandlePlay:N,onHandlePause:H,onHandlePrev:V,onHandleNext:u,onHandleDurationChange:p},null,8,["open","musicCurrentTime","musicDuration","prevMusic","nextMusic","musicMode"])])}}},Sn=W(Ln,[["__scopeId","data-v-1cf70036"]]);export{Sn as default};
