import{u as ne,e as se,a as ie}from"./App-7eb53868.js";import{j as o,A,o as ae,p as O,V as ce,w as S,E as re,r as b,h as m,i as f,q as c,x,u as a,z as g,k as h,C as P,B as M,F as j,s as I,y as oe,W as ue}from"./index-e10e2477.js";import{s as $,m as w}from"./utils-7dc22624.js";import{V as de,P as me,a as ve,b as fe,M as pe}from"./VerticalRightOutlined-01aefb43.js";var ge={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M391 240.9c-.8-6.6-8.9-9.4-13.6-4.7l-43.7 43.7L200 146.3a8.03 8.03 0 00-11.3 0l-42.4 42.3a8.03 8.03 0 000 11.3L280 333.6l-43.9 43.9a8.01 8.01 0 004.7 13.6L401 410c5.1.6 9.5-3.7 8.9-8.9L391 240.9zm10.1 373.2L240.8 633c-6.6.8-9.4 8.9-4.7 13.6l43.9 43.9L146.3 824a8.03 8.03 0 000 11.3l42.4 42.3c3.1 3.1 8.2 3.1 11.3 0L333.7 744l43.7 43.7A8.01 8.01 0 00391 783l18.9-160.1c.6-5.1-3.7-9.4-8.8-8.8zm221.8-204.2L783.2 391c6.6-.8 9.4-8.9 4.7-13.6L744 333.6 877.7 200c3.1-3.1 3.1-8.2 0-11.3l-42.4-42.3a8.03 8.03 0 00-11.3 0L690.3 279.9l-43.7-43.7a8.01 8.01 0 00-13.6 4.7L614.1 401c-.6 5.2 3.7 9.5 8.8 8.9zM744 690.4l43.9-43.9a8.01 8.01 0 00-4.7-13.6L623 614c-5.1-.6-9.5 3.7-8.9 8.9L633 783.1c.8 6.6 8.9 9.4 13.6 4.7l43.7-43.7L824 877.7c3.1 3.1 8.2 3.1 11.3 0l42.4-42.3c3.1-3.1 3.1-8.2 0-11.3L744 690.4z"}}]},name:"fullscreen-exit",theme:"outlined"};const he=ge;function V(n){for(var e=1;e<arguments.length;e++){var i=arguments[e]!=null?Object(arguments[e]):{},t=Object.keys(i);typeof Object.getOwnPropertySymbols=="function"&&(t=t.concat(Object.getOwnPropertySymbols(i).filter(function(u){return Object.getOwnPropertyDescriptor(i,u).enumerable}))),t.forEach(function(u){ye(n,u,i[u])})}return n}function ye(n,e,i){return e in n?Object.defineProperty(n,e,{value:i,enumerable:!0,configurable:!0,writable:!0}):n[e]=i,n}var D=function(e,i){var t=V({},e,i.attrs);return o(A,V({},t,{icon:he}),null)};D.displayName="FullscreenExitOutlined";D.inheritAttrs=!1;const _e=D;var Le={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M290 236.4l43.9-43.9a8.01 8.01 0 00-4.7-13.6L169 160c-5.1-.6-9.5 3.7-8.9 8.9L179 329.1c.8 6.6 8.9 9.4 13.6 4.7l43.7-43.7L370 423.7c3.1 3.1 8.2 3.1 11.3 0l42.4-42.3c3.1-3.1 3.1-8.2 0-11.3L290 236.4zm352.7 187.3c3.1 3.1 8.2 3.1 11.3 0l133.7-133.6 43.7 43.7a8.01 8.01 0 0013.6-4.7L863.9 169c.6-5.1-3.7-9.5-8.9-8.9L694.8 179c-6.6.8-9.4 8.9-4.7 13.6l43.9 43.9L600.3 370a8.03 8.03 0 000 11.3l42.4 42.4zM845 694.9c-.8-6.6-8.9-9.4-13.6-4.7l-43.7 43.7L654 600.3a8.03 8.03 0 00-11.3 0l-42.4 42.3a8.03 8.03 0 000 11.3L734 787.6l-43.9 43.9a8.01 8.01 0 004.7 13.6L855 864c5.1.6 9.5-3.7 8.9-8.9L845 694.9zm-463.7-94.6a8.03 8.03 0 00-11.3 0L236.3 733.9l-43.7-43.7a8.01 8.01 0 00-13.6 4.7L160.1 855c-.6 5.1 3.7 9.5 8.9 8.9L329.2 845c6.6-.8 9.4-8.9 4.7-13.6L290 787.6 423.7 654c3.1-3.1 3.1-8.2 0-11.3l-42.4-42.4z"}}]},name:"fullscreen",theme:"outlined"};const Ce=Le;function R(n){for(var e=1;e<arguments.length;e++){var i=arguments[e]!=null?Object(arguments[e]):{},t=Object.keys(i);typeof Object.getOwnPropertySymbols=="function"&&(t=t.concat(Object.getOwnPropertySymbols(i).filter(function(u){return Object.getOwnPropertyDescriptor(i,u).enumerable}))),t.forEach(function(u){Oe(n,u,i[u])})}return n}function Oe(n,e,i){return e in n?Object.defineProperty(n,e,{value:i,enumerable:!0,configurable:!0,writable:!0}):n[e]=i,n}var E=function(e,i){var t=R({},e,i.attrs);return o(A,R({},t,{icon:Ce}),null)};E.displayName="FullscreenOutlined";E.inheritAttrs=!1;const ke=E;const be={class:"bg"},xe=["src"],Pe=c("div",{class:"mask"},null,-1),Me={class:"music-info"},Fe=["src"],Se={class:"progress-box"},$e={class:"prev-next"},we={class:"mode"},De={class:"music-list"},Ee=["onClick"],Ne={class:"music-cover"},Be=["src"],Te={class:"music-info"},ze={class:"music-lyric"},je={key:0,class:"no-lyric"},Ie=["onClick"],Ve={class:"action"},Ue={__name:"MusicFullScreen",props:{open:{type:Boolean,default:!1},musicCurrentTime:{type:Number,default:0},musicDuration:{type:Number,default:0},prevMusic:{type:String,default:""},nextMusic:{type:String,default:""},musicMode:{type:String,default:""}},emits:["close","handleDurationChange","handlePlay","handlePause","handlePrev","handleNext"],setup(n,{emit:e}){const i=n,{useMusicStore:t}=ne();ae(()=>{se.on("lyricClose",()=>{z()})});const u=O(!1),N=O(null),{isFullscreen:H,toggle:B,exit:q}=ce(N),v=O({});S(()=>[t.activeIndex,t.settings.playing],()=>{v.value=t.musicList[t.activeIndex]||{}},{immediate:!0,deep:!0});const U=l=>{const s=[];return l.split(`
`).map(d=>{let p=d.match(/\[(.*?)\]/);if(p){let _=p[1];/^(0\d|1\d|2[0-3]):([0-5]\d)\.(?:\d{2})$/.test(_)&&s.push({time:_,lyric:d.replace(/\[.*?\]/g,"")})}}),s},k=re(()=>{var s,y,d;let l=[];return t.activeIndex<0?[]:((y=(s=v.value)==null?void 0:s.content)!=null&&y.length?l=U((d=v.value)==null?void 0:d.content):W(),l)}),C=O(0);S(()=>i.musicCurrentTime,l=>{C.value=l},{immediate:!0,deep:!0});const T=O(0),J=l=>{var _;const y=w(k.value[l].time),d=w((_=k.value[l+1])==null?void 0:_.time),p=C.value+1>=y&&(C.value+1<d||!d);return p&&(T.value=l),p};S(()=>T.value,()=>{let l=document.getElementById("lyric-list");if(l){let s=l.querySelector(".active");s&&l.scrollTo({top:s.offsetTop-l.clientHeight/2+s.clientHeight/2,behavior:"smooth"})}},{immediate:!0,deep:!0});const W=()=>{v.value.name&&ie.get(`https://api.lolimi.cn/API/kggc/api.php?msg=${v.value.name}-${v.value.singer}&n=1`).then(l=>{const{content:s}=l.data.data||{};l.data.code===1&&(t.musicList[t.activeIndex].content=s)})},z=()=>{q(),e("close")},G=l=>{t.playMusic(l)},F=l=>{t.changeMode(l)},Q=l=>$(l),X=l=>{e("handleDurationChange",l)},Y=()=>{e("handlePlay")},Z=()=>{e("handlePause")},K=()=>{e("handlePrev")},ee=()=>{e("handleNext")},te=(l,s)=>{e("handleDurationChange",w(l.time)),e("handlePlay")};return(l,s)=>{const y=b("a-slider"),d=b("a-tooltip"),p=b("perfect-scrollbar"),_=b("a-popover");return m(),f("div",{ref_key:"fullscreenRef",ref:N,class:x(["music-fullscreen",{open:n.open}])},[c("div",be,[c("img",{src:v.value.cover,alt:""},null,8,xe),Pe]),c("div",Me,[c("img",{class:x(["cover",{playing:u.value||a(t).settings.playing}]),onClick:s[0]||(s[0]=r=>u.value=!u.value),src:v.value.cover,alt:""},null,10,Fe),c("p",null,g(v.value.name),1),c("span",null,g(v.value.singer),1),c("div",Se,[c("p",null,g(a($)(C.value)),1),o(y,{class:"play-slider",min:0,max:n.musicDuration,onChange:X,value:C.value,"onUpdate:value":s[1]||(s[1]=r=>C.value=r),tipFormatter:Q},null,8,["max","value"]),c("p",null,g(a($)(n.musicDuration)),1)]),c("div",$e,[c("div",we,[o(d,{title:n.musicMode},{default:h(()=>[a(t).settings.mode==="listCycle"?(m(),f("i",{key:0,class:"ifishfont ifish-musicListLoop",title:"列表循环",onClick:s[2]||(s[2]=r=>F("singleCycle"))})):P("",!0),a(t).settings.mode==="singleCycle"?(m(),f("i",{key:1,class:"ifishfont ifish-musicSingleCycle",title:"单曲循环",onClick:s[3]||(s[3]=r=>F("randomPlay"))})):P("",!0),a(t).settings.mode==="randomPlay"?(m(),f("i",{key:2,class:"ifishfont ifish-musicRandomPlay",title:"随机播放",onClick:s[4]||(s[4]=r=>F("listCycle"))})):P("",!0)]),_:1},8,["title"])]),o(d,{title:`上一首${n.prevMusic?"：":""}${n.prevMusic}`},{default:h(()=>[o(a(de),{onClick:K})]),_:1},8,["title"]),o(d,{title:a(t).settings.playing?"点击暂停":"点击播放"},{default:h(()=>[a(t).settings.playing?(m(),M(a(ve),{key:1,class:"pause",onClick:Z})):(m(),M(a(me),{key:0,class:"play",onClick:Y}))]),_:1},8,["title"]),o(d,{title:`下一首${n.nextMusic?"：":""}${n.nextMusic}`},{default:h(()=>[o(a(fe),{onClick:ee})]),_:1},8,["title"]),o(_,{title:"播放列表",placement:"rightBottom"},{content:h(()=>[o(p,{class:"scroll-music"},{default:h(()=>[c("div",De,[(m(!0),f(j,null,I(a(t).musicList,(r,L)=>(m(),f("div",{class:x(["music-item",{active:a(t).activeIndex===L}]),key:L,onClick:le=>G(L)},[c("div",Ne,[c("img",{src:r.cover,onerror:"this.src='./images/music.png'",alt:""},null,8,Be)]),c("div",Te,[c("p",null,g(r.name),1),c("span",null,g(r.singer),1)])],10,Ee))),128))])]),_:1})]),default:h(()=>[o(a(pe))]),_:1})])]),c("div",ze,[k.value.length?P("",!0):(m(),f("p",je,"暂无歌词")),o(p,{class:"scroll-bar",id:"lyric-list"},{default:h(()=>[(m(!0),f(j,null,I(k.value,(r,L)=>(m(),f("p",{class:x({active:J(L)}),key:L,onClick:le=>te(r,L)},[c("span",null,g(r.time),1),oe(" "+g(r.lyric),1)],10,Ie))),128))]),_:1})]),c("div",Ve,[o(a(ue),{class:"close",title:"关闭歌词",onClick:z}),a(H)?(m(),M(a(_e),{key:0,title:"关闭全屏",onClick:a(B)},null,8,["onClick"])):(m(),M(a(ke),{key:1,title:"开启全屏",onClick:a(B)},null,8,["onClick"]))])],2)}}};export{Ue as default};
