import{bU as g,bV as L,_ as O,u as C,h as T,a as j,o as U,b as B,c as l,w as r,d as b,f as m,q as R,U as F,p as M,g as D}from"./index-ec68540d.js";var A={exports:{}};(function(_,u){(function(i,f){f()})(g,function(){function i(t,e){return typeof e>"u"?e={autoBom:!1}:typeof e!="object"&&(console.warn("Deprecated: Expected third argument to be a object"),e={autoBom:!e}),e.autoBom&&/^\s*(?:text\/\S*|application\/xml|\S*\/\S*\+xml)\s*;.*charset\s*=\s*utf-8/i.test(t.type)?new Blob(["\uFEFF",t],{type:t.type}):t}function f(t,e,n){var o=new XMLHttpRequest;o.open("GET",t),o.responseType="blob",o.onload=function(){c(o.response,e,n)},o.onerror=function(){console.error("could not download file")},o.send()}function x(t){var e=new XMLHttpRequest;e.open("HEAD",t,!1);try{e.send()}catch{}return 200<=e.status&&299>=e.status}function v(t){try{t.dispatchEvent(new MouseEvent("click"))}catch{var e=document.createEvent("MouseEvents");e.initMouseEvent("click",!0,!0,window,0,0,0,80,20,!1,!1,!1,!1,0,null),t.dispatchEvent(e)}}var s=typeof window=="object"&&window.window===window?window:typeof self=="object"&&self.self===self?self:typeof g=="object"&&g.global===g?g:void 0,y=s.navigator&&/Macintosh/.test(navigator.userAgent)&&/AppleWebKit/.test(navigator.userAgent)&&!/Safari/.test(navigator.userAgent),c=s.saveAs||(typeof window!="object"||window!==s?function(){}:"download"in HTMLAnchorElement.prototype&&!y?function(t,e,n){var o=s.URL||s.webkitURL,a=document.createElement("a");e=e||t.name||"download",a.download=e,a.rel="noopener",typeof t=="string"?(a.href=t,a.origin===location.origin?v(a):x(a.href)?f(t,e,n):v(a,a.target="_blank")):(a.href=o.createObjectURL(t),setTimeout(function(){o.revokeObjectURL(a.href)},4e4),setTimeout(function(){v(a)},0))}:"msSaveOrOpenBlob"in navigator?function(t,e,n){if(e=e||t.name||"download",typeof t!="string")navigator.msSaveOrOpenBlob(i(t,n),e);else if(x(t))f(t,e,n);else{var o=document.createElement("a");o.href=t,o.target="_blank",setTimeout(function(){v(o)})}}:function(t,e,n,o){if(o=o||open("","_blank"),o&&(o.document.title=o.document.body.innerText="downloading..."),typeof t=="string")return f(t,e,n);var a=t.type==="application/octet-stream",p=/constructor/i.test(s.HTMLElement)||s.safari,d=/CriOS\/[\d]+/.test(navigator.userAgent);if((d||a&&p||y)&&typeof FileReader<"u"){var h=new FileReader;h.onloadend=function(){var w=h.result;w=d?w:w.replace(/^data:[^;]*;/,"data:attachment/file;"),o?o.location.href=w:location=w,o=null},h.readAsDataURL(t)}else{var k=s.URL||s.webkitURL,E=k.createObjectURL(t);o?o.location=E:location.href=E,o=null,setTimeout(function(){k.revokeObjectURL(E)},4e4)}});s.saveAs=c.saveAs=c,_.exports=c})})(A);var $=A.exports;const H=L($);const S=_=>(M("data-v-fbac3178"),_=_(),D(),_),N={class:"settings-export"},I={class:"label",for:"json"},V=S(()=>b("br",null,null,-1)),Y=S(()=>b("br",null,null,-1)),q=S(()=>b("br",null,null,-1)),J=S(()=>b("br",null,null,-1)),G={__name:"SettingsData",setup(_){const{useAppStore:u,useSystemStore:i}=C(),f=T({}),x={style:{width:"68px"}},v={app:"首页配置",system:"系统配置",all:"全部配置"},s=t=>{const e=t.target.files[0];if(!e.name.includes("json")){R({type:"warning",content:"只能插入json文件"});return}const n=new FileReader;n.readAsText(e),n.onload=o=>{const{type:a,data:p}=JSON.parse(o.target.result);!a||!["app","news","system","all"].includes(a)||!p?R({type:"warning",content:"JSON文件中的格式有问题，请检查后重试"}):(a==="app"?u.lists=p:a==="system"?i.settings=p:a==="all"&&(u.lists=p.app,i.settings=p.system),R({content:"导入成功！"}),window.location.reload()),t.target.value=null}},y=t=>{let e={};t==="app"?e={type:t,data:u.lists}:t==="system"?e={type:t,data:i.settings}:t==="all"&&(e={type:t,data:{app:u.lists,system:i.settings}});const n=new Blob([JSON.stringify(e,null,2)],{type:"application/json"});H.saveAs(n,`${v[t]} - ${F().format("YYYYMMDDHHmmss")}.json`)},c=t=>{t==="app"?u.reset():t==="system"?i.reset():t==="all"&&(u.reset(),i.reset())};return(t,e)=>{const n=j("a-button"),o=j("a-form-item"),a=j("a-popconfirm"),p=j("a-form");return U(),B("div",N,[l(p,{model:f.value,"label-col":x},{default:r(()=>[l(o,{label:"导入"},{default:r(()=>[l(n,{type:"primary"},{default:r(()=>[b("label",I,[m(" 导入配置 "),b("input",{id:"json",type:"file",accept:".json",hidden:"",onChange:s},null,32)])]),_:1})]),_:1}),l(o,{label:"导出"},{default:r(()=>[l(n,{type:"primary",onClick:e[0]||(e[0]=d=>y("app")),style:{"margin-bottom":"12px"}},{default:r(()=>[m("导出首页配置")]),_:1}),V,l(n,{type:"primary",onClick:e[1]||(e[1]=d=>y("system")),style:{"margin-bottom":"12px"}},{default:r(()=>[m("导出系统配置")]),_:1}),Y,l(n,{type:"primary",onClick:e[2]||(e[2]=d=>y("all"))},{default:r(()=>[m("导出全部配置")]),_:1})]),_:1}),l(o,{label:"重置"},{default:r(()=>[l(n,{type:"primary",onClick:e[3]||(e[3]=d=>c("app")),style:{"margin-bottom":"12px"}},{default:r(()=>[m("重置首页配置")]),_:1}),q,l(n,{type:"primary",onClick:e[4]||(e[4]=d=>c("system")),style:{"margin-bottom":"12px"}},{default:r(()=>[m("重置系统配置")]),_:1}),J,l(a,{title:"确认重置全部配置？",onConfirm:e[5]||(e[5]=d=>c("all"))},{default:r(()=>[l(n,{type:"primary",style:{"margin-bottom":"12px"}},{default:r(()=>[m("重置全部配置")]),_:1})]),_:1})]),_:1})]),_:1},8,["model"])])}}},K=O(G,[["__scopeId","data-v-fbac3178"]]);export{K as default};
