import{c as s,A as E,_ as U,u as F,a as q,r as V,w as X,n as G,b as f,o as d,d as h,e as l,f as R,g as o,h as B,t as M,i as c,j as A,k as N,l as pe,v as me,S as re,F as Y,m as Z,p as ue,E as de,D as fe,C as _e,q as J,s as ge,x as he,y as ye,z as be}from"./index-ecdf5d5d.js";import{s as Q,g as Ce,d as ve,u as W}from"./utils-5dfaf7e4.js";var Oe={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M408 442h480c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8H408c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8zm-8 204c0 4.4 3.6 8 8 8h480c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8H408c-4.4 0-8 3.6-8 8v56zm504-486H120c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8h784c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8zm0 632H120c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8h784c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8zM142.4 642.1L298.7 519a8.84 8.84 0 000-13.9L142.4 381.9c-5.8-4.6-14.4-.5-14.4 6.9v246.3a8.9 8.9 0 0014.4 7z"}}]},name:"menu-unfold",theme:"outlined"};const $e=Oe;function ie(n){for(var t=1;t<arguments.length;t++){var e=arguments[t]!=null?Object(arguments[t]):{},i=Object.keys(e);typeof Object.getOwnPropertySymbols=="function"&&(i=i.concat(Object.getOwnPropertySymbols(e).filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable}))),i.forEach(function(a){xe(n,a,e[a])})}return n}function xe(n,t,e){return t in n?Object.defineProperty(n,t,{value:e,enumerable:!0,configurable:!0,writable:!0}):n[t]=e,n}var K=function(t,e){var i=ie({},t,e.attrs);return s(E,ie({},i,{icon:$e}),null)};K.displayName="MenuUnfoldOutlined";K.inheritAttrs=!1;const we=K;var Le={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M512 64C264.6 64 64 264.6 64 512s200.6 448 448 448 448-200.6 448-448S759.4 64 512 64zm0 820c-205.4 0-372-166.6-372-372s166.6-372 372-372 372 166.6 372 372-166.6 372-372 372zm-88-532h-48c-4.4 0-8 3.6-8 8v304c0 4.4 3.6 8 8 8h48c4.4 0 8-3.6 8-8V360c0-4.4-3.6-8-8-8zm224 0h-48c-4.4 0-8 3.6-8 8v304c0 4.4 3.6 8 8 8h48c4.4 0 8-3.6 8-8V360c0-4.4-3.6-8-8-8z"}}]},name:"pause-circle",theme:"outlined"};const Pe=Le;function le(n){for(var t=1;t<arguments.length;t++){var e=arguments[t]!=null?Object(arguments[t]):{},i=Object.keys(e);typeof Object.getOwnPropertySymbols=="function"&&(i=i.concat(Object.getOwnPropertySymbols(e).filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable}))),i.forEach(function(a){ke(n,a,e[a])})}return n}function ke(n,t,e){return t in n?Object.defineProperty(n,t,{value:e,enumerable:!0,configurable:!0,writable:!0}):n[t]=e,n}var ee=function(t,e){var i=le({},t,e.attrs);return s(E,le({},i,{icon:Pe}),null)};ee.displayName="PauseCircleOutlined";ee.inheritAttrs=!1;const Se=ee;var Ie={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M512 64C264.6 64 64 264.6 64 512s200.6 448 448 448 448-200.6 448-448S759.4 64 512 64zm0 820c-205.4 0-372-166.6-372-372s166.6-372 372-372 372 166.6 372 372-166.6 372-372 372z"}},{tag:"path",attrs:{d:"M719.4 499.1l-296.1-215A15.9 15.9 0 00398 297v430c0 13.1 14.8 20.5 25.3 12.9l296.1-215a15.9 15.9 0 000-25.8zm-257.6 134V390.9L628.5 512 461.8 633.1z"}}]},name:"play-circle",theme:"outlined"};const Me=Ie;function ae(n){for(var t=1;t<arguments.length;t++){var e=arguments[t]!=null?Object(arguments[t]):{},i=Object.keys(e);typeof Object.getOwnPropertySymbols=="function"&&(i=i.concat(Object.getOwnPropertySymbols(e).filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable}))),i.forEach(function(a){je(n,a,e[a])})}return n}function je(n,t,e){return t in n?Object.defineProperty(n,t,{value:e,enumerable:!0,configurable:!0,writable:!0}):n[t]=e,n}var te=function(t,e){var i=ae({},t,e.attrs);return s(E,ae({},i,{icon:Me}),null)};te.displayName="PlayCircleOutlined";te.inheritAttrs=!1;const Ve=te;var ze={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M762 164h-64c-4.4 0-8 3.6-8 8v688c0 4.4 3.6 8 8 8h64c4.4 0 8-3.6 8-8V172c0-4.4-3.6-8-8-8zm-508 0v72.4c0 9.5 4.2 18.4 11.4 24.5L564.6 512 265.4 763.1c-7.2 6.1-11.4 15-11.4 24.5V860c0 6.8 7.9 10.5 13.1 6.1L689 512 267.1 157.9A7.95 7.95 0 00254 164z"}}]},name:"vertical-left",theme:"outlined"};const De=ze;function oe(n){for(var t=1;t<arguments.length;t++){var e=arguments[t]!=null?Object(arguments[t]):{},i=Object.keys(e);typeof Object.getOwnPropertySymbols=="function"&&(i=i.concat(Object.getOwnPropertySymbols(e).filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable}))),i.forEach(function(a){Te(n,a,e[a])})}return n}function Te(n,t,e){return t in n?Object.defineProperty(n,t,{value:e,enumerable:!0,configurable:!0,writable:!0}):n[t]=e,n}var ne=function(t,e){var i=oe({},t,e.attrs);return s(E,oe({},i,{icon:De}),null)};ne.displayName="VerticalLeftOutlined";ne.inheritAttrs=!1;const Ne=ne;var Re={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M326 164h-64c-4.4 0-8 3.6-8 8v688c0 4.4 3.6 8 8 8h64c4.4 0 8-3.6 8-8V172c0-4.4-3.6-8-8-8zm444 72.4V164c0-6.8-7.9-10.5-13.1-6.1L335 512l421.9 354.1c5.2 4.4 13.1.7 13.1-6.1v-72.4c0-9.4-4.2-18.4-11.4-24.5L459.4 512l299.2-251.1c7.2-6.1 11.4-15.1 11.4-24.5z"}}]},name:"vertical-right",theme:"outlined"};const Ae=Re;function ce(n){for(var t=1;t<arguments.length;t++){var e=arguments[t]!=null?Object(arguments[t]):{},i=Object.keys(e);typeof Object.getOwnPropertySymbols=="function"&&(i=i.concat(Object.getOwnPropertySymbols(e).filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable}))),i.forEach(function(a){Ee(n,a,e[a])})}return n}function Ee(n,t,e){return t in n?Object.defineProperty(n,t,{value:e,enumerable:!0,configurable:!0,writable:!0}):n[t]=e,n}var se=function(t,e){var i=ce({},t,e.attrs);return s(E,ce({},i,{icon:Ae}),null)};se.displayName="VerticalRightOutlined";se.inheritAttrs=!1;const He=se;const Be={class:"music-box"},Ue={key:0,class:"info"},Fe={key:1,class:"info"},qe=["src"],Ge={class:"progress-box"},Je={class:"ctrl"},Qe={class:"mode"},We=["title"],Xe=["src","loop"],Ye={__name:"MusicCtrl",emits:["toggleMusicList","showSearch"],setup(n,{emit:t}){const{useMusicStore:e}=F(),i=()=>{t("toggleMusicList")},a=()=>{t("showSearch")},S=q(()=>({listCycle:"列表循环",singleCycle:"单曲循环",randomPlay:"随机播放"})[e.settings.mode]),I=u=>{e.changeMode(u)},b=u=>{e.toggleMute(u)},m=V({}),w=V(0),j=V(1e3),y=V(null);X(()=>[e.activeIndex,e.settings.playing],()=>{m.value=e.musicList[e.activeIndex],G(()=>{y.value&&(j.value=parseInt(y.value.duration),y.value.volume=e.settings.volume/100,e.settings.playing&&y.value.play())})},{immediate:!0,deep:!0});const D=()=>{j.value=parseInt(y.value.duration),w.value=y.value.currentTime=e.settings.currentTime},z=u=>{const{currentTime:v,duration:T}=u.target;w.value=e.settings.currentTime=parseInt(v),j.value=parseInt(T)},r=u=>Q(u),_=u=>{e.settings.currentTime=u,y.value&&G(()=>{y.value.currentTime=u})};X(()=>[e.settings.volume,e.settings.mute],()=>{y.value&&G(()=>{y.value.volume=e.settings.volume/100,y.value.muted=e.settings.mute})},{immediate:!0,deep:!0});const x=()=>{!e.musicList.length||e.activeIndex<0||(e.settings.playing=!0,y.value.play())},C=()=>{!e.musicList.length||e.activeIndex<0||(e.settings.playing=!1,y.value.pause())},g=q(()=>{if(!e.musicList.length||e.activeIndex<0)return"";let u=e.activeIndex===0?e.musicList.length-1:e.activeIndex-1;return e.musicList[u]?e.musicList[u].name:""}),O=()=>{if(!e.musicList.length||e.activeIndex<0)return;let u=e.activeIndex===0?e.musicList.length-1:e.activeIndex-1;e.playMusic(u)},L=q(()=>{if(!e.musicList.length||e.activeIndex<0)return"";let u=e.activeIndex===e.musicList.length-1?0:e.activeIndex+1;return e.musicList[u]?e.musicList[u].name:""}),P=()=>{if(!e.musicList.length||e.activeIndex<0)return;let u=e.activeIndex===e.musicList.length-1?0:e.activeIndex+1;e.playMusic(u)},H=()=>{e.settings.mode==="listCycle"?P():e.settings.mode==="singleCycle"?e.playMusic(e.activeIndex):e.settings.mode==="randomPlay"&&e.playMusic(Ce(0,e.musicList.length-1,e.activeIndex))};return(u,v)=>{var k;const T=f("a-slider"),p=f("a-tooltip");return d(),h("div",Be,[l(e).musicList.length?(d(),h("div",Fe,[o("img",{class:B(["cover",{playing:l(e).settings.playing}]),src:m.value.cover,onerror:"this.src='./images/music.png'",alt:""},null,10,qe),R(" "+M(m.value.name)+" - "+M(m.value.singer)+" ",1),o("div",Ge,[o("p",null,M(l(Q)(w.value)),1),s(T,{class:"play-slider",min:0,max:j.value,onChange:_,value:w.value,"onUpdate:value":v[0]||(v[0]=$=>w.value=$),tipFormatter:r},null,8,["max","value"]),o("p",null,M(l(Q)(j.value)),1)])])):(d(),h("div",Ue,[R(" 暂无音乐，请选择"),o("span",{class:"add",onClick:a},"添加")])),o("div",Je,[s(p,{title:`上一首${g.value?"：":""}${g.value}`},{default:c(()=>[s(l(He),{onClick:O})]),_:1},8,["title"]),s(p,{title:l(e).settings.playing?"点击暂停":"点击播放"},{default:c(()=>[l(e).settings.playing?(d(),A(l(Se),{key:1,class:"pause",onClick:C})):(d(),A(l(Ve),{key:0,class:"play",onClick:x}))]),_:1},8,["title"]),s(p,{title:`下一首${L.value?"：":""}${L.value}`},{default:c(()=>[s(l(Ne),{onClick:P})]),_:1},8,["title"]),s(p,{title:"播放列表"},{default:c(()=>[s(l(we),{onClick:i})]),_:1}),o("div",Qe,[s(p,{title:S.value},{default:c(()=>[l(e).settings.mode==="listCycle"?(d(),h("i",{key:0,class:"ifishfont ifish-musicListLoop",title:"列表循环",onClick:v[1]||(v[1]=$=>I("singleCycle"))})):N("",!0),l(e).settings.mode==="singleCycle"?(d(),h("i",{key:1,class:"ifishfont ifish-musicSingleCycle",title:"单曲循环",onClick:v[2]||(v[2]=$=>I("randomPlay"))})):N("",!0),l(e).settings.mode==="randomPlay"?(d(),h("i",{key:2,class:"ifishfont ifish-musicRandomPlay",title:"随机播放",onClick:v[3]||(v[3]=$=>I("listCycle"))})):N("",!0)]),_:1},8,["title"])]),o("div",{class:"volume",title:`当前音量：${l(e).settings.volume}`},[l(e).settings.mute||l(e).settings.volume===0?(d(),h("i",{key:0,class:"ifishfont ifish-volumeDisable",onClick:v[4]||(v[4]=$=>b(!0))})):l(e).settings.volume>=0&&l(e).settings.volume<30?(d(),h("i",{key:1,class:"ifishfont ifish-volumeLow",onClick:v[5]||(v[5]=$=>b(!1))})):l(e).settings.volume>=30&&l(e).settings.volume<60?(d(),h("i",{key:2,class:"ifishfont ifish-volumeMiddle",onClick:v[6]||(v[6]=$=>b(!1))})):(d(),h("i",{key:3,class:"ifishfont ifish-volumeHigh",onClick:v[7]||(v[7]=$=>b(!1))})),s(T,{class:"volume-slider",min:0,max:100,value:l(e).settings.volume,"onUpdate:value":v[8]||(v[8]=$=>l(e).settings.volume=$)},null,8,["value"])],8,We),pe(o("audio",{ref_key:"audioRef",ref:y,controls:"",src:(k=m.value)==null?void 0:k.url,loop:l(e).settings.mode==="singleCycle",onTimeupdate:z,onLoadeddata:D,onEnded:H,onError:H},null,40,Xe),[[me,!1]])])])}}},Ze=U(Ye,[["__scopeId","data-v-b775c6c3"]]);const Ke={class:"music-box"},et={class:"title"},tt={class:"music-list"},nt=["onClick"],st={class:"music-cover"},it=["src"],lt={class:"music-info"},at=["onClick"],ot=["onClick"],ct=["onClick"],rt={__name:"MusicList",props:{open:{type:Boolean,default:!1}},emits:["close","showSearch"],setup(n,{emit:t}){const{useMusicStore:e}=F(),i=()=>{t("close")},a=()=>{t("showSearch")},S=m=>{e.playMusic(m)},I=m=>{m<e.activeIndex?(e.musicList.splice(m,1),e.activeIndex--):(m===e.activeIndex&&(e.settings.currentTime=0,e.activeIndex++,e.activeIndex--),e.musicList.splice(m,1))},b=m=>{ve(m.url)};return(m,w)=>{const j=f("a-input"),y=f("a-empty"),D=f("a-menu-item"),z=f("a-menu"),r=f("a-dropdown"),_=f("perfect-scrollbar"),x=f("a-drawer");return d(),A(x,{width:"350px",title:"播放列表",placement:"right",open:n.open,onClose:i,rootClassName:"disclaimers-root"},{default:c(()=>[o("div",Ke,[s(j,{onClick:a,readonly:"",placeholder:"搜索",style:{"border-radius":"20px"}},{prefix:c(()=>[s(l(re))]),_:1}),o("div",null,[o("p",et,"播放列表（共"+M(l(e).musicList.length)+"首）",1),l(e).musicList.length?N("",!0):(d(),A(y,{key:0,description:"暂无歌曲，请搜索添加"})),s(_,{class:"scroll-bar"},{default:c(()=>[o("div",tt,[(d(!0),h(Y,null,Z(l(e).musicList,(C,g)=>(d(),h("div",{class:B(["music-item",{active:l(e).activeIndex===g}]),key:g,onClick:O=>S(g)},[o("div",st,[o("img",{src:C.cover,onerror:"this.src='./images/music.png'",alt:""},null,8,it)]),o("div",lt,[o("p",null,M(C.name),1),o("span",null,M(C.singer),1)]),o("div",{class:"music-action",onClick:w[0]||(w[0]=ue(()=>{},["stop"]))},[s(r,{placement:"bottomLeft",arrow:""},{overlay:c(()=>[s(z,null,{default:c(()=>[s(D,null,{default:c(()=>[o("a",{href:"javascript:;",onClick:O=>S(g)},"播放",8,at)]),_:2},1024),s(D,null,{default:c(()=>[o("a",{href:"javascript:;",onClick:O=>I(g)},"移除",8,ot)]),_:2},1024),s(D,null,{default:c(()=>[o("a",{href:"javascript:;",onClick:O=>b(C)},"下载",8,ct)]),_:2},1024)]),_:2},1024)]),default:c(()=>[s(l(de))]),_:2},1024)])],10,nt))),128))])]),_:1})])])]),_:1},8,["open"])}}},ut=U(rt,[["__scopeId","data-v-5cf4bcb9"]]);const dt=n=>(ge("data-v-0ee2499c"),n=n(),he(),n),vt={class:"search"},pt={key:0,class:"search-history"},mt={class:"title"},ft={class:"search-history-box"},_t=["onClick"],gt={class:"text",title:"点击搜索"},ht={class:"search-list"},yt=dt(()=>o("p",{class:"title"},"搜索结果：",-1)),bt=["onClick"],Ct={title:"立即播放"},Ot={class:"search-action"},$t=["onClick"],xt=["onClick"],wt=["onClick"],Lt=["onClick"],Pt={__name:"MusicSearch",setup(n){const{useMusicStore:t}=F(),e=V(""),i=V([]),a=V(!1),S=r=>{t.searchHistory.indexOf(r)<0&&t.searchHistory.unshift(r),I(r)},I=r=>{e.value=r,a.value=!0,J.get(`https://xiaoapi.cn/API/yy_sq.php?msg=${r}`).then(_=>{i.value=_.data.list||[],a.value=!1})},b=()=>{t.searchHistory=[]},m=r=>{const _=t.searchHistory.indexOf(r);t.searchHistory.splice(_,1)},w=async(r,_)=>{const{cover:x,name:C,singer:g,url:O,content:L}=await z(r);t.musicList.push({id:W(21),cover:x,name:C,singer:g,url:O,content:L}),t.playMusic(t.musicList.length-1)},j=async(r,_)=>{const{cover:x,name:C,singer:g,url:O,content:L}=await z(r);t.musicList.push({id:W(21),cover:x,name:C,singer:g,url:O,content:L})},y=async(r,_)=>{const{cover:x,name:C,singer:g,url:O,content:L}=await z(r);t.musicList.splice(t.activeIndex,0,{id:W(21),cover:x,name:C,singer:g,url:O,content:L})},D=async(r,_)=>{const{url:x}=await z(r);x&&ve(x)},z=async(r,_)=>{const x=new Promise((O,L)=>{J.get(`https://xiaoapi.cn/API/yy_sq.php?msg=${r.name}-${r.singer}&n=1`).then(P=>{P.data.code===200?O(P.data):L()})}),C=new Promise((O,L)=>{J.get(`https://api.lolimi.cn/API/kggc/api.php?msg=${r.name}-${r.singer}&n=1`).then(P=>{P.data.code===1?O(P.data.data):L()})}),g=await Promise.all([x,C]);return{...g[0],...g[1]}};return(r,_)=>{const x=f("a-input"),C=f("a-col"),g=f("a-button"),O=f("a-row"),L=f("a-empty"),P=f("a-menu-item"),H=f("a-menu"),u=f("a-dropdown"),v=f("perfect-scrollbar"),T=f("a-spin");return d(),h("div",vt,[s(O,{gutter:12},{default:c(()=>[s(C,{span:20},{default:c(()=>[s(x,{value:e.value,"onUpdate:value":_[0]||(_[0]=p=>e.value=p),onPressEnter:_[1]||(_[1]=p=>S(p.target.value)),placeholder:"输入歌曲、歌手",allowClear:"",style:{"border-radius":"16px"}},{prefix:c(()=>[s(l(re))]),_:1},8,["value"])]),_:1}),s(C,{span:3},{default:c(()=>[s(g,{type:"primary",shape:"round",onClick:_[2]||(_[2]=p=>S(e.value))},{default:c(()=>[R("搜索")]),_:1})]),_:1})]),_:1}),l(t).searchHistory.length?(d(),h("div",pt,[o("p",mt,[R("搜索历史： "),o("span",{class:"clear",onClick:b},[s(l(fe)),R("清空历史搜索")])]),o("div",ft,[(d(!0),h(Y,null,Z(l(t).searchHistory,(p,k)=>(d(),h("p",{key:k,onClick:$=>I(p)},[o("span",gt,M(p),1),s(l(_e),{title:"点击移除",onClick:ue($=>m(p),["stop"])},null,8,["onClick"])],8,_t))),128))])])):N("",!0),o("div",ht,[yt,s(T,{spinning:a.value,tip:"加载中..."},{default:c(()=>[s(v,{class:"scroll-bar"},{default:c(()=>[i.value.length?N("",!0):(d(),A(L,{key:0})),o("ul",null,[(d(!0),h(Y,null,Z(i.value,(p,k)=>(d(),h("li",{key:k,onClick:$=>w(p,k)},[o("p",Ct,M(p.name)+" - "+M(p.singer),1),o("div",Ot,[s(u,{placement:"bottomLeft",arrow:""},{overlay:c(()=>[s(H,null,{default:c(()=>[s(P,null,{default:c(()=>[o("a",{href:"javascript:;",onClick:$=>j(p,k)},"添加到播放列表",8,$t)]),_:2},1024),s(P,null,{default:c(()=>[o("a",{href:"javascript:;",onClick:$=>w(p,k)},"立即播放",8,xt)]),_:2},1024),s(P,null,{default:c(()=>[o("a",{href:"javascript:;",onClick:$=>y(p,k)},"下一首播放",8,wt)]),_:2},1024),s(P,null,{default:c(()=>[o("a",{href:"javascript:;",onClick:$=>D(p,k)},"下载",8,Lt)]),_:2},1024)]),_:2},1024)]),default:c(()=>[s(l(de))]),_:2},1024)])],8,bt))),128))])]),_:1})]),_:1},8,["spinning"])])])}}},kt=U(Pt,[["__scopeId","data-v-0ee2499c"]]);const St={class:"music"},It=["title"],Mt={__name:"Index",setup(n){const{useMusicStore:t}=F();ye(()=>{t.settings.playing=!1});const e=()=>{t.toggleVisible()},i=V(!1);X(()=>t.visible,I=>{},{immediate:!0});const a=V(!1),S=()=>{a.value=!0};return(I,b)=>{const m=f("IDialog");return d(),h("div",St,[o("div",{class:B(["toggle-icon bf",[l(t).visible?"down":"up"]]),title:l(t).visible?"关闭播放器":"打开播放器",onClick:e},[s(l(be))],10,It),o("div",{class:B(["music-ctrl bf",[l(t).visible?"show":""]])},[s(Ze,{onShowSearch:S,onToggleMusicList:b[0]||(b[0]=w=>i.value=!i.value)})],2),s(ut,{open:i.value,onShowSearch:S,onClose:b[1]||(b[1]=w=>i.value=!1)},null,8,["open"]),s(m,{title:"搜索音乐",visible:a.value,zIndex:1002,onOk:b[2]||(b[2]=w=>a.value=!1),onCancel:b[3]||(b[3]=w=>a.value=!1)},{default:c(()=>[s(kt)]),_:1},8,["visible"])])}}},zt=U(Mt,[["__scopeId","data-v-000cb98a"]]);export{zt as default};
