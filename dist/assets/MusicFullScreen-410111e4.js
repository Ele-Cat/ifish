import{_ as oe,u as ue,e as re,a as de,s as O,m as F}from"./App-d4d33f3a.js";import{j as a,A as te,o as me,q as M,W as ve,w as D,J as fe,f as S,h as r,i as v,s,y as P,u as l,B as g,k as m,D as L,C as x,F as w,t as I,z as ge,X as pe,M as he,N as ye}from"./index-3952cf07.js";import{V as X,P as G,a as Q,b as Y,M as Z}from"./VerticalRightOutlined-c7791fea.js";var _e={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M391 240.9c-.8-6.6-8.9-9.4-13.6-4.7l-43.7 43.7L200 146.3a8.03 8.03 0 00-11.3 0l-42.4 42.3a8.03 8.03 0 000 11.3L280 333.6l-43.9 43.9a8.01 8.01 0 004.7 13.6L401 410c5.1.6 9.5-3.7 8.9-8.9L391 240.9zm10.1 373.2L240.8 633c-6.6.8-9.4 8.9-4.7 13.6l43.9 43.9L146.3 824a8.03 8.03 0 000 11.3l42.4 42.3c3.1 3.1 8.2 3.1 11.3 0L333.7 744l43.7 43.7A8.01 8.01 0 00391 783l18.9-160.1c.6-5.1-3.7-9.4-8.8-8.8zm221.8-204.2L783.2 391c6.6-.8 9.4-8.9 4.7-13.6L744 333.6 877.7 200c3.1-3.1 3.1-8.2 0-11.3l-42.4-42.3a8.03 8.03 0 00-11.3 0L690.3 279.9l-43.7-43.7a8.01 8.01 0 00-13.6 4.7L614.1 401c-.6 5.2 3.7 9.5 8.8 8.9zM744 690.4l43.9-43.9a8.01 8.01 0 00-4.7-13.6L623 614c-5.1-.6-9.5 3.7-8.9 8.9L633 783.1c.8 6.6 8.9 9.4 13.6 4.7l43.7-43.7L824 877.7c3.1 3.1 8.2 3.1 11.3 0l42.4-42.3c3.1-3.1 3.1-8.2 0-11.3L744 690.4z"}}]},name:"fullscreen-exit",theme:"outlined"};const Ce=_e;function K(e){for(var i=1;i<arguments.length;i++){var u=arguments[i]!=null?Object(arguments[i]):{},t=Object.keys(u);typeof Object.getOwnPropertySymbols=="function"&&(t=t.concat(Object.getOwnPropertySymbols(u).filter(function(f){return Object.getOwnPropertyDescriptor(u,f).enumerable}))),t.forEach(function(f){ke(e,f,u[f])})}return e}function ke(e,i,u){return i in e?Object.defineProperty(e,i,{value:u,enumerable:!0,configurable:!0,writable:!0}):e[i]=u,e}var N=function(i,u){var t=K({},i,u.attrs);return a(te,K({},t,{icon:Ce}),null)};N.displayName="FullscreenExitOutlined";N.inheritAttrs=!1;const Le=N;var be={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M290 236.4l43.9-43.9a8.01 8.01 0 00-4.7-13.6L169 160c-5.1-.6-9.5 3.7-8.9 8.9L179 329.1c.8 6.6 8.9 9.4 13.6 4.7l43.7-43.7L370 423.7c3.1 3.1 8.2 3.1 11.3 0l42.4-42.3c3.1-3.1 3.1-8.2 0-11.3L290 236.4zm352.7 187.3c3.1 3.1 8.2 3.1 11.3 0l133.7-133.6 43.7 43.7a8.01 8.01 0 0013.6-4.7L863.9 169c.6-5.1-3.7-9.5-8.9-8.9L694.8 179c-6.6.8-9.4 8.9-4.7 13.6l43.9 43.9L600.3 370a8.03 8.03 0 000 11.3l42.4 42.4zM845 694.9c-.8-6.6-8.9-9.4-13.6-4.7l-43.7 43.7L654 600.3a8.03 8.03 0 00-11.3 0l-42.4 42.3a8.03 8.03 0 000 11.3L734 787.6l-43.9 43.9a8.01 8.01 0 004.7 13.6L855 864c5.1.6 9.5-3.7 8.9-8.9L845 694.9zm-463.7-94.6a8.03 8.03 0 00-11.3 0L236.3 733.9l-43.7-43.7a8.01 8.01 0 00-13.6 4.7L160.1 855c-.6 5.1 3.7 9.5 8.9 8.9L329.2 845c6.6-.8 9.4-8.9 4.7-13.6L290 787.6 423.7 654c3.1-3.1 3.1-8.2 0-11.3l-42.4-42.4z"}}]},name:"fullscreen",theme:"outlined"};const xe=be;function ee(e){for(var i=1;i<arguments.length;i++){var u=arguments[i]!=null?Object(arguments[i]):{},t=Object.keys(u);typeof Object.getOwnPropertySymbols=="function"&&(t=t.concat(Object.getOwnPropertySymbols(u).filter(function(f){return Object.getOwnPropertyDescriptor(u,f).enumerable}))),t.forEach(function(f){Oe(e,f,u[f])})}return e}function Oe(e,i,u){return i in e?Object.defineProperty(e,i,{value:u,enumerable:!0,configurable:!0,writable:!0}):e[i]=u,e}var B=function(i,u){var t=ee({},i,u.attrs);return a(te,ee({},t,{icon:xe}),null)};B.displayName="FullscreenOutlined";B.inheritAttrs=!1;const Me=B;const Pe=e=>(he("data-v-41b50150"),e=e(),ye(),e),$e={class:"bg"},Se=["src"],Fe=Pe(()=>s("div",{class:"mask"},null,-1)),De={class:"music-info"},we=["src"],Ie={class:"name"},Ne={class:"singer"},Be={class:"progress-box"},Ee={class:"prev-next"},Te={class:"mode"},ze={class:"music-list"},je=["onClick"],Re={class:"music-cover"},Ve=["src"],Ae={class:"music-info"},He={class:"music-lyric"},Ue={key:0,class:"no-lyric"},qe=["onClick"],Je={class:"ctrl-btm"},We={class:"progress-box"},Xe={class:"prev-next"},Ge={class:"mode"},Qe={class:"music-list"},Ye=["onClick"],Ze={class:"music-cover"},Ke=["src"],et={class:"music-info"},tt={class:"action"},lt={__name:"MusicFullScreen",props:{open:{type:Boolean,default:!1},musicCurrentTime:{type:Number,default:0},musicDuration:{type:Number,default:0},prevMusic:{type:String,default:""},nextMusic:{type:String,default:""},musicMode:{type:String,default:""}},emits:["close","handleDurationChange","handlePlay","handlePause","handlePrev","handleNext"],setup(e,{emit:i}){const u=e,{useMusicStore:t}=ue();me(()=>{re.on("lyricClose",()=>{j()})});const f=M(!1),E=M(null),{isFullscreen:le,toggle:T,exit:se}=ve(E),h=M({});D(()=>[t.activeIndex,t.settings.playing],()=>{h.value=t.musicList[t.activeIndex]||{}},{immediate:!0,deep:!0});const ne=c=>{const n=[];return c.split(`
`).map(d=>{let _=d.match(/\[(.*?)\]/);if(_){let k=_[1];/^(0\d|1\d|2[0-3]):([0-5]\d)\.(?:\d{2})$/.test(k)&&n.push({time:k,lyric:d.replace(/\[.*?\]/g,"")})}}),n},$=fe(()=>{var n,C,d;let c=[];return t.activeIndex<0?[]:((C=(n=h.value)==null?void 0:n.content)!=null&&C.length?c=ne((d=h.value)==null?void 0:d.content):ce(),c)}),y=M(0);D(()=>u.musicCurrentTime,c=>{y.value=c},{immediate:!0,deep:!0});const z=M(0),ie=c=>{var k;const C=F($.value[c].time),d=F((k=$.value[c+1])==null?void 0:k.time),_=y.value+1>=C&&(y.value+1<d||!d);return _&&(z.value=c),_};D(()=>z.value,()=>{let c=document.getElementById("lyric-list");if(c){let n=c.querySelector(".active");n&&c.scrollTo({top:n.offsetTop-c.clientHeight/2+n.clientHeight/2,behavior:"smooth"})}},{immediate:!0,deep:!0});const ce=()=>{h.value.name&&de.get(`https://api.lolimi.cn/API/kggc/api.php?msg=${h.value.name}-${h.value.singer}&n=1`).then(c=>{const{content:n}=c.data.data||{};c.data.code===1&&(t.musicList[t.activeIndex].content=n)})},j=()=>{se(),i("close")},R=c=>{t.playMusic(c)},b=c=>{t.changeMode(c)},V=c=>O(c),A=c=>{i("handleDurationChange",c)},H=()=>{i("handlePlay")},U=()=>{i("handlePause")},q=()=>{i("handlePrev")},J=()=>{i("handleNext")},ae=(c,n)=>{i("handleDurationChange",F(c.time)),i("handlePlay")};return(c,n)=>{const C=S("a-slider"),d=S("a-tooltip"),_=S("perfect-scrollbar"),k=S("a-popover");return r(),v("div",{ref_key:"fullscreenRef",ref:E,class:P(["music-fullscreen",{open:e.open}])},[s("div",$e,[s("img",{src:h.value.cover,alt:""},null,8,Se),Fe]),s("div",De,[s("img",{class:P(["cover",{playing:f.value||l(t).settings.playing}]),onClick:n[0]||(n[0]=o=>f.value=!f.value),src:h.value.cover,alt:""},null,10,we),s("p",Ie,g(h.value.name),1),s("span",Ne,g(h.value.singer),1),s("div",Be,[s("p",null,g(l(O)(y.value)),1),a(C,{class:"play-slider",min:0,max:e.musicDuration,onChange:A,value:y.value,"onUpdate:value":n[1]||(n[1]=o=>y.value=o),tipFormatter:V},null,8,["max","value"]),s("p",null,g(l(O)(e.musicDuration)),1)]),s("div",Ee,[s("div",Te,[a(d,{title:e.musicMode},{default:m(()=>[l(t).settings.mode==="listCycle"?(r(),v("i",{key:0,class:"ifishfont ifish-musicListLoop",title:"列表循环",onClick:n[2]||(n[2]=o=>b("singleCycle"))})):L("",!0),l(t).settings.mode==="singleCycle"?(r(),v("i",{key:1,class:"ifishfont ifish-musicSingleCycle",title:"单曲循环",onClick:n[3]||(n[3]=o=>b("randomPlay"))})):L("",!0),l(t).settings.mode==="randomPlay"?(r(),v("i",{key:2,class:"ifishfont ifish-musicRandomPlay",title:"随机播放",onClick:n[4]||(n[4]=o=>b("listCycle"))})):L("",!0)]),_:1},8,["title"])]),a(d,{title:`上一首${e.prevMusic?"：":""}${e.prevMusic}`},{default:m(()=>[a(l(X),{onClick:q})]),_:1},8,["title"]),a(d,{title:l(t).settings.playing?"点击暂停":"点击播放"},{default:m(()=>[l(t).settings.playing?(r(),x(l(Q),{key:1,class:"pause",onClick:U})):(r(),x(l(G),{key:0,class:"play",onClick:H}))]),_:1},8,["title"]),a(d,{title:`下一首${e.nextMusic?"：":""}${e.nextMusic}`},{default:m(()=>[a(l(Y),{onClick:J})]),_:1},8,["title"]),a(k,{title:"播放列表",placement:"rightBottom"},{content:m(()=>[a(_,{class:"scroll-music"},{default:m(()=>[s("div",ze,[(r(!0),v(w,null,I(l(t).musicList,(o,p)=>(r(),v("div",{class:P(["music-item",{active:l(t).activeIndex===p}]),key:p,onClick:W=>R(p)},[s("div",Re,[s("img",{src:o.cover,onerror:"this.src='./images/music.png'",alt:""},null,8,Ve)]),s("div",Ae,[s("p",null,g(o.name),1),s("span",null,g(o.singer),1)])],10,je))),128))])]),_:1})]),default:m(()=>[a(l(Z),{class:"list-ico"})]),_:1})])]),s("div",He,[$.value.length?L("",!0):(r(),v("p",Ue,"暂无歌词")),a(_,{class:"scroll-bar",id:"lyric-list"},{default:m(()=>[(r(!0),v(w,null,I($.value,(o,p)=>(r(),v("p",{class:P({active:ie(p)}),key:p,onClick:W=>ae(o,p)},[s("span",null,g(o.time),1),ge(" "+g(o.lyric),1)],10,qe))),128))]),_:1})]),s("div",Je,[s("div",We,[s("p",null,g(l(O)(y.value)),1),a(C,{class:"play-slider",min:0,max:e.musicDuration,onChange:A,value:y.value,"onUpdate:value":n[5]||(n[5]=o=>y.value=o),tipFormatter:V},null,8,["max","value"]),s("p",null,g(l(O)(e.musicDuration)),1)]),s("div",Xe,[s("div",Ge,[a(d,{title:e.musicMode},{default:m(()=>[l(t).settings.mode==="listCycle"?(r(),v("i",{key:0,class:"ifishfont ifish-musicListLoop",title:"列表循环",onClick:n[6]||(n[6]=o=>b("singleCycle"))})):L("",!0),l(t).settings.mode==="singleCycle"?(r(),v("i",{key:1,class:"ifishfont ifish-musicSingleCycle",title:"单曲循环",onClick:n[7]||(n[7]=o=>b("randomPlay"))})):L("",!0),l(t).settings.mode==="randomPlay"?(r(),v("i",{key:2,class:"ifishfont ifish-musicRandomPlay",title:"随机播放",onClick:n[8]||(n[8]=o=>b("listCycle"))})):L("",!0)]),_:1},8,["title"])]),a(d,{title:`上一首${e.prevMusic?"：":""}${e.prevMusic}`},{default:m(()=>[a(l(X),{onClick:q})]),_:1},8,["title"]),a(d,{title:l(t).settings.playing?"点击暂停":"点击播放"},{default:m(()=>[l(t).settings.playing?(r(),x(l(Q),{key:1,class:"pause",onClick:U})):(r(),x(l(G),{key:0,class:"play",onClick:H}))]),_:1},8,["title"]),a(d,{title:`下一首${e.nextMusic?"：":""}${e.nextMusic}`},{default:m(()=>[a(l(Y),{onClick:J})]),_:1},8,["title"]),a(k,{title:"播放列表",placement:"rightBottom"},{content:m(()=>[a(_,{class:"scroll-music"},{default:m(()=>[s("div",Qe,[(r(!0),v(w,null,I(l(t).musicList,(o,p)=>(r(),v("div",{class:P(["music-item",{active:l(t).activeIndex===p}]),key:p,onClick:W=>R(p)},[s("div",Ze,[s("img",{src:o.cover,onerror:"this.src='./images/music.png'",alt:""},null,8,Ke)]),s("div",et,[s("p",null,g(o.name),1),s("span",null,g(o.singer),1)])],10,Ye))),128))])]),_:1})]),default:m(()=>[a(l(Z))]),_:1})])]),s("div",tt,[a(l(pe),{class:"close",title:"关闭歌词",onClick:j}),l(le)?(r(),x(l(Le),{key:0,title:"关闭全屏",onClick:l(T)},null,8,["onClick"])):(r(),x(l(Me),{key:1,title:"开启全屏",onClick:l(T)},null,8,["onClick"]))])],2)}}},ct=oe(lt,[["__scopeId","data-v-41b50150"]]);export{ct as default};
