import{c as g,g as T,q as L,r as j,h as O,i as C,j as l,k as i,s as w,z as _,b as M,M as B,N as F}from"./index-7e7a3b23.js";import{_ as D,u as U,t as S}from"./App-7520e98d.js";var A={exports:{}};(function(v,u){(function(r,f){f()})(g,function(){function r(t,e){return typeof e>"u"?e={autoBom:!1}:typeof e!="object"&&(console.warn("Deprecated: Expected third argument to be a object"),e={autoBom:!e}),e.autoBom&&/^\s*(?:text\/\S*|application\/xml|\S*\/\S*\+xml)\s*;.*charset\s*=\s*utf-8/i.test(t.type)?new Blob(["\uFEFF",t],{type:t.type}):t}function f(t,e,n){var o=new XMLHttpRequest;o.open("GET",t),o.responseType="blob",o.onload=function(){p(o.response,e,n)},o.onerror=function(){console.error("could not download file")},o.send()}function x(t){var e=new XMLHttpRequest;e.open("HEAD",t,!1);try{e.send()}catch{}return 200<=e.status&&299>=e.status}function m(t){try{t.dispatchEvent(new MouseEvent("click"))}catch{var e=document.createEvent("MouseEvents");e.initMouseEvent("click",!0,!0,window,0,0,0,80,20,!1,!1,!1,!1,0,null),t.dispatchEvent(e)}}var s=typeof window=="object"&&window.window===window?window:typeof self=="object"&&self.self===self?self:typeof g=="object"&&g.global===g?g:void 0,y=s.navigator&&/Macintosh/.test(navigator.userAgent)&&/AppleWebKit/.test(navigator.userAgent)&&!/Safari/.test(navigator.userAgent),p=s.saveAs||(typeof window!="object"||window!==s?function(){}:"download"in HTMLAnchorElement.prototype&&!y?function(t,e,n){var o=s.URL||s.webkitURL,a=document.createElement("a");e=e||t.name||"download",a.download=e,a.rel="noopener",typeof t=="string"?(a.href=t,a.origin===location.origin?m(a):x(a.href)?f(t,e,n):m(a,a.target="_blank")):(a.href=o.createObjectURL(t),setTimeout(function(){o.revokeObjectURL(a.href)},4e4),setTimeout(function(){m(a)},0))}:"msSaveOrOpenBlob"in navigator?function(t,e,n){if(e=e||t.name||"download",typeof t!="string")navigator.msSaveOrOpenBlob(r(t,n),e);else if(x(t))f(t,e,n);else{var o=document.createElement("a");o.href=t,o.target="_blank",setTimeout(function(){m(o)})}}:function(t,e,n,o){if(o=o||open("","_blank"),o&&(o.document.title=o.document.body.innerText="downloading..."),typeof t=="string")return f(t,e,n);var a=t.type==="application/octet-stream",c=/constructor/i.test(s.HTMLElement)||s.safari,d=/CriOS\/[\d]+/.test(navigator.userAgent);if((d||a&&c||y)&&typeof FileReader<"u"){var E=new FileReader;E.onloadend=function(){var b=E.result;b=d?b:b.replace(/^data:[^;]*;/,"data:attachment/file;"),o?o.location.href=b:location=b,o=null},E.readAsDataURL(t)}else{var R=s.URL||s.webkitURL,k=R.createObjectURL(t);o?o.location=k:location.href=k,o=null,setTimeout(function(){R.revokeObjectURL(k)},4e4)}});s.saveAs=p.saveAs=p,v.exports=p})})(A);var $=A.exports;const H=T($);const h=v=>(B("data-v-d9912f1d"),v=v(),F(),v),N={class:"settings-export"},I={class:"label",for:"json"},Y=h(()=>w("br",null,null,-1)),q=h(()=>w("br",null,null,-1)),J=h(()=>w("br",null,null,-1)),V=h(()=>w("br",null,null,-1)),G={__name:"SettingsData",setup(v){const{useAppStore:u,useSystemStore:r}=U(),f=L({}),x={style:{width:"68px"}},m={app:"首页配置",system:"系统配置",all:"全部配置"},s=t=>{const e=t.target.files[0];if(!e.name.includes("json")){S({type:"warning",content:"只能插入json文件"});return}const n=new FileReader;n.readAsText(e),n.onload=o=>{const{type:a,data:c}=JSON.parse(o.target.result);!a||!["app","news","system","all"].includes(a)||!c?S({type:"warning",content:"JSON文件中的格式有问题，请检查后重试"}):(a==="app"?u.lists=c:a==="system"?r.settings=c:a==="all"&&(u.lists=c.app,r.settings=c.system),S({content:"导入成功！"}),setTimeout(()=>{window.location.reload()},1e3)),t.target.value=null}},y=t=>{let e={};t==="app"?e={type:t,data:u.lists}:t==="system"?e={type:t,data:r.settings}:t==="all"&&(e={type:t,data:{app:u.lists,system:r.settings}});const n=new Blob([JSON.stringify(e,null,2)],{type:"application/json"});H.saveAs(n,`${m[t]} - ${M().format("YYYYMMDDHHmmss")}.json`)},p=t=>{t==="app"?u.reset():t==="system"?r.reset():t==="all"&&(u.reset(),r.reset()),S({content:`${m[t]}重置成功！`}),setTimeout(()=>{window.location.reload()},1e3)};return(t,e)=>{const n=j("a-button"),o=j("a-form-item"),a=j("a-popconfirm"),c=j("a-form");return O(),C("div",N,[l(c,{model:f.value,"label-col":x},{default:i(()=>[l(o,{label:"导入"},{default:i(()=>[l(n,{type:"primary"},{default:i(()=>[w("label",I,[_(" 导入配置 "),w("input",{id:"json",type:"file",accept:".json",hidden:"",onChange:s},null,32)])]),_:1})]),_:1}),l(o,{label:"导出"},{default:i(()=>[l(n,{type:"primary",onClick:e[0]||(e[0]=d=>y("app")),style:{"margin-bottom":"12px"}},{default:i(()=>[_("导出首页配置")]),_:1}),Y,l(n,{type:"primary",onClick:e[1]||(e[1]=d=>y("system")),style:{"margin-bottom":"12px"}},{default:i(()=>[_("导出系统配置")]),_:1}),q,l(n,{type:"primary",onClick:e[2]||(e[2]=d=>y("all"))},{default:i(()=>[_("导出全部配置")]),_:1})]),_:1}),l(o,{label:"重置"},{default:i(()=>[l(n,{type:"primary",onClick:e[3]||(e[3]=d=>p("app")),style:{"margin-bottom":"12px"}},{default:i(()=>[_("重置首页配置")]),_:1}),J,l(n,{type:"primary",onClick:e[4]||(e[4]=d=>p("system")),style:{"margin-bottom":"12px"}},{default:i(()=>[_("重置系统配置")]),_:1}),V,l(a,{title:"确认重置全部配置？",onConfirm:e[5]||(e[5]=d=>p("all"))},{default:i(()=>[l(n,{type:"primary",style:{"margin-bottom":"12px"}},{default:i(()=>[_("重置全部配置")]),_:1})]),_:1})]),_:1})]),_:1},8,["model"])])}}},K=D(G,[["__scopeId","data-v-d9912f1d"]]);export{K as default};
