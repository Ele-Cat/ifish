import{c as i,A as J,_ as ne,u as ee,r as Ve,a as $,o as v,b as O,w as o,d as l,t as L,e as a,f as H,p as xe,g as Le,h as P,i as Y,n as q,j as U,k as R,F as K,S as Pe,D as Me,l as te,m as ke,E as Se,C as Ee,q as Fe,s as X,v as we,x as W,y as Ae,z as se,B as Re,G as le,H as Be,I as Ue,J as qe}from"./index-233988fb.js";import{s as Z,d as Ie,u as ie,m as ae,g as Je}from"./utils-7dc22624.js";var Ge={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M391 240.9c-.8-6.6-8.9-9.4-13.6-4.7l-43.7 43.7L200 146.3a8.03 8.03 0 00-11.3 0l-42.4 42.3a8.03 8.03 0 000 11.3L280 333.6l-43.9 43.9a8.01 8.01 0 004.7 13.6L401 410c5.1.6 9.5-3.7 8.9-8.9L391 240.9zm10.1 373.2L240.8 633c-6.6.8-9.4 8.9-4.7 13.6l43.9 43.9L146.3 824a8.03 8.03 0 000 11.3l42.4 42.3c3.1 3.1 8.2 3.1 11.3 0L333.7 744l43.7 43.7A8.01 8.01 0 00391 783l18.9-160.1c.6-5.1-3.7-9.4-8.8-8.8zm221.8-204.2L783.2 391c6.6-.8 9.4-8.9 4.7-13.6L744 333.6 877.7 200c3.1-3.1 3.1-8.2 0-11.3l-42.4-42.3a8.03 8.03 0 00-11.3 0L690.3 279.9l-43.7-43.7a8.01 8.01 0 00-13.6 4.7L614.1 401c-.6 5.2 3.7 9.5 8.8 8.9zM744 690.4l43.9-43.9a8.01 8.01 0 00-4.7-13.6L623 614c-5.1-.6-9.5 3.7-8.9 8.9L633 783.1c.8 6.6 8.9 9.4 13.6 4.7l43.7-43.7L824 877.7c3.1 3.1 8.2 3.1 11.3 0l42.4-42.3c3.1-3.1 3.1-8.2 0-11.3L744 690.4z"}}]},name:"fullscreen-exit",theme:"outlined"};const Ye=Ge;function fe(n){for(var e=1;e<arguments.length;e++){var t=arguments[e]!=null?Object(arguments[e]):{},s=Object.keys(t);typeof Object.getOwnPropertySymbols=="function"&&(s=s.concat(Object.getOwnPropertySymbols(t).filter(function(c){return Object.getOwnPropertyDescriptor(t,c).enumerable}))),s.forEach(function(c){Qe(n,c,t[c])})}return n}function Qe(n,e,t){return e in n?Object.defineProperty(n,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):n[e]=t,n}var ce=function(e,t){var s=fe({},e,t.attrs);return i(J,fe({},s,{icon:Ye}),null)};ce.displayName="FullscreenExitOutlined";ce.inheritAttrs=!1;const We=ce;var Xe={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M290 236.4l43.9-43.9a8.01 8.01 0 00-4.7-13.6L169 160c-5.1-.6-9.5 3.7-8.9 8.9L179 329.1c.8 6.6 8.9 9.4 13.6 4.7l43.7-43.7L370 423.7c3.1 3.1 8.2 3.1 11.3 0l42.4-42.3c3.1-3.1 3.1-8.2 0-11.3L290 236.4zm352.7 187.3c3.1 3.1 8.2 3.1 11.3 0l133.7-133.6 43.7 43.7a8.01 8.01 0 0013.6-4.7L863.9 169c.6-5.1-3.7-9.5-8.9-8.9L694.8 179c-6.6.8-9.4 8.9-4.7 13.6l43.9 43.9L600.3 370a8.03 8.03 0 000 11.3l42.4 42.4zM845 694.9c-.8-6.6-8.9-9.4-13.6-4.7l-43.7 43.7L654 600.3a8.03 8.03 0 00-11.3 0l-42.4 42.3a8.03 8.03 0 000 11.3L734 787.6l-43.9 43.9a8.01 8.01 0 004.7 13.6L855 864c5.1.6 9.5-3.7 8.9-8.9L845 694.9zm-463.7-94.6a8.03 8.03 0 00-11.3 0L236.3 733.9l-43.7-43.7a8.01 8.01 0 00-13.6 4.7L160.1 855c-.6 5.1 3.7 9.5 8.9 8.9L329.2 845c6.6-.8 9.4-8.9 4.7-13.6L290 787.6 423.7 654c3.1-3.1 3.1-8.2 0-11.3l-42.4-42.4z"}}]},name:"fullscreen",theme:"outlined"};const Ze=Xe;function ge(n){for(var e=1;e<arguments.length;e++){var t=arguments[e]!=null?Object(arguments[e]):{},s=Object.keys(t);typeof Object.getOwnPropertySymbols=="function"&&(s=s.concat(Object.getOwnPropertySymbols(t).filter(function(c){return Object.getOwnPropertyDescriptor(t,c).enumerable}))),s.forEach(function(c){Ke(n,c,t[c])})}return n}function Ke(n,e,t){return e in n?Object.defineProperty(n,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):n[e]=t,n}var oe=function(e,t){var s=ge({},e,t.attrs);return i(J,ge({},s,{icon:Ze}),null)};oe.displayName="FullscreenOutlined";oe.inheritAttrs=!1;const et=oe;var tt={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M408 442h480c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8H408c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8zm-8 204c0 4.4 3.6 8 8 8h480c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8H408c-4.4 0-8 3.6-8 8v56zm504-486H120c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8h784c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8zm0 632H120c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8h784c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8zM142.4 642.1L298.7 519a8.84 8.84 0 000-13.9L142.4 381.9c-5.8-4.6-14.4-.5-14.4 6.9v246.3a8.9 8.9 0 0014.4 7z"}}]},name:"menu-unfold",theme:"outlined"};const nt=tt;function he(n){for(var e=1;e<arguments.length;e++){var t=arguments[e]!=null?Object(arguments[e]):{},s=Object.keys(t);typeof Object.getOwnPropertySymbols=="function"&&(s=s.concat(Object.getOwnPropertySymbols(t).filter(function(c){return Object.getOwnPropertyDescriptor(t,c).enumerable}))),s.forEach(function(c){st(n,c,t[c])})}return n}function st(n,e,t){return e in n?Object.defineProperty(n,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):n[e]=t,n}var re=function(e,t){var s=he({},e,t.attrs);return i(J,he({},s,{icon:nt}),null)};re.displayName="MenuUnfoldOutlined";re.inheritAttrs=!1;const De=re;var lt={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M512 64C264.6 64 64 264.6 64 512s200.6 448 448 448 448-200.6 448-448S759.4 64 512 64zm0 820c-205.4 0-372-166.6-372-372s166.6-372 372-372 372 166.6 372 372-166.6 372-372 372zm-88-532h-48c-4.4 0-8 3.6-8 8v304c0 4.4 3.6 8 8 8h48c4.4 0 8-3.6 8-8V360c0-4.4-3.6-8-8-8zm224 0h-48c-4.4 0-8 3.6-8 8v304c0 4.4 3.6 8 8 8h48c4.4 0 8-3.6 8-8V360c0-4.4-3.6-8-8-8z"}}]},name:"pause-circle",theme:"outlined"};const it=lt;function _e(n){for(var e=1;e<arguments.length;e++){var t=arguments[e]!=null?Object(arguments[e]):{},s=Object.keys(t);typeof Object.getOwnPropertySymbols=="function"&&(s=s.concat(Object.getOwnPropertySymbols(t).filter(function(c){return Object.getOwnPropertyDescriptor(t,c).enumerable}))),s.forEach(function(c){at(n,c,t[c])})}return n}function at(n,e,t){return e in n?Object.defineProperty(n,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):n[e]=t,n}var ue=function(e,t){var s=_e({},e,t.attrs);return i(J,_e({},s,{icon:it}),null)};ue.displayName="PauseCircleOutlined";ue.inheritAttrs=!1;const je=ue;var ct={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M512 64C264.6 64 64 264.6 64 512s200.6 448 448 448 448-200.6 448-448S759.4 64 512 64zm0 820c-205.4 0-372-166.6-372-372s166.6-372 372-372 372 166.6 372 372-166.6 372-372 372z"}},{tag:"path",attrs:{d:"M719.4 499.1l-296.1-215A15.9 15.9 0 00398 297v430c0 13.1 14.8 20.5 25.3 12.9l296.1-215a15.9 15.9 0 000-25.8zm-257.6 134V390.9L628.5 512 461.8 633.1z"}}]},name:"play-circle",theme:"outlined"};const ot=ct;function ye(n){for(var e=1;e<arguments.length;e++){var t=arguments[e]!=null?Object(arguments[e]):{},s=Object.keys(t);typeof Object.getOwnPropertySymbols=="function"&&(s=s.concat(Object.getOwnPropertySymbols(t).filter(function(c){return Object.getOwnPropertyDescriptor(t,c).enumerable}))),s.forEach(function(c){rt(n,c,t[c])})}return n}function rt(n,e,t){return e in n?Object.defineProperty(n,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):n[e]=t,n}var de=function(e,t){var s=ye({},e,t.attrs);return i(J,ye({},s,{icon:ot}),null)};de.displayName="PlayCircleOutlined";de.inheritAttrs=!1;const ze=de;var ut={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M912 192H328c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8h584c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8zm0 284H328c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8h584c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8zm0 284H328c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8h584c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8zM104 228a56 56 0 10112 0 56 56 0 10-112 0zm0 284a56 56 0 10112 0 56 56 0 10-112 0zm0 284a56 56 0 10112 0 56 56 0 10-112 0z"}}]},name:"unordered-list",theme:"outlined"};const dt=ut;function be(n){for(var e=1;e<arguments.length;e++){var t=arguments[e]!=null?Object(arguments[e]):{},s=Object.keys(t);typeof Object.getOwnPropertySymbols=="function"&&(s=s.concat(Object.getOwnPropertySymbols(t).filter(function(c){return Object.getOwnPropertyDescriptor(t,c).enumerable}))),s.forEach(function(c){vt(n,c,t[c])})}return n}function vt(n,e,t){return e in n?Object.defineProperty(n,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):n[e]=t,n}var ve=function(e,t){var s=be({},e,t.attrs);return i(J,be({},s,{icon:dt}),null)};ve.displayName="UnorderedListOutlined";ve.inheritAttrs=!1;const mt=ve;var pt={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M762 164h-64c-4.4 0-8 3.6-8 8v688c0 4.4 3.6 8 8 8h64c4.4 0 8-3.6 8-8V172c0-4.4-3.6-8-8-8zm-508 0v72.4c0 9.5 4.2 18.4 11.4 24.5L564.6 512 265.4 763.1c-7.2 6.1-11.4 15-11.4 24.5V860c0 6.8 7.9 10.5 13.1 6.1L689 512 267.1 157.9A7.95 7.95 0 00254 164z"}}]},name:"vertical-left",theme:"outlined"};const ft=pt;function Ce(n){for(var e=1;e<arguments.length;e++){var t=arguments[e]!=null?Object(arguments[e]):{},s=Object.keys(t);typeof Object.getOwnPropertySymbols=="function"&&(s=s.concat(Object.getOwnPropertySymbols(t).filter(function(c){return Object.getOwnPropertyDescriptor(t,c).enumerable}))),s.forEach(function(c){gt(n,c,t[c])})}return n}function gt(n,e,t){return e in n?Object.defineProperty(n,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):n[e]=t,n}var me=function(e,t){var s=Ce({},e,t.attrs);return i(J,Ce({},s,{icon:ft}),null)};me.displayName="VerticalLeftOutlined";me.inheritAttrs=!1;const Te=me;var ht={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M326 164h-64c-4.4 0-8 3.6-8 8v688c0 4.4 3.6 8 8 8h64c4.4 0 8-3.6 8-8V172c0-4.4-3.6-8-8-8zm444 72.4V164c0-6.8-7.9-10.5-13.1-6.1L335 512l421.9 354.1c5.2 4.4 13.1.7 13.1-6.1v-72.4c0-9.4-4.2-18.4-11.4-24.5L459.4 512l299.2-251.1c7.2-6.1 11.4-15.1 11.4-24.5z"}}]},name:"vertical-right",theme:"outlined"};const _t=ht;function $e(n){for(var e=1;e<arguments.length;e++){var t=arguments[e]!=null?Object(arguments[e]):{},s=Object.keys(t);typeof Object.getOwnPropertySymbols=="function"&&(s=s.concat(Object.getOwnPropertySymbols(t).filter(function(c){return Object.getOwnPropertyDescriptor(t,c).enumerable}))),s.forEach(function(c){yt(n,c,t[c])})}return n}function yt(n,e,t){return e in n?Object.defineProperty(n,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):n[e]=t,n}var pe=function(e,t){var s=$e({},e,t.attrs);return i(J,$e({},s,{icon:_t}),null)};pe.displayName="VerticalRightOutlined";pe.inheritAttrs=!1;const He=pe;const Q=n=>(xe("data-v-d2646104"),n=n(),Le(),n),bt={class:"music-shortkey"},Ct=Q(()=>l("span",null,"Space",-1)),$t=Q(()=>l("span",{class:"key"},"←",-1)),Ot=Q(()=>l("span",{class:"key"},"→",-1)),xt=Q(()=>l("span",{class:"key"},"↑",-1)),Lt=Q(()=>l("span",{class:"key"},"↓",-1)),Pt=Q(()=>l("span",{class:"key"},"M",-1)),Mt=Q(()=>l("span",null,"Esc",-1)),kt={__name:"MusicShortkey",setup(n){const{useSystemStore:e}=ee(),t=Ve({}),s={style:{width:"100px"}};return(c,j)=>{const y=$("a-form-item"),k=$("a-form");return v(),O("div",bt,[i(k,{model:t,"label-col":s},{default:o(()=>[i(y,{label:"播放/暂停"},{default:o(()=>[Ct]),_:1}),i(y,{label:"上一首"},{default:o(()=>[l("span",null,L(a(e).ctrlOrCommand()),1),H(" + "),$t]),_:1}),i(y,{label:"下一首"},{default:o(()=>[l("span",null,L(a(e).ctrlOrCommand()),1),H(" + "),Ot]),_:1}),i(y,{label:"增加音量"},{default:o(()=>[l("span",null,L(a(e).ctrlOrCommand()),1),H(" + "),xt]),_:1}),i(y,{label:"降低音量"},{default:o(()=>[l("span",null,L(a(e).ctrlOrCommand()),1),H(" + "),Lt]),_:1}),i(y,{label:"打开搜索"},{default:o(()=>[l("span",null,L(a(e).ctrlOrCommand()),1),H(" + "),Pt]),_:1}),i(y,{label:"关闭歌词"},{default:o(()=>[Mt]),_:1})]),_:1},8,["model"])])}}},St=ne(kt,[["__scopeId","data-v-d2646104"]]);const wt={class:"music-box"},It={key:0,class:"info"},Dt={key:1,class:"info"},jt=["src"],zt={class:"center"},Tt={class:"prev-next"},Ht={class:"progress-box"},Nt={class:"ctrl"},Vt=["title"],Et={class:"mode"},Ft={__name:"MusicCtrl",props:{musicCurrentTime:{type:Number,default:0},musicDuration:{type:Number,default:0},prevMusic:{type:String,default:""},nextMusic:{type:String,default:""},musicMode:{type:String,default:""}},emits:["toggleMusicList","showSearch","handleDurationChange","handlePlay","handlePause","handlePrev","handleNext","showLyric"],setup(n,{emit:e}){const t=n,{useMusicStore:s}=ee(),c=P(0);Y(()=>t.musicCurrentTime,m=>{c.value=m},{immediate:!0,deep:!0});const j=()=>{e("toggleMusicList")},y=()=>{e("showSearch")},k=m=>{s.changeMode(m)},S=m=>{s.toggleMute(m)},g=P({});Y(()=>[s.activeIndex,s.settings.playing],()=>{g.value=s.musicList[s.activeIndex]||{}},{immediate:!0,deep:!0});const F=m=>Z(m),V=m=>{e("handleDurationChange",m)},D=()=>{e("handlePlay")},E=()=>{e("handlePause")},N=()=>{e("handlePrev")},A=()=>{e("handleNext")},I=()=>{e("showLyric")},d=P(!1),b=()=>{d.value=!0};return(m,u)=>{const x=$("a-tooltip"),M=$("a-slider"),r=$("a-divider"),_=$("IDialog");return v(),O(K,null,[l("div",wt,[a(s).musicList.length?(v(),O("div",Dt,[l("div",{class:"cover",onClick:I},[l("img",{class:q({playing:a(s).settings.playing}),src:g.value.cover,onerror:"this.src='./images/music.png'",alt:""},null,10,jt)]),H(" "+L(g.value.name)+" - "+L(g.value.singer),1)])):(v(),O("div",It,[H(" 暂无音乐，请选择"),l("span",{class:"add",onClick:y},"添加")])),l("div",zt,[l("div",Tt,[i(x,{title:"查看快捷键"},{default:o(()=>[l("i",{class:"ifishfont ifish-music-shortkey",onClick:u[0]||(u[0]=f=>b())})]),_:1}),i(x,{title:`上一首${n.prevMusic?"：":""}${n.prevMusic}`},{default:o(()=>[i(a(He),{onClick:N})]),_:1},8,["title"]),i(x,{title:a(s).settings.playing?"点击暂停":"点击播放"},{default:o(()=>[a(s).settings.playing?(v(),U(a(je),{key:1,class:"pause",onClick:E})):(v(),U(a(ze),{key:0,class:"play",onClick:D}))]),_:1},8,["title"]),i(x,{title:`下一首${n.nextMusic?"：":""}${n.nextMusic}`},{default:o(()=>[i(a(Te),{onClick:A})]),_:1},8,["title"]),i(x,{title:"展开歌词"},{default:o(()=>[l("i",{class:"ifishfont ifish-music-lyric",onClick:I})]),_:1})]),l("div",Ht,[l("p",null,L(a(Z)(c.value)),1),i(M,{class:"play-slider",min:0,max:n.musicDuration,onChange:V,value:c.value,"onUpdate:value":u[1]||(u[1]=f=>c.value=f),tipFormatter:F},null,8,["max","value"]),l("p",null,L(a(Z)(n.musicDuration)),1)])]),l("div",Nt,[l("div",{class:"volume",title:`当前音量：${a(s).settings.volume}`},[a(s).settings.mute||a(s).settings.volume===0?(v(),O("i",{key:0,class:"ifishfont ifish-volumeDisable",onClick:u[2]||(u[2]=f=>S(!0))})):a(s).settings.volume>=0&&a(s).settings.volume<30?(v(),O("i",{key:1,class:"ifishfont ifish-volumeLow",onClick:u[3]||(u[3]=f=>S(!1))})):a(s).settings.volume>=30&&a(s).settings.volume<60?(v(),O("i",{key:2,class:"ifishfont ifish-volumeMiddle",onClick:u[4]||(u[4]=f=>S(!1))})):(v(),O("i",{key:3,class:"ifishfont ifish-volumeHigh",onClick:u[5]||(u[5]=f=>S(!1))})),i(M,{class:"volume-slider",min:0,max:100,value:a(s).settings.volume,"onUpdate:value":u[6]||(u[6]=f=>a(s).settings.volume=f)},null,8,["value"])],8,Vt),l("div",Et,[i(x,{title:n.musicMode},{default:o(()=>[a(s).settings.mode==="listCycle"?(v(),O("i",{key:0,class:"ifishfont ifish-musicListLoop",title:"列表循环",onClick:u[7]||(u[7]=f=>k("singleCycle"))})):R("",!0),a(s).settings.mode==="singleCycle"?(v(),O("i",{key:1,class:"ifishfont ifish-musicSingleCycle",title:"单曲循环",onClick:u[8]||(u[8]=f=>k("randomPlay"))})):R("",!0),a(s).settings.mode==="randomPlay"?(v(),O("i",{key:2,class:"ifishfont ifish-musicRandomPlay",title:"随机播放",onClick:u[9]||(u[9]=f=>k("listCycle"))})):R("",!0)]),_:1},8,["title"])]),i(r,{type:"vertical"}),i(x,{title:"播放列表",placement:"topRight"},{default:o(()=>[i(a(De),{onClick:j})]),_:1})])]),i(_,{title:"音乐快捷键",visible:d.value,zIndex:1003,onOk:u[10]||(u[10]=f=>d.value=!1),onCancel:u[11]||(u[11]=f=>d.value=!1)},{default:o(()=>[i(St)]),_:1},8,["visible"])],64)}}},At=ne(Ft,[["__scopeId","data-v-e1504cdb"]]);const Rt={class:"music-box"},Bt={class:"title"},Ut={class:"music-list"},qt=["onClick"],Jt={class:"music-cover"},Gt=["src"],Yt={class:"music-info"},Qt=["onClick"],Wt=["onClick"],Xt=["onClick"],Zt={__name:"MusicList",props:{open:{type:Boolean,default:!1}},emits:["close","showSearch"],setup(n,{emit:e}){const{useMusicStore:t}=ee(),s=()=>{e("close")},c=()=>{e("showSearch")},j=()=>{t.musicList=[]},y=g=>{t.playMusic(g)},k=g=>{g<t.activeIndex?(t.musicList.splice(g,1),t.activeIndex--):(g===t.activeIndex&&(t.settings.currentTime=0,t.activeIndex===t.musicList.length-1&&(t.activeIndex=0),t.activeIndex++,t.activeIndex--),t.musicList.splice(g,1))},S=g=>{Ie(g.url)};return(g,F)=>{const V=$("a-input"),D=$("a-popconfirm"),E=$("a-empty"),N=$("a-menu-item"),A=$("a-menu"),I=$("a-dropdown"),d=$("perfect-scrollbar"),b=$("a-drawer");return v(),U(b,{width:"360px",title:"播放列表",placement:"right",open:n.open,onClose:s,rootClassName:"disclaimers-root"},{default:o(()=>[l("div",Rt,[i(V,{onClick:c,readonly:"",placeholder:"搜索",style:{"border-radius":"20px"}},{prefix:o(()=>[i(a(Pe))]),_:1}),l("div",null,[l("p",Bt,[l("span",null,[i(a(mt)),H("播放列表（共 "+L(a(t).musicList.length)+" 首）",1)]),i(D,{title:"确认清空列表？",onConfirm:j},{default:o(()=>[l("span",null,[i(a(Me)),H("清空列表")])]),_:1})]),a(t).musicList.length?R("",!0):(v(),U(E,{key:0,class:"list-empty"},{description:o(()=>[l("span",{class:"description"},[H(" 暂无歌曲，请"),l("a",{onClick:c},"搜索添加")])]),_:1})),i(d,{class:"scroll-bar"},{default:o(()=>[l("div",Ut,[(v(!0),O(K,null,te(a(t).musicList,(m,u)=>(v(),O("div",{class:q(["music-item",{active:a(t).activeIndex===u}]),key:u,onClick:x=>y(u)},[l("div",Jt,[l("img",{src:m.cover,onerror:"this.src='./images/music.png'",alt:""},null,8,Gt)]),l("div",Yt,[l("p",null,L(m.name),1),l("span",null,L(m.singer),1)]),l("div",{class:"music-action",onClick:F[0]||(F[0]=ke(()=>{},["stop"]))},[i(I,{placement:"bottomLeft",arrow:""},{overlay:o(()=>[i(A,null,{default:o(()=>[i(N,null,{default:o(()=>[l("a",{href:"javascript:;",onClick:x=>y(u)},"播放",8,Qt)]),_:2},1024),i(N,null,{default:o(()=>[l("a",{href:"javascript:;",onClick:x=>k(u)},"移除",8,Wt)]),_:2},1024),i(N,null,{default:o(()=>[l("a",{href:"javascript:;",onClick:x=>S(m)},"下载",8,Xt)]),_:2},1024)]),_:2},1024)]),default:o(()=>[i(a(Se))]),_:2},1024)])],10,qt))),128))])]),_:1})])])]),_:1},8,["open"])}}},Kt=ne(Zt,[["__scopeId","data-v-5a8bf248"]]);const en=n=>(xe("data-v-a53b8bd1"),n=n(),Le(),n),tn={class:"search"},nn={key:0,class:"search-history"},sn={class:"title"},ln={class:"search-history-box"},an=["onClick"],cn={class:"text",title:"点击搜索"},on={class:"search-list"},rn=en(()=>l("p",{class:"title"},"搜索结果：",-1)),un=["onClick"],dn={title:"立即播放"},vn={class:"search-action"},mn=["onClick"],pn=["onClick"],fn=["onClick"],gn=["onClick"],Oe=15,hn={__name:"MusicSearch",setup(n){const{useMusicStore:e}=ee(),t=P(""),s=P([]),c=P(!1),j=d=>{if(s.value=[],!d){Fe({type:"warning",content:"请输入歌曲、歌手后搜索"});return}e.searchHistory.indexOf(d)<0&&e.searchHistory.unshift(d),S(d)};let y=P(1),k=P(!1);const S=d=>{t.value=d,c.value=!0;const b=`https://api.lolimi.cn/API/qqdg/api.php?msg=${d}&p=${y.value}&sc=${Oe}`;X.get(b).then(m=>{m.data.code===1?(s.value=[...s.value,...m.data.data],m.data.data.length<Oe&&(k.value=!0)):k.value=!0,c.value=!1})},g=d=>{if(k.value)return;let b=d.target;b.scrollTop+b.clientHeight>=b.scrollHeight&&(y.value++,S(t.value))},F=()=>{e.searchHistory=[]},V=d=>{const b=e.searchHistory.indexOf(d);e.searchHistory.splice(b,1)},D=async(d,b)=>{const{cover:m,name:u,singer:x,url:M,content:r}=await I(d);e.musicList.push({id:ie(21),cover:m,name:u,singer:x,url:M,content:r}),e.playMusic(e.musicList.length-1)},E=async(d,b)=>{const{cover:m,name:u,singer:x,url:M,content:r}=await I(d);e.musicList.push({id:ie(21),cover:m,name:u,singer:x,url:M,content:r})},N=async(d,b)=>{const{cover:m,name:u,singer:x,url:M,content:r}=await I(d);e.musicList.splice(e.activeIndex+1,0,{id:ie(21),cover:m,name:u,singer:x,url:M,content:r})},A=async(d,b)=>{const{url:m}=await I(d);m&&Ie(m)},I=async(d,b)=>{const m=new Promise((r,_)=>{X.get(`https://xiaoapi.cn/API/yy_sq.php?msg=${d.song}-${d.singer}&n=1`).then(f=>{f.data.code===200?r(f.data):r({})})}),u=new Promise((r,_)=>{X.get(`https://xiaoapi.cn/API/yy_sq.php?msg=${d.song} ${d.singer}&n=1`).then(f=>{f.data.code===200?r(f.data):r({})})}),x=new Promise((r,_)=>{X.get(`https://api.lolimi.cn/API/kggc/api.php?msg=${d.song} ${d.singer}&n=1`).then(f=>{f.data.code===1?r(f.data.data):r({})})}),M=await Promise.all([m,u,x]);return{...M[0],...M[1]}};return(d,b)=>{const m=$("a-input"),u=$("a-col"),x=$("a-button"),M=$("a-row"),r=$("a-empty"),_=$("a-menu-item"),f=$("a-menu"),p=$("a-dropdown"),h=$("perfect-scrollbar"),B=$("a-spin");return v(),O("div",tn,[i(M,{gutter:12},{default:o(()=>[i(u,{span:20},{default:o(()=>[i(m,{value:t.value,"onUpdate:value":b[0]||(b[0]=C=>t.value=C),onPressEnter:b[1]||(b[1]=C=>j(C.target.value)),placeholder:"输入歌曲、歌手",allowClear:"",style:{"border-radius":"16px"}},{prefix:o(()=>[i(a(Pe))]),_:1},8,["value"])]),_:1}),i(u,{span:3},{default:o(()=>[i(x,{type:"primary",shape:"round",onClick:b[2]||(b[2]=C=>j(t.value))},{default:o(()=>[H("搜索")]),_:1})]),_:1})]),_:1}),a(e).searchHistory.length?(v(),O("div",nn,[l("p",sn,[H(" 搜索历史： "),l("span",{class:"clear",onClick:F},[i(a(Me)),H("清空历史搜索")])]),l("div",ln,[(v(!0),O(K,null,te(a(e).searchHistory,(C,w)=>(v(),O("p",{key:w,onClick:z=>S(C)},[l("span",cn,L(C),1),i(a(Ee),{title:"点击移除",onClick:ke(z=>V(C),["stop"])},null,8,["onClick"])],8,an))),128))])])):R("",!0),l("div",on,[rn,i(B,{spinning:c.value,tip:"加载中..."},{default:o(()=>[i(h,{class:"scroll-bar",onPsScrollY:g},{default:o(()=>[s.value.length?R("",!0):(v(),U(r,{key:0})),l("ul",null,[(v(!0),O(K,null,te(s.value,(C,w)=>(v(),O("li",{key:w,onClick:z=>D(C,w)},[l("p",dn,L(C.song)+" - "+L(C.singers),1),l("div",vn,[i(p,{placement:"bottomLeft",arrow:""},{overlay:o(()=>[i(f,null,{default:o(()=>[i(_,null,{default:o(()=>[l("a",{href:"javascript:;",onClick:z=>E(C,w)},"添加到播放列表",8,mn)]),_:2},1024),i(_,null,{default:o(()=>[l("a",{href:"javascript:;",onClick:z=>D(C,w)},"立即播放",8,pn)]),_:2},1024),i(_,null,{default:o(()=>[l("a",{href:"javascript:;",onClick:z=>N(C,w)},"下一首播放",8,fn)]),_:2},1024),i(_,null,{default:o(()=>[l("a",{href:"javascript:;",onClick:z=>A(C,w)},"下载",8,gn)]),_:2},1024)]),_:2},1024)]),default:o(()=>[i(a(Se))]),_:2},1024)])],8,un))),128))])]),_:1})]),_:1},8,["spinning"])])])}}},_n=ne(hn,[["__scopeId","data-v-a53b8bd1"]]);const yn={class:"bg"},bn=["src"],Cn=l("div",{class:"mask"},null,-1),$n={class:"music-info"},On=["src"],xn={class:"progress-box"},Ln={class:"prev-next"},Pn={class:"mode"},Mn={class:"music-list"},kn=["onClick"],Sn={class:"music-cover"},wn=["src"],In={class:"music-info"},Dn={class:"music-lyric"},jn={key:0,class:"no-lyric"},zn=["onClick"],Tn={class:"action"},Hn={__name:"MusicFullScreen",props:{open:{type:Boolean,default:!1},musicCurrentTime:{type:Number,default:0},musicDuration:{type:Number,default:0},prevMusic:{type:String,default:""},nextMusic:{type:String,default:""},musicMode:{type:String,default:""}},emits:["close","handleDurationChange","handlePlay","handlePause","handlePrev","handleNext"],setup(n,{emit:e}){const t=n,{useMusicStore:s}=ee();we(()=>{W.on("lyricClose",()=>{I()})});const c=P(!1),j=P(null),{isFullscreen:y,toggle:k,exit:S}=Ae(j),g=P({});Y(()=>[s.activeIndex,s.settings.playing],()=>{g.value=s.musicList[s.activeIndex]||{}},{immediate:!0,deep:!0});const F=p=>{const h=[];return p.split(`
`).map(C=>{let w=C.match(/\[(.*?)\]/);if(w){let z=w[1];/^(0\d|1\d|2[0-3]):([0-5]\d)\.(?:\d{2})$/.test(z)&&h.push({time:z,lyric:C.replace(/\[.*?\]/g,"")})}}),h},V=se(()=>{var h,B,C;let p=[];return s.activeIndex<0?[]:((B=(h=g.value)==null?void 0:h.content)!=null&&B.length?p=F((C=g.value)==null?void 0:C.content):A(),p)}),D=P(0);Y(()=>t.musicCurrentTime,p=>{D.value=p},{immediate:!0,deep:!0});const E=P(0),N=p=>{var z;const B=ae(V.value[p].time),C=ae((z=V.value[p+1])==null?void 0:z.time),w=D.value+1>=B&&(D.value+1<C||!C);return w&&(E.value=p),w};Y(()=>E.value,()=>{let p=document.getElementById("lyric-list");if(p){let h=p.querySelector(".active");h&&p.scrollTo({top:h.offsetTop-p.clientHeight/2+h.clientHeight/2,behavior:"smooth"})}},{immediate:!0,deep:!0});const A=()=>{g.value.name&&X.get(`https://api.lolimi.cn/API/kggc/api.php?msg=${g.value.name}-${g.value.singer}&n=1`).then(p=>{const{content:h}=p.data.data||{};p.data.code===1&&(s.musicList[s.activeIndex].content=h)})},I=()=>{S(),e("close")},d=p=>{s.playMusic(p)},b=p=>{s.changeMode(p)},m=p=>Z(p),u=p=>{e("handleDurationChange",p)},x=()=>{e("handlePlay")},M=()=>{e("handlePause")},r=()=>{e("handlePrev")},_=()=>{e("handleNext")},f=(p,h)=>{e("handleDurationChange",ae(p.time)),e("handlePlay")};return(p,h)=>{const B=$("a-slider"),C=$("a-tooltip"),w=$("perfect-scrollbar"),z=$("a-popover");return v(),O("div",{ref_key:"fullscreenRef",ref:j,class:q(["music-fullscreen",{open:n.open}])},[l("div",yn,[l("img",{src:g.value.cover,alt:""},null,8,bn),Cn]),l("div",$n,[l("img",{class:q(["cover",{playing:c.value||a(s).settings.playing}]),onClick:h[0]||(h[0]=T=>c.value=!c.value),src:g.value.cover,alt:""},null,10,On),l("p",null,L(g.value.name),1),l("span",null,L(g.value.singer),1),l("div",xn,[l("p",null,L(a(Z)(D.value)),1),i(B,{class:"play-slider",min:0,max:n.musicDuration,onChange:u,value:D.value,"onUpdate:value":h[1]||(h[1]=T=>D.value=T),tipFormatter:m},null,8,["max","value"]),l("p",null,L(a(Z)(n.musicDuration)),1)]),l("div",Ln,[l("div",Pn,[i(C,{title:n.musicMode},{default:o(()=>[a(s).settings.mode==="listCycle"?(v(),O("i",{key:0,class:"ifishfont ifish-musicListLoop",title:"列表循环",onClick:h[2]||(h[2]=T=>b("singleCycle"))})):R("",!0),a(s).settings.mode==="singleCycle"?(v(),O("i",{key:1,class:"ifishfont ifish-musicSingleCycle",title:"单曲循环",onClick:h[3]||(h[3]=T=>b("randomPlay"))})):R("",!0),a(s).settings.mode==="randomPlay"?(v(),O("i",{key:2,class:"ifishfont ifish-musicRandomPlay",title:"随机播放",onClick:h[4]||(h[4]=T=>b("listCycle"))})):R("",!0)]),_:1},8,["title"])]),i(C,{title:`上一首${n.prevMusic?"：":""}${n.prevMusic}`},{default:o(()=>[i(a(He),{onClick:r})]),_:1},8,["title"]),i(C,{title:a(s).settings.playing?"点击暂停":"点击播放"},{default:o(()=>[a(s).settings.playing?(v(),U(a(je),{key:1,class:"pause",onClick:M})):(v(),U(a(ze),{key:0,class:"play",onClick:x}))]),_:1},8,["title"]),i(C,{title:`下一首${n.nextMusic?"：":""}${n.nextMusic}`},{default:o(()=>[i(a(Te),{onClick:_})]),_:1},8,["title"]),i(z,{title:"播放列表",placement:"rightBottom"},{content:o(()=>[i(w,{class:"scroll-music"},{default:o(()=>[l("div",Mn,[(v(!0),O(K,null,te(a(s).musicList,(T,G)=>(v(),O("div",{class:q(["music-item",{active:a(s).activeIndex===G}]),key:G,onClick:Ne=>d(G)},[l("div",Sn,[l("img",{src:T.cover,onerror:"this.src='./images/music.png'",alt:""},null,8,wn)]),l("div",In,[l("p",null,L(T.name),1),l("span",null,L(T.singer),1)])],10,kn))),128))])]),_:1})]),default:o(()=>[i(a(De))]),_:1})])]),l("div",Dn,[V.value.length?R("",!0):(v(),O("p",jn,"暂无歌词")),i(w,{class:"scroll-bar",id:"lyric-list"},{default:o(()=>[(v(!0),O(K,null,te(V.value,(T,G)=>(v(),O("p",{class:q({active:N(G)}),key:G,onClick:Ne=>f(T,G)},[l("span",null,L(T.time),1),H(" "+L(T.lyric),1)],10,zn))),128))]),_:1})]),l("div",Tn,[i(a(Re),{class:"close",title:"关闭歌词",onClick:I}),a(y)?(v(),U(a(We),{key:0,title:"关闭全屏",onClick:a(k)},null,8,["onClick"])):(v(),U(a(et),{key:1,title:"开启全屏",onClick:a(k)},null,8,["onClick"]))])],2)}}};const Nn={class:"music"},Vn=["src","loop"],En=["title"],Fn={__name:"Index",setup(n){const{useMusicStore:e}=ee();we(()=>{e.settings.playing=!1,e.musicList&&e.musicList.map((r,_)=>{let f=new Audio(r.url);f.onerror=function(){t(r)},f.load()}),W.on("playOrPause",()=>{e.visible=!0,e.settings.playing?N():E()}),W.on("searchMusic",()=>{c.value=!0}),W.on("prevMusic",()=>{I()}),W.on("nextMusic",()=>{b()}),W.on("volChange",r=>{e.settings.volume+=r,e.settings.volume<0?e.settings.volume=0:e.settings.volume>100&&(e.settings.volume=100)})});const t=r=>{X.get(`https://xiaoapi.cn/API/yy_sq.php?msg=${r.name} ${r.singer}&n=1`).then(_=>{const{code:f,url:p}=_.data;f===200&&(r.url=p)})},s=P(!1),c=P(!1),j=P(!1),y=P(null),k=P({});Y(()=>[e.activeIndex,e.settings.playing],()=>{k.value=e.musicList[e.activeIndex]||{},le(()=>{y.value&&(g.value=parseInt(y.value.duration),y.value.volume=e.settings.volume/100,e.settings.playing&&y.value.play())})},{immediate:!0,deep:!0}),Y(()=>[e.settings.volume,e.settings.mute],()=>{y.value&&le(()=>{y.value.volume=e.settings.volume/100,y.value.muted=e.settings.mute})},{immediate:!0,deep:!0});const S=P(0),g=P(1e3),F=()=>{g.value=parseInt(y.value.duration),S.value=y.value.currentTime=e.settings.currentTime},V=r=>{const{currentTime:_,duration:f}=r.target;S.value=e.settings.currentTime=parseInt(_),g.value=parseInt(f)},D=()=>{e.toggleVisible()},E=()=>{!e.musicList.length||e.activeIndex<0||(e.settings.playing=!0,y.value.play())},N=()=>{!e.musicList.length||e.activeIndex<0||(e.settings.playing=!1,y.value.pause())},A=se(()=>{if(!e.musicList.length||e.activeIndex<0)return"";let r=e.activeIndex===0?e.musicList.length-1:e.activeIndex-1;return e.musicList[r]?e.musicList[r].name:""}),I=()=>{if(!e.musicList.length||e.activeIndex<0)return;let r=e.activeIndex===0?e.musicList.length-1:e.activeIndex-1;e.playMusic(r)},d=se(()=>{if(!e.musicList.length||e.activeIndex<0)return"";let r=e.activeIndex===e.musicList.length-1?0:e.activeIndex+1;return e.musicList[r]?e.musicList[r].name:""}),b=()=>{if(!e.musicList.length||e.activeIndex<0)return;let r=e.activeIndex===e.musicList.length-1?0:e.activeIndex+1;e.playMusic(r)},m=()=>{e.settings.mode==="listCycle"?(e.musicList.length===1&&(e.activeIndex--,e.activeIndex++),b()):e.settings.mode==="singleCycle"?e.playMusic(e.activeIndex):e.settings.mode==="randomPlay"&&e.playMusic(Je(0,e.musicList.length-1,e.activeIndex))},u=()=>{console.log("播放出错")},x=r=>{e.settings.currentTime=r,y.value&&le(()=>{y.value.currentTime=r})},M=se(()=>({listCycle:"列表循环",singleCycle:"单曲循环",randomPlay:"随机播放"})[e.settings.mode]);return(r,_)=>{var p;const f=$("IDialog");return v(),O("div",Nn,[Be(l("audio",{ref_key:"audioRef",ref:y,controls:"",src:(p=k.value)==null?void 0:p.url,loop:a(e).settings.mode==="singleCycle",onTimeupdate:V,onLoadeddata:F,onEnded:m,onError:u},null,40,Vn),[[Ue,!1]]),l("div",{class:q(["toggle-icon bf",[a(e).visible?"down":"up"]]),title:a(e).visible?"隐藏播放器":"显示播放器",onClick:D},[i(a(qe))],10,En),l("div",{class:q(["music-ctrl bf",[a(e).visible?"show":""]])},[i(At,{musicCurrentTime:S.value,musicDuration:g.value,prevMusic:A.value,nextMusic:d.value,musicMode:M.value,onShowSearch:_[0]||(_[0]=h=>c.value=!0),onToggleMusicList:_[1]||(_[1]=h=>s.value=!s.value),onShowLyric:_[2]||(_[2]=h=>j.value=!0),onHandlePlay:E,onHandlePause:N,onHandlePrev:I,onHandleNext:b,onHandleDurationChange:x},null,8,["musicCurrentTime","musicDuration","prevMusic","nextMusic","musicMode"])],2),i(Kt,{open:s.value,onShowSearch:_[3]||(_[3]=h=>c.value=!0),onClose:_[4]||(_[4]=h=>s.value=!1)},null,8,["open"]),i(f,{title:"搜索音乐",visible:c.value,zIndex:1002,onOk:_[5]||(_[5]=h=>c.value=!1),onCancel:_[6]||(_[6]=h=>c.value=!1)},{default:o(()=>[i(_n)]),_:1},8,["visible"]),i(Hn,{open:j.value,musicCurrentTime:S.value,musicDuration:g.value,prevMusic:A.value,nextMusic:d.value,musicMode:M.value,onClose:_[7]||(_[7]=h=>j.value=!1),onHandlePlay:E,onHandlePause:N,onHandlePrev:I,onHandleNext:b,onHandleDurationChange:x},null,8,["open","musicCurrentTime","musicDuration","prevMusic","nextMusic","musicMode"])])}}},Bn=ne(Fn,[["__scopeId","data-v-58132bab"]]);export{Bn as default};
