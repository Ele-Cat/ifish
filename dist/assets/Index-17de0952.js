import{c as i,A as H,_ as U,u as q,r as $,w as B,a as h,o as m,b as _,d as c,e as F,f as a,n as T,t as I,g as v,h as R,i as E,S as ge,D as he,F as J,j as Q,k as _e,E as ye,C as Pe,l as G,p as be,m as Oe,q as Se,s as Y,v as Me,x as we,y as W,z as ke,B as Ie,G as je}from"./index-2f9299e0.js";import{s as X,d as Le,u as Z}from"./utils-44204456.js";var ze={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M391 240.9c-.8-6.6-8.9-9.4-13.6-4.7l-43.7 43.7L200 146.3a8.03 8.03 0 00-11.3 0l-42.4 42.3a8.03 8.03 0 000 11.3L280 333.6l-43.9 43.9a8.01 8.01 0 004.7 13.6L401 410c5.1.6 9.5-3.7 8.9-8.9L391 240.9zm10.1 373.2L240.8 633c-6.6.8-9.4 8.9-4.7 13.6l43.9 43.9L146.3 824a8.03 8.03 0 000 11.3l42.4 42.3c3.1 3.1 8.2 3.1 11.3 0L333.7 744l43.7 43.7A8.01 8.01 0 00391 783l18.9-160.1c.6-5.1-3.7-9.4-8.8-8.8zm221.8-204.2L783.2 391c6.6-.8 9.4-8.9 4.7-13.6L744 333.6 877.7 200c3.1-3.1 3.1-8.2 0-11.3l-42.4-42.3a8.03 8.03 0 00-11.3 0L690.3 279.9l-43.7-43.7a8.01 8.01 0 00-13.6 4.7L614.1 401c-.6 5.2 3.7 9.5 8.8 8.9zM744 690.4l43.9-43.9a8.01 8.01 0 00-4.7-13.6L623 614c-5.1-.6-9.5 3.7-8.9 8.9L633 783.1c.8 6.6 8.9 9.4 13.6 4.7l43.7-43.7L824 877.7c3.1 3.1 8.2 3.1 11.3 0l42.4-42.3c3.1-3.1 3.1-8.2 0-11.3L744 690.4z"}}]},name:"fullscreen-exit",theme:"outlined"};const De=ze;function ce(n){for(var e=1;e<arguments.length;e++){var t=arguments[e]!=null?Object(arguments[e]):{},s=Object.keys(t);typeof Object.getOwnPropertySymbols=="function"&&(s=s.concat(Object.getOwnPropertySymbols(t).filter(function(l){return Object.getOwnPropertyDescriptor(t,l).enumerable}))),s.forEach(function(l){Ve(n,l,t[l])})}return n}function Ve(n,e,t){return e in n?Object.defineProperty(n,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):n[e]=t,n}var K=function(e,t){var s=ce({},e,t.attrs);return i(H,ce({},s,{icon:De}),null)};K.displayName="FullscreenExitOutlined";K.inheritAttrs=!1;const Ne=K;var Fe={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M290 236.4l43.9-43.9a8.01 8.01 0 00-4.7-13.6L169 160c-5.1-.6-9.5 3.7-8.9 8.9L179 329.1c.8 6.6 8.9 9.4 13.6 4.7l43.7-43.7L370 423.7c3.1 3.1 8.2 3.1 11.3 0l42.4-42.3c3.1-3.1 3.1-8.2 0-11.3L290 236.4zm352.7 187.3c3.1 3.1 8.2 3.1 11.3 0l133.7-133.6 43.7 43.7a8.01 8.01 0 0013.6-4.7L863.9 169c.6-5.1-3.7-9.5-8.9-8.9L694.8 179c-6.6.8-9.4 8.9-4.7 13.6l43.9 43.9L600.3 370a8.03 8.03 0 000 11.3l42.4 42.4zM845 694.9c-.8-6.6-8.9-9.4-13.6-4.7l-43.7 43.7L654 600.3a8.03 8.03 0 00-11.3 0l-42.4 42.3a8.03 8.03 0 000 11.3L734 787.6l-43.9 43.9a8.01 8.01 0 004.7 13.6L855 864c5.1.6 9.5-3.7 8.9-8.9L845 694.9zm-463.7-94.6a8.03 8.03 0 00-11.3 0L236.3 733.9l-43.7-43.7a8.01 8.01 0 00-13.6 4.7L160.1 855c-.6 5.1 3.7 9.5 8.9 8.9L329.2 845c6.6-.8 9.4-8.9 4.7-13.6L290 787.6 423.7 654c3.1-3.1 3.1-8.2 0-11.3l-42.4-42.4z"}}]},name:"fullscreen",theme:"outlined"};const He=Fe;function oe(n){for(var e=1;e<arguments.length;e++){var t=arguments[e]!=null?Object(arguments[e]):{},s=Object.keys(t);typeof Object.getOwnPropertySymbols=="function"&&(s=s.concat(Object.getOwnPropertySymbols(t).filter(function(l){return Object.getOwnPropertyDescriptor(t,l).enumerable}))),s.forEach(function(l){Te(n,l,t[l])})}return n}function Te(n,e,t){return e in n?Object.defineProperty(n,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):n[e]=t,n}var ee=function(e,t){var s=oe({},e,t.attrs);return i(H,oe({},s,{icon:He}),null)};ee.displayName="FullscreenOutlined";ee.inheritAttrs=!1;const Ee=ee;var Re={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M408 442h480c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8H408c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8zm-8 204c0 4.4 3.6 8 8 8h480c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8H408c-4.4 0-8 3.6-8 8v56zm504-486H120c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8h784c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8zm0 632H120c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8h784c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8zM142.4 642.1L298.7 519a8.84 8.84 0 000-13.9L142.4 381.9c-5.8-4.6-14.4-.5-14.4 6.9v246.3a8.9 8.9 0 0014.4 7z"}}]},name:"menu-unfold",theme:"outlined"};const Ae=Re;function re(n){for(var e=1;e<arguments.length;e++){var t=arguments[e]!=null?Object(arguments[e]):{},s=Object.keys(t);typeof Object.getOwnPropertySymbols=="function"&&(s=s.concat(Object.getOwnPropertySymbols(t).filter(function(l){return Object.getOwnPropertyDescriptor(t,l).enumerable}))),s.forEach(function(l){Be(n,l,t[l])})}return n}function Be(n,e,t){return e in n?Object.defineProperty(n,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):n[e]=t,n}var te=function(e,t){var s=re({},e,t.attrs);return i(H,re({},s,{icon:Ae}),null)};te.displayName="MenuUnfoldOutlined";te.inheritAttrs=!1;const Ue=te;var qe={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M512 64C264.6 64 64 264.6 64 512s200.6 448 448 448 448-200.6 448-448S759.4 64 512 64zm0 820c-205.4 0-372-166.6-372-372s166.6-372 372-372 372 166.6 372 372-166.6 372-372 372zm-88-532h-48c-4.4 0-8 3.6-8 8v304c0 4.4 3.6 8 8 8h48c4.4 0 8-3.6 8-8V360c0-4.4-3.6-8-8-8zm224 0h-48c-4.4 0-8 3.6-8 8v304c0 4.4 3.6 8 8 8h48c4.4 0 8-3.6 8-8V360c0-4.4-3.6-8-8-8z"}}]},name:"pause-circle",theme:"outlined"};const Ge=qe;function ue(n){for(var e=1;e<arguments.length;e++){var t=arguments[e]!=null?Object(arguments[e]):{},s=Object.keys(t);typeof Object.getOwnPropertySymbols=="function"&&(s=s.concat(Object.getOwnPropertySymbols(t).filter(function(l){return Object.getOwnPropertyDescriptor(t,l).enumerable}))),s.forEach(function(l){Ye(n,l,t[l])})}return n}function Ye(n,e,t){return e in n?Object.defineProperty(n,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):n[e]=t,n}var ne=function(e,t){var s=ue({},e,t.attrs);return i(H,ue({},s,{icon:Ge}),null)};ne.displayName="PauseCircleOutlined";ne.inheritAttrs=!1;const Je=ne;var Qe={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M512 64C264.6 64 64 264.6 64 512s200.6 448 448 448 448-200.6 448-448S759.4 64 512 64zm0 820c-205.4 0-372-166.6-372-372s166.6-372 372-372 372 166.6 372 372-166.6 372-372 372z"}},{tag:"path",attrs:{d:"M719.4 499.1l-296.1-215A15.9 15.9 0 00398 297v430c0 13.1 14.8 20.5 25.3 12.9l296.1-215a15.9 15.9 0 000-25.8zm-257.6 134V390.9L628.5 512 461.8 633.1z"}}]},name:"play-circle",theme:"outlined"};const We=Qe;function de(n){for(var e=1;e<arguments.length;e++){var t=arguments[e]!=null?Object(arguments[e]):{},s=Object.keys(t);typeof Object.getOwnPropertySymbols=="function"&&(s=s.concat(Object.getOwnPropertySymbols(t).filter(function(l){return Object.getOwnPropertyDescriptor(t,l).enumerable}))),s.forEach(function(l){Xe(n,l,t[l])})}return n}function Xe(n,e,t){return e in n?Object.defineProperty(n,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):n[e]=t,n}var se=function(e,t){var s=de({},e,t.attrs);return i(H,de({},s,{icon:We}),null)};se.displayName="PlayCircleOutlined";se.inheritAttrs=!1;const Ze=se;var Ke={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M912 192H328c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8h584c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8zm0 284H328c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8h584c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8zm0 284H328c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8h584c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8zM104 228a56 56 0 10112 0 56 56 0 10-112 0zm0 284a56 56 0 10112 0 56 56 0 10-112 0zm0 284a56 56 0 10112 0 56 56 0 10-112 0z"}}]},name:"unordered-list",theme:"outlined"};const et=Ke;function ve(n){for(var e=1;e<arguments.length;e++){var t=arguments[e]!=null?Object(arguments[e]):{},s=Object.keys(t);typeof Object.getOwnPropertySymbols=="function"&&(s=s.concat(Object.getOwnPropertySymbols(t).filter(function(l){return Object.getOwnPropertyDescriptor(t,l).enumerable}))),s.forEach(function(l){tt(n,l,t[l])})}return n}function tt(n,e,t){return e in n?Object.defineProperty(n,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):n[e]=t,n}var le=function(e,t){var s=ve({},e,t.attrs);return i(H,ve({},s,{icon:et}),null)};le.displayName="UnorderedListOutlined";le.inheritAttrs=!1;const nt=le;var st={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M762 164h-64c-4.4 0-8 3.6-8 8v688c0 4.4 3.6 8 8 8h64c4.4 0 8-3.6 8-8V172c0-4.4-3.6-8-8-8zm-508 0v72.4c0 9.5 4.2 18.4 11.4 24.5L564.6 512 265.4 763.1c-7.2 6.1-11.4 15-11.4 24.5V860c0 6.8 7.9 10.5 13.1 6.1L689 512 267.1 157.9A7.95 7.95 0 00254 164z"}}]},name:"vertical-left",theme:"outlined"};const lt=st;function pe(n){for(var e=1;e<arguments.length;e++){var t=arguments[e]!=null?Object(arguments[e]):{},s=Object.keys(t);typeof Object.getOwnPropertySymbols=="function"&&(s=s.concat(Object.getOwnPropertySymbols(t).filter(function(l){return Object.getOwnPropertyDescriptor(t,l).enumerable}))),s.forEach(function(l){it(n,l,t[l])})}return n}function it(n,e,t){return e in n?Object.defineProperty(n,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):n[e]=t,n}var ie=function(e,t){var s=pe({},e,t.attrs);return i(H,pe({},s,{icon:lt}),null)};ie.displayName="VerticalLeftOutlined";ie.inheritAttrs=!1;const at=ie;var ct={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M326 164h-64c-4.4 0-8 3.6-8 8v688c0 4.4 3.6 8 8 8h64c4.4 0 8-3.6 8-8V172c0-4.4-3.6-8-8-8zm444 72.4V164c0-6.8-7.9-10.5-13.1-6.1L335 512l421.9 354.1c5.2 4.4 13.1.7 13.1-6.1v-72.4c0-9.4-4.2-18.4-11.4-24.5L459.4 512l299.2-251.1c7.2-6.1 11.4-15.1 11.4-24.5z"}}]},name:"vertical-right",theme:"outlined"};const ot=ct;function me(n){for(var e=1;e<arguments.length;e++){var t=arguments[e]!=null?Object(arguments[e]):{},s=Object.keys(t);typeof Object.getOwnPropertySymbols=="function"&&(s=s.concat(Object.getOwnPropertySymbols(t).filter(function(l){return Object.getOwnPropertyDescriptor(t,l).enumerable}))),s.forEach(function(l){rt(n,l,t[l])})}return n}function rt(n,e,t){return e in n?Object.defineProperty(n,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):n[e]=t,n}var ae=function(e,t){var s=me({},e,t.attrs);return i(H,me({},s,{icon:ot}),null)};ae.displayName="VerticalRightOutlined";ae.inheritAttrs=!1;const ut=ae;const dt={class:"music-box"},vt={key:0,class:"info"},pt={key:1,class:"info"},mt=["src"],ft={class:"center"},gt={class:"prev-next"},ht={class:"progress-box"},_t={class:"ctrl"},yt=["title"],bt={class:"mode"},Ot={__name:"MusicCtrl",props:{musicCurrentTime:{type:Number,default:0},musicDuration:{type:Number,default:0},prevMusic:{type:String,default:""},nextMusic:{type:String,default:""},musicMode:{type:String,default:""}},emits:["toggleMusicList","showSearch","showLyric","handlePlay"],setup(n,{emit:e}){const t=n,{useMusicStore:s}=q(),l=$(0);B(()=>t.musicCurrentTime,o=>{l.value=o},{immediate:!0,deep:!0});const g=()=>{e("toggleMusicList")},M=()=>{e("showSearch")},P=o=>{s.changeMode(o)},f=o=>{s.toggleMute(o)},y=$({});B(()=>[s.activeIndex,s.settings.playing],()=>{y.value=s.musicList[s.activeIndex]||{}},{immediate:!0,deep:!0});const j=o=>X(o),D=o=>{e("handleDurationChange",o)},z=()=>{e("handlePlay")},C=()=>{e("handlePause")},O=()=>{e("handlePrev")},w=()=>{e("handleNext")},L=()=>{e("showLyric")};return(o,r)=>{const p=h("a-tooltip"),b=h("a-slider"),d=h("a-divider");return m(),_("div",dt,[c(s).musicList.length?(m(),_("div",pt,[a("div",{class:"cover",onClick:L},[a("img",{class:T({playing:c(s).settings.playing}),src:y.value.cover,onerror:"this.src='./images/music.png'",alt:""},null,10,mt)]),F(" "+I(y.value.name)+" - "+I(y.value.singer),1)])):(m(),_("div",vt,[F(" 暂无音乐，请选择"),a("span",{class:"add",onClick:M},"添加")])),a("div",ft,[a("div",gt,[i(p,{title:`上一首${n.prevMusic?"：":""}${n.prevMusic}`},{default:v(()=>[i(c(ut),{onClick:O})]),_:1},8,["title"]),i(p,{title:c(s).settings.playing?"点击暂停":"点击播放"},{default:v(()=>[c(s).settings.playing?(m(),R(c(Je),{key:1,class:"pause",onClick:C})):(m(),R(c(Ze),{key:0,class:"play",onClick:z}))]),_:1},8,["title"]),i(p,{title:`下一首${n.nextMusic?"：":""}${n.nextMusic}`},{default:v(()=>[i(c(at),{onClick:w})]),_:1},8,["title"])]),a("div",ht,[a("p",null,I(c(X)(l.value)),1),i(b,{class:"play-slider",min:0,max:n.musicDuration,onChange:D,value:l.value,"onUpdate:value":r[0]||(r[0]=u=>l.value=u),tipFormatter:j},null,8,["max","value"]),a("p",null,I(c(X)(n.musicDuration)),1)])]),a("div",_t,[a("div",{class:"volume",title:`当前音量：${c(s).settings.volume}`},[c(s).settings.mute||c(s).settings.volume===0?(m(),_("i",{key:0,class:"ifishfont ifish-volumeDisable",onClick:r[1]||(r[1]=u=>f(!0))})):c(s).settings.volume>=0&&c(s).settings.volume<30?(m(),_("i",{key:1,class:"ifishfont ifish-volumeLow",onClick:r[2]||(r[2]=u=>f(!1))})):c(s).settings.volume>=30&&c(s).settings.volume<60?(m(),_("i",{key:2,class:"ifishfont ifish-volumeMiddle",onClick:r[3]||(r[3]=u=>f(!1))})):(m(),_("i",{key:3,class:"ifishfont ifish-volumeHigh",onClick:r[4]||(r[4]=u=>f(!1))})),i(b,{class:"volume-slider",min:0,max:100,value:c(s).settings.volume,"onUpdate:value":r[5]||(r[5]=u=>c(s).settings.volume=u)},null,8,["value"])],8,yt),a("div",bt,[i(p,{title:n.musicMode},{default:v(()=>[c(s).settings.mode==="listCycle"?(m(),_("i",{key:0,class:"ifishfont ifish-musicListLoop",title:"列表循环",onClick:r[6]||(r[6]=u=>P("singleCycle"))})):E("",!0),c(s).settings.mode==="singleCycle"?(m(),_("i",{key:1,class:"ifishfont ifish-musicSingleCycle",title:"单曲循环",onClick:r[7]||(r[7]=u=>P("randomPlay"))})):E("",!0),c(s).settings.mode==="randomPlay"?(m(),_("i",{key:2,class:"ifishfont ifish-musicRandomPlay",title:"随机播放",onClick:r[8]||(r[8]=u=>P("listCycle"))})):E("",!0)]),_:1},8,["title"])]),i(d,{type:"vertical"}),i(p,{title:"播放列表",placement:"topRight"},{default:v(()=>[i(c(Ue),{onClick:g})]),_:1})])])}}},Lt=U(Ot,[["__scopeId","data-v-3baf4e76"]]);const $t={class:"music-box"},Ct={class:"title"},xt={class:"music-list"},Pt=["onClick"],St={class:"music-cover"},Mt=["src"],wt={class:"music-info"},kt=["onClick"],It=["onClick"],jt=["onClick"],zt={__name:"MusicList",props:{open:{type:Boolean,default:!1}},emits:["close","showSearch"],setup(n,{emit:e}){const{useMusicStore:t}=q(),s=()=>{e("close")},l=()=>{e("showSearch")},g=()=>{t.musicList=[]},M=y=>{t.playMusic(y)},P=y=>{y<t.activeIndex?(t.musicList.splice(y,1),t.activeIndex--):(y===t.activeIndex&&(t.settings.currentTime=0,t.activeIndex===t.musicList.length-1&&(t.activeIndex=0),t.activeIndex++,t.activeIndex--),t.musicList.splice(y,1))},f=y=>{Le(y.url)};return(y,j)=>{const D=h("a-input"),z=h("a-popconfirm"),C=h("a-empty"),O=h("a-menu-item"),w=h("a-menu"),L=h("a-dropdown"),o=h("perfect-scrollbar"),r=h("a-drawer");return m(),R(r,{width:"360px",title:"播放列表",placement:"right",open:n.open,onClose:s,rootClassName:"disclaimers-root"},{default:v(()=>[a("div",$t,[i(D,{onClick:l,readonly:"",placeholder:"搜索",style:{"border-radius":"20px"}},{prefix:v(()=>[i(c(ge))]),_:1}),a("div",null,[a("p",Ct,[a("span",null,[i(c(nt)),F("播放列表（共 "+I(c(t).musicList.length)+" 首）",1)]),i(z,{title:"确认清空列表？",onConfirm:g},{default:v(()=>[a("span",null,[i(c(he)),F("清空列表")])]),_:1})]),c(t).musicList.length?E("",!0):(m(),R(C,{key:0,class:"list-empty"},{description:v(()=>[a("span",{class:"description"},[F(" 暂无歌曲，请"),a("a",{onClick:l},"搜索添加")])]),_:1})),i(o,{class:"scroll-bar"},{default:v(()=>[a("div",xt,[(m(!0),_(J,null,Q(c(t).musicList,(p,b)=>(m(),_("div",{class:T(["music-item",{active:c(t).activeIndex===b}]),key:b,onClick:d=>M(b)},[a("div",St,[a("img",{src:p.cover,onerror:"this.src='./images/music.png'",alt:""},null,8,Mt)]),a("div",wt,[a("p",null,I(p.name),1),a("span",null,I(p.singer),1)]),a("div",{class:"music-action",onClick:j[0]||(j[0]=_e(()=>{},["stop"]))},[i(L,{placement:"bottomLeft",arrow:""},{overlay:v(()=>[i(w,null,{default:v(()=>[i(O,null,{default:v(()=>[a("a",{href:"javascript:;",onClick:d=>M(b)},"播放",8,kt)]),_:2},1024),i(O,null,{default:v(()=>[a("a",{href:"javascript:;",onClick:d=>P(b)},"移除",8,It)]),_:2},1024),i(O,null,{default:v(()=>[a("a",{href:"javascript:;",onClick:d=>f(p)},"下载",8,jt)]),_:2},1024)]),_:2},1024)]),default:v(()=>[i(c(ye))]),_:2},1024)])],10,Pt))),128))])]),_:1})])])]),_:1},8,["open"])}}},Dt=U(zt,[["__scopeId","data-v-5a8bf248"]]);const Vt=n=>(be("data-v-2f05ab74"),n=n(),Oe(),n),Nt={class:"search"},Ft={key:0,class:"search-history"},Ht={class:"title"},Tt={class:"search-history-box"},Et=["onClick"],Rt={class:"text",title:"点击搜索"},At={class:"search-list"},Bt=Vt(()=>a("p",{class:"title"},"搜索结果：",-1)),Ut=["onClick"],qt={title:"立即播放"},Gt={class:"search-action"},Yt=["onClick"],Jt=["onClick"],Qt=["onClick"],Wt=["onClick"],fe=15,Xt={__name:"MusicSearch",setup(n){const{useMusicStore:e}=q(),t=$(""),s=$([]),l=$(!1),g=o=>{e.searchHistory.indexOf(o)<0&&e.searchHistory.unshift(o),f(o)};let M=$(1),P=$(!1);const f=o=>{t.value=o,l.value=!0;const r=`https://api.lolimi.cn/API/qqdg/api.php?msg=${o}&p=${M.value}&sc=${fe}`;G.get(r).then(p=>{p.data.code===1?(s.value=[...s.value,...p.data.data],p.data.data.length<fe&&(P.value=!0)):P.value=!0,l.value=!1})},y=o=>{if(P.value)return;let r=o.target;r.scrollTop+r.clientHeight>=r.scrollHeight&&(M.value++,f(t.value))},j=()=>{e.searchHistory=[]},D=o=>{const r=e.searchHistory.indexOf(o);e.searchHistory.splice(r,1)},z=async(o,r)=>{const{cover:p,name:b,singer:d,url:u,content:S}=await L(o);e.musicList.push({id:Z(21),cover:p,name:b,singer:d,url:u,content:S}),e.playMusic(e.musicList.length-1)},C=async(o,r)=>{const{cover:p,name:b,singer:d,url:u,content:S}=await L(o);e.musicList.push({id:Z(21),cover:p,name:b,singer:d,url:u,content:S})},O=async(o,r)=>{const{cover:p,name:b,singer:d,url:u,content:S}=await L(o);e.musicList.splice(e.activeIndex+1,0,{id:Z(21),cover:p,name:b,singer:d,url:u,content:S})},w=async(o,r)=>{const{url:p}=await L(o);p&&Le(p)},L=async(o,r)=>{const p=new Promise((u,S)=>{G.get(`https://xiaoapi.cn/API/yy_sq.php?msg=${o.song}-${o.singer}&n=1`).then(k=>{k.data.code===200?u(k.data):S()})}),b=new Promise((u,S)=>{G.get(`https://api.lolimi.cn/API/kggc/api.php?msg=${o.song}-${o.singer}&n=1`).then(k=>{k.data.code===1?u(k.data.data):S()})}),d=await Promise.all([p,b]);return{...d[0],...d[1]}};return(o,r)=>{const p=h("a-input"),b=h("a-col"),d=h("a-button"),u=h("a-row"),S=h("a-empty"),k=h("a-menu-item"),V=h("a-menu"),$e=h("a-dropdown"),Ce=h("perfect-scrollbar"),xe=h("a-spin");return m(),_("div",Nt,[i(u,{gutter:12},{default:v(()=>[i(b,{span:20},{default:v(()=>[i(p,{value:t.value,"onUpdate:value":r[0]||(r[0]=x=>t.value=x),onPressEnter:r[1]||(r[1]=x=>g(x.target.value)),placeholder:"输入歌曲、歌手",allowClear:"",style:{"border-radius":"16px"}},{prefix:v(()=>[i(c(ge))]),_:1},8,["value"])]),_:1}),i(b,{span:3},{default:v(()=>[i(d,{type:"primary",shape:"round",onClick:r[2]||(r[2]=x=>g(t.value))},{default:v(()=>[F("搜索")]),_:1})]),_:1})]),_:1}),c(e).searchHistory.length?(m(),_("div",Ft,[a("p",Ht,[F(" 搜索历史： "),a("span",{class:"clear",onClick:j},[i(c(he)),F("清空历史搜索")])]),a("div",Tt,[(m(!0),_(J,null,Q(c(e).searchHistory,(x,N)=>(m(),_("p",{key:N,onClick:A=>f(x)},[a("span",Rt,I(x),1),i(c(Pe),{title:"点击移除",onClick:_e(A=>D(x),["stop"])},null,8,["onClick"])],8,Et))),128))])])):E("",!0),a("div",At,[Bt,i(xe,{spinning:l.value,tip:"加载中..."},{default:v(()=>[i(Ce,{class:"scroll-bar",onPsScrollY:y},{default:v(()=>[s.value.length?E("",!0):(m(),R(S,{key:0})),a("ul",null,[(m(!0),_(J,null,Q(s.value,(x,N)=>(m(),_("li",{key:N,onClick:A=>z(x,N)},[a("p",qt,I(x.song)+" - "+I(x.singers),1),a("div",Gt,[i($e,{placement:"bottomLeft",arrow:""},{overlay:v(()=>[i(V,null,{default:v(()=>[i(k,null,{default:v(()=>[a("a",{href:"javascript:;",onClick:A=>C(x,N)},"添加到播放列表",8,Yt)]),_:2},1024),i(k,null,{default:v(()=>[a("a",{href:"javascript:;",onClick:A=>z(x,N)},"立即播放",8,Jt)]),_:2},1024),i(k,null,{default:v(()=>[a("a",{href:"javascript:;",onClick:A=>O(x,N)},"下一首播放",8,Qt)]),_:2},1024),i(k,null,{default:v(()=>[a("a",{href:"javascript:;",onClick:A=>w(x,N)},"下载",8,Wt)]),_:2},1024)]),_:2},1024)]),default:v(()=>[i(c(ye))]),_:2},1024)])],8,Ut))),128))])]),_:1})]),_:1},8,["spinning"])])])}}},Zt=U(Xt,[["__scopeId","data-v-2f05ab74"]]);const Kt=n=>(be("data-v-d7fbedec"),n=n(),Oe(),n),en={class:"bg"},tn=["src"],nn=Kt(()=>a("div",{class:"mask"},null,-1)),sn={class:"music-info"},ln=["src"],an={class:"music-lyric"},cn={key:0,class:"no-lyric"},on={class:"action"},rn={__name:"MusicFullScreen",props:{open:{type:Boolean,default:!1}},emits:["close"],setup(n,{emit:e}){const{useMusicStore:t}=q(),s=$(!1),l=$(null),{isFullscreen:g,toggle:M,exit:P}=Se(l),f=$({});B(()=>[t.activeIndex,t.settings.playing],()=>{f.value=t.musicList[t.activeIndex]||{}},{immediate:!0,deep:!0});const y=Y(()=>{var O,w,L;let C=[];return(w=(O=f.value)==null?void 0:O.content)!=null&&w.length?C=D((L=f.value)==null?void 0:L.content):j(),C}),j=()=>{G.get(`https://api.lolimi.cn/API/kggc/api.php?msg=${f.value.name}-${f.value.singer}&n=1`).then(C=>{const{content:O}=C.data.data||{};C.data.code===1&&(t.musicList[t.activeIndex].content=O)})},D=C=>{const O=[];return C.split(`
`).map(L=>{let o=L.match(/\[(.*?)\]/);if(o){let r=o[1];/^(0\d|1\d|2[0-3]):([0-5]\d)\.(?:\d{2})$/.test(r)&&O.push({time:r,lyric:L.replace(/\[.*?\]/g,"")})}}),O},z=()=>{P(),e("close")};return(C,O)=>{const w=h("perfect-scrollbar");return m(),_("div",{ref_key:"fullscreenRef",ref:l,class:T(["music-fullscreen",{open:n.open}])},[a("div",en,[a("img",{src:f.value.cover,alt:""},null,8,tn),nn]),a("div",sn,[a("img",{class:T(["cover",{playing:s.value||c(t).settings.playing}]),onClick:O[0]||(O[0]=L=>s.value=!s.value),src:f.value.cover,alt:""},null,10,ln),a("p",null,I(f.value.name),1),a("span",null,I(f.value.singer),1)]),a("div",an,[y.value.length?E("",!0):(m(),_("p",cn,"暂无歌词")),i(w,{class:"scroll-bar"},{default:v(()=>[(m(!0),_(J,null,Q(y.value,(L,o)=>(m(),_("p",{class:T({active:o===6}),key:o},I(L.lyric),3))),128))]),_:1})]),a("div",on,[i(c(Me),{class:"close",title:"关闭歌词",onClick:z}),c(g)?(m(),R(c(Ne),{key:0,title:"关闭全屏",onClick:c(M)},null,8,["onClick"])):(m(),R(c(Ee),{key:1,title:"开启全屏",onClick:c(M)},null,8,["onClick"]))])],2)}}},un=U(rn,[["__scopeId","data-v-d7fbedec"]]);const dn={class:"music"},vn=["src","loop"],pn=["title"],mn={__name:"Index",setup(n){const{useMusicStore:e}=q();we(()=>{e.settings.playing=!1});const t=$(!1),s=$(!1),l=$(!1),g=$(null),M=$({});B(()=>[e.activeIndex,e.settings.playing],()=>{M.value=e.musicList[e.activeIndex]||{},W(()=>{g.value&&(f.value=parseInt(g.value.duration),g.value.volume=e.settings.volume/100,e.settings.playing&&g.value.play())})},{immediate:!0,deep:!0}),B(()=>[e.settings.volume,e.settings.mute],()=>{g.value&&W(()=>{g.value.volume=e.settings.volume/100,g.value.muted=e.settings.mute})},{immediate:!0,deep:!0});const P=$(0),f=$(1e3),y=()=>{f.value=parseInt(g.value.duration),P.value=g.value.currentTime=e.settings.currentTime},j=d=>{const{currentTime:u,duration:S}=d.target;P.value=e.settings.currentTime=parseInt(u),f.value=parseInt(S)},D=()=>{e.toggleVisible()},z=()=>{!e.musicList.length||e.activeIndex<0||(e.settings.playing=!0,g.value.play())},C=()=>{!e.musicList.length||e.activeIndex<0||(e.settings.playing=!1,g.value.pause())},O=Y(()=>{if(!e.musicList.length||e.activeIndex<0)return"";let d=e.activeIndex===0?e.musicList.length-1:e.activeIndex-1;return e.musicList[d]?e.musicList[d].name:""}),w=()=>{if(!e.musicList.length||e.activeIndex<0)return;let d=e.activeIndex===0?e.musicList.length-1:e.activeIndex-1;e.playMusic(d)},L=Y(()=>{if(!e.musicList.length||e.activeIndex<0)return"";let d=e.activeIndex===e.musicList.length-1?0:e.activeIndex+1;return e.musicList[d]?e.musicList[d].name:""}),o=()=>{if(!e.musicList.length||e.activeIndex<0)return;let d=e.activeIndex===e.musicList.length-1?0:e.activeIndex+1;e.playMusic(d)},r=()=>{e.settings.mode==="listCycle"?(e.musicList.length===1&&(e.activeIndex--,e.activeIndex++),o()):e.settings.mode==="singleCycle"?e.playMusic(e.activeIndex):e.settings.mode==="randomPlay"&&e.playMusic(getRandomIntInRange(0,e.musicList.length-1,e.activeIndex))},p=d=>{e.settings.currentTime=d,g.value&&W(()=>{g.value.currentTime=d})},b=Y(()=>({listCycle:"列表循环",singleCycle:"单曲循环",randomPlay:"随机播放"})[e.settings.mode]);return(d,u)=>{var k;const S=h("IDialog");return m(),_("div",dn,[ke(a("audio",{ref_key:"audioRef",ref:g,controls:"",src:(k=M.value)==null?void 0:k.url,loop:c(e).settings.mode==="singleCycle",onTimeupdate:j,onLoadeddata:y,onEnded:r,onError:r},null,40,vn),[[Ie,!1]]),a("div",{class:T(["toggle-icon bf",[c(e).visible?"down":"up"]]),title:c(e).visible?"隐藏播放器":"显示播放器",onClick:D},[i(c(je))],10,pn),a("div",{class:T(["music-ctrl bf",[c(e).visible?"show":""]])},[i(Lt,{musicCurrentTime:P.value,musicDuration:f.value,prevMusic:O.value,nextMusic:L.value,musicMode:b.value,onShowSearch:u[0]||(u[0]=V=>s.value=!0),onToggleMusicList:u[1]||(u[1]=V=>t.value=!t.value),onShowLyric:u[2]||(u[2]=V=>l.value=!0),onHandlePlay:z,onHandlePause:C,onHandlePrev:w,onHandleNext:o,onHandleDurationChange:p},null,8,["musicCurrentTime","musicDuration","prevMusic","nextMusic","musicMode"])],2),i(Dt,{open:t.value,onShowSearch:u[3]||(u[3]=V=>s.value=!0),onClose:u[4]||(u[4]=V=>t.value=!1)},null,8,["open"]),i(S,{title:"搜索音乐",visible:s.value,zIndex:1002,onOk:u[5]||(u[5]=V=>s.value=!1),onCancel:u[6]||(u[6]=V=>s.value=!1)},{default:v(()=>[i(Zt)]),_:1},8,["visible"]),i(un,{open:l.value,onClose:u[7]||(u[7]=V=>l.value=!1)},null,8,["open"])])}}},hn=U(mn,[["__scopeId","data-v-86438d20"]]);export{hn as default};
