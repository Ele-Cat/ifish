import{p as C,D as S,b as e,w as x,r as l,h as u,i as w,q as c,C as B,z as y,j as s,k as i,F as E,s as N,B as U,y as g,L as j,M as q}from"./index-c1c08e54.js";import{_ as O,u as z}from"./App-9be516e4.js";import{a as A}from"./utils-521ae38d.js";const F=m=>(j("data-v-443080aa"),m=m(),q(),m),L={class:"offwork-text"},$={key:0},M=F(()=>c("img",{src:"https://i.postimg.cc/pVzqwjn0/qipao.png",alt:""},null,-1)),R={__name:"OffWorkCountdown",setup(m){const{useAppStore:t}=z(),k=C(!1),H=S(["周日","周一","周二","周三","周四","周五","周六"]),r=S({workDays:t.offWorkCountdown.workDays,workTimeStart:t.offWorkCountdown.workTimeStart?e(t.offWorkCountdown.workTimeStart,"HH:mm"):null,workTimeEnd:t.offWorkCountdown.workTimeEnd?e(t.offWorkCountdown.workTimeEnd,"HH:mm"):null}),d=C("");let p=null;const W=()=>{p&&clearInterval(p)};return x(()=>r,a=>{let o="点击配置";console.log("newVal.workTimeEnd: ",a.workTimeEnd),W(),a.workTimeEnd?(t.offWorkCountdown.workTimeStart=e(a.workTimeStart).format("HH:mm"),t.offWorkCountdown.workTimeEnd=e(a.workTimeEnd).format("HH:mm"),t.offWorkCountdown.workDays[e().day()]?e().isBefore(e(a.workTimeStart))?o="还没上班呢~":e().isAfter(e(a.workTimeEnd))?o="已经下班啦~":p=setInterval(()=>{const _=e(a.workTimeEnd),f=e();o=_.diff(f),d.value=A(o)},1e3):o="今天是休息日~"):t.offWorkCountdown.workTimeEnd=null,a.workTimeStart||(t.offWorkCountdown.workTimeStart=null),d.value=o},{immediate:!0,deep:!0}),(a,o)=>{const _=l("a-checkable-tag"),f=l("a-form-item"),v=l("a-time-picker"),h=l("a-space"),D=l("a-form"),b=l("IDialog");return u(),w(E,null,[c("div",{class:"offwork",onClick:o[0]||(o[0]=n=>k.value=!0)},[c("div",L,[d.value.includes(":")?(u(),w("p",$,"距离下班时间还有")):B("",!0),c("p",null,y(d.value),1)]),M]),s(b,{title:"配置",width:480,visible:k.value,onCancel:o[3]||(o[3]=n=>k.value=!1)},{default:i(()=>[s(D,{model:r,layout:"vertical",style:{"padding-top":"20px"}},{default:i(()=>[s(f,{label:"选择工作日"},{default:i(()=>[(u(!0),w(E,null,N(H,(n,T)=>(u(),U(_,{key:n,checked:r.workDays[T],"onUpdate:checked":I=>r.workDays[T]=I},{default:i(()=>[g(y(n),1)]),_:2},1032,["checked","onUpdate:checked"]))),128))]),_:1}),s(f,{label:"上下班时间"},{default:i(()=>[s(h,null,{default:i(()=>[s(v,{value:r.workTimeStart,"onUpdate:value":o[1]||(o[1]=n=>r.workTimeStart=n),placeholder:"上班时间","minute-step":10,format:"HH:mm"},null,8,["value"]),g("~ "),s(v,{value:r.workTimeEnd,"onUpdate:value":o[2]||(o[2]=n=>r.workTimeEnd=n),placeholder:"下班时间","minute-step":10,format:"HH:mm"},null,8,["value"])]),_:1})]),_:1})]),_:1},8,["model"])]),_:1},8,["visible"])],64)}}},P=O(R,[["__scopeId","data-v-443080aa"]]);export{P as default};
