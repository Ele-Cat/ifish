import{c as l,A as q,_ as X,u as Z,r as P,w as Y,a as y,o as v,b as h,d as a,e as B,f as i,n as U,t as x,g as d,h as A,i as R,S as Ce,D as Oe,F as Q,j as W,k as $e,E as Le,C as Ne,l as ee,p as xe,m as Pe,q as He,s as te,v as Me,x as Se,y as Ve,z as Fe,B as ne,G as Ee}from"./index-be4a0920.js";import{s as J,d as ke,u as se,m as K,g as Re}from"./utils-7dc22624.js";var Ae={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M391 240.9c-.8-6.6-8.9-9.4-13.6-4.7l-43.7 43.7L200 146.3a8.03 8.03 0 00-11.3 0l-42.4 42.3a8.03 8.03 0 000 11.3L280 333.6l-43.9 43.9a8.01 8.01 0 004.7 13.6L401 410c5.1.6 9.5-3.7 8.9-8.9L391 240.9zm10.1 373.2L240.8 633c-6.6.8-9.4 8.9-4.7 13.6l43.9 43.9L146.3 824a8.03 8.03 0 000 11.3l42.4 42.3c3.1 3.1 8.2 3.1 11.3 0L333.7 744l43.7 43.7A8.01 8.01 0 00391 783l18.9-160.1c.6-5.1-3.7-9.4-8.8-8.8zm221.8-204.2L783.2 391c6.6-.8 9.4-8.9 4.7-13.6L744 333.6 877.7 200c3.1-3.1 3.1-8.2 0-11.3l-42.4-42.3a8.03 8.03 0 00-11.3 0L690.3 279.9l-43.7-43.7a8.01 8.01 0 00-13.6 4.7L614.1 401c-.6 5.2 3.7 9.5 8.8 8.9zM744 690.4l43.9-43.9a8.01 8.01 0 00-4.7-13.6L623 614c-5.1-.6-9.5 3.7-8.9 8.9L633 783.1c.8 6.6 8.9 9.4 13.6 4.7l43.7-43.7L824 877.7c3.1 3.1 8.2 3.1 11.3 0l42.4-42.3c3.1-3.1 3.1-8.2 0-11.3L744 690.4z"}}]},name:"fullscreen-exit",theme:"outlined"};const Be=Ae;function ve(n){for(var e=1;e<arguments.length;e++){var t=arguments[e]!=null?Object(arguments[e]):{},s=Object.keys(t);typeof Object.getOwnPropertySymbols=="function"&&(s=s.concat(Object.getOwnPropertySymbols(t).filter(function(c){return Object.getOwnPropertyDescriptor(t,c).enumerable}))),s.forEach(function(c){Ue(n,c,t[c])})}return n}function Ue(n,e,t){return e in n?Object.defineProperty(n,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):n[e]=t,n}var le=function(e,t){var s=ve({},e,t.attrs);return l(q,ve({},s,{icon:Be}),null)};le.displayName="FullscreenExitOutlined";le.inheritAttrs=!1;const qe=le;var Ge={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M290 236.4l43.9-43.9a8.01 8.01 0 00-4.7-13.6L169 160c-5.1-.6-9.5 3.7-8.9 8.9L179 329.1c.8 6.6 8.9 9.4 13.6 4.7l43.7-43.7L370 423.7c3.1 3.1 8.2 3.1 11.3 0l42.4-42.3c3.1-3.1 3.1-8.2 0-11.3L290 236.4zm352.7 187.3c3.1 3.1 8.2 3.1 11.3 0l133.7-133.6 43.7 43.7a8.01 8.01 0 0013.6-4.7L863.9 169c.6-5.1-3.7-9.5-8.9-8.9L694.8 179c-6.6.8-9.4 8.9-4.7 13.6l43.9 43.9L600.3 370a8.03 8.03 0 000 11.3l42.4 42.4zM845 694.9c-.8-6.6-8.9-9.4-13.6-4.7l-43.7 43.7L654 600.3a8.03 8.03 0 00-11.3 0l-42.4 42.3a8.03 8.03 0 000 11.3L734 787.6l-43.9 43.9a8.01 8.01 0 004.7 13.6L855 864c5.1.6 9.5-3.7 8.9-8.9L845 694.9zm-463.7-94.6a8.03 8.03 0 00-11.3 0L236.3 733.9l-43.7-43.7a8.01 8.01 0 00-13.6 4.7L160.1 855c-.6 5.1 3.7 9.5 8.9 8.9L329.2 845c6.6-.8 9.4-8.9 4.7-13.6L290 787.6 423.7 654c3.1-3.1 3.1-8.2 0-11.3l-42.4-42.4z"}}]},name:"fullscreen",theme:"outlined"};const Je=Ge;function me(n){for(var e=1;e<arguments.length;e++){var t=arguments[e]!=null?Object(arguments[e]):{},s=Object.keys(t);typeof Object.getOwnPropertySymbols=="function"&&(s=s.concat(Object.getOwnPropertySymbols(t).filter(function(c){return Object.getOwnPropertyDescriptor(t,c).enumerable}))),s.forEach(function(c){Ye(n,c,t[c])})}return n}function Ye(n,e,t){return e in n?Object.defineProperty(n,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):n[e]=t,n}var ie=function(e,t){var s=me({},e,t.attrs);return l(q,me({},s,{icon:Je}),null)};ie.displayName="FullscreenOutlined";ie.inheritAttrs=!1;const Qe=ie;var We={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M408 442h480c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8H408c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8zm-8 204c0 4.4 3.6 8 8 8h480c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8H408c-4.4 0-8 3.6-8 8v56zm504-486H120c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8h784c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8zm0 632H120c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8h784c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8zM142.4 642.1L298.7 519a8.84 8.84 0 000-13.9L142.4 381.9c-5.8-4.6-14.4-.5-14.4 6.9v246.3a8.9 8.9 0 0014.4 7z"}}]},name:"menu-unfold",theme:"outlined"};const Xe=We;function pe(n){for(var e=1;e<arguments.length;e++){var t=arguments[e]!=null?Object(arguments[e]):{},s=Object.keys(t);typeof Object.getOwnPropertySymbols=="function"&&(s=s.concat(Object.getOwnPropertySymbols(t).filter(function(c){return Object.getOwnPropertyDescriptor(t,c).enumerable}))),s.forEach(function(c){Ze(n,c,t[c])})}return n}function Ze(n,e,t){return e in n?Object.defineProperty(n,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):n[e]=t,n}var ae=function(e,t){var s=pe({},e,t.attrs);return l(q,pe({},s,{icon:Xe}),null)};ae.displayName="MenuUnfoldOutlined";ae.inheritAttrs=!1;const we=ae;var Ke={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M512 64C264.6 64 64 264.6 64 512s200.6 448 448 448 448-200.6 448-448S759.4 64 512 64zm0 820c-205.4 0-372-166.6-372-372s166.6-372 372-372 372 166.6 372 372-166.6 372-372 372zm-88-532h-48c-4.4 0-8 3.6-8 8v304c0 4.4 3.6 8 8 8h48c4.4 0 8-3.6 8-8V360c0-4.4-3.6-8-8-8zm224 0h-48c-4.4 0-8 3.6-8 8v304c0 4.4 3.6 8 8 8h48c4.4 0 8-3.6 8-8V360c0-4.4-3.6-8-8-8z"}}]},name:"pause-circle",theme:"outlined"};const et=Ke;function fe(n){for(var e=1;e<arguments.length;e++){var t=arguments[e]!=null?Object(arguments[e]):{},s=Object.keys(t);typeof Object.getOwnPropertySymbols=="function"&&(s=s.concat(Object.getOwnPropertySymbols(t).filter(function(c){return Object.getOwnPropertyDescriptor(t,c).enumerable}))),s.forEach(function(c){tt(n,c,t[c])})}return n}function tt(n,e,t){return e in n?Object.defineProperty(n,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):n[e]=t,n}var ce=function(e,t){var s=fe({},e,t.attrs);return l(q,fe({},s,{icon:et}),null)};ce.displayName="PauseCircleOutlined";ce.inheritAttrs=!1;const Ie=ce;var nt={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M512 64C264.6 64 64 264.6 64 512s200.6 448 448 448 448-200.6 448-448S759.4 64 512 64zm0 820c-205.4 0-372-166.6-372-372s166.6-372 372-372 372 166.6 372 372-166.6 372-372 372z"}},{tag:"path",attrs:{d:"M719.4 499.1l-296.1-215A15.9 15.9 0 00398 297v430c0 13.1 14.8 20.5 25.3 12.9l296.1-215a15.9 15.9 0 000-25.8zm-257.6 134V390.9L628.5 512 461.8 633.1z"}}]},name:"play-circle",theme:"outlined"};const st=nt;function ge(n){for(var e=1;e<arguments.length;e++){var t=arguments[e]!=null?Object(arguments[e]):{},s=Object.keys(t);typeof Object.getOwnPropertySymbols=="function"&&(s=s.concat(Object.getOwnPropertySymbols(t).filter(function(c){return Object.getOwnPropertyDescriptor(t,c).enumerable}))),s.forEach(function(c){lt(n,c,t[c])})}return n}function lt(n,e,t){return e in n?Object.defineProperty(n,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):n[e]=t,n}var oe=function(e,t){var s=ge({},e,t.attrs);return l(q,ge({},s,{icon:st}),null)};oe.displayName="PlayCircleOutlined";oe.inheritAttrs=!1;const De=oe;var it={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M912 192H328c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8h584c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8zm0 284H328c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8h584c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8zm0 284H328c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8h584c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8zM104 228a56 56 0 10112 0 56 56 0 10-112 0zm0 284a56 56 0 10112 0 56 56 0 10-112 0zm0 284a56 56 0 10112 0 56 56 0 10-112 0z"}}]},name:"unordered-list",theme:"outlined"};const at=it;function he(n){for(var e=1;e<arguments.length;e++){var t=arguments[e]!=null?Object(arguments[e]):{},s=Object.keys(t);typeof Object.getOwnPropertySymbols=="function"&&(s=s.concat(Object.getOwnPropertySymbols(t).filter(function(c){return Object.getOwnPropertyDescriptor(t,c).enumerable}))),s.forEach(function(c){ct(n,c,t[c])})}return n}function ct(n,e,t){return e in n?Object.defineProperty(n,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):n[e]=t,n}var re=function(e,t){var s=he({},e,t.attrs);return l(q,he({},s,{icon:at}),null)};re.displayName="UnorderedListOutlined";re.inheritAttrs=!1;const ot=re;var rt={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M762 164h-64c-4.4 0-8 3.6-8 8v688c0 4.4 3.6 8 8 8h64c4.4 0 8-3.6 8-8V172c0-4.4-3.6-8-8-8zm-508 0v72.4c0 9.5 4.2 18.4 11.4 24.5L564.6 512 265.4 763.1c-7.2 6.1-11.4 15-11.4 24.5V860c0 6.8 7.9 10.5 13.1 6.1L689 512 267.1 157.9A7.95 7.95 0 00254 164z"}}]},name:"vertical-left",theme:"outlined"};const ut=rt;function _e(n){for(var e=1;e<arguments.length;e++){var t=arguments[e]!=null?Object(arguments[e]):{},s=Object.keys(t);typeof Object.getOwnPropertySymbols=="function"&&(s=s.concat(Object.getOwnPropertySymbols(t).filter(function(c){return Object.getOwnPropertyDescriptor(t,c).enumerable}))),s.forEach(function(c){dt(n,c,t[c])})}return n}function dt(n,e,t){return e in n?Object.defineProperty(n,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):n[e]=t,n}var ue=function(e,t){var s=_e({},e,t.attrs);return l(q,_e({},s,{icon:ut}),null)};ue.displayName="VerticalLeftOutlined";ue.inheritAttrs=!1;const je=ue;var vt={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M326 164h-64c-4.4 0-8 3.6-8 8v688c0 4.4 3.6 8 8 8h64c4.4 0 8-3.6 8-8V172c0-4.4-3.6-8-8-8zm444 72.4V164c0-6.8-7.9-10.5-13.1-6.1L335 512l421.9 354.1c5.2 4.4 13.1.7 13.1-6.1v-72.4c0-9.4-4.2-18.4-11.4-24.5L459.4 512l299.2-251.1c7.2-6.1 11.4-15.1 11.4-24.5z"}}]},name:"vertical-right",theme:"outlined"};const mt=vt;function ye(n){for(var e=1;e<arguments.length;e++){var t=arguments[e]!=null?Object(arguments[e]):{},s=Object.keys(t);typeof Object.getOwnPropertySymbols=="function"&&(s=s.concat(Object.getOwnPropertySymbols(t).filter(function(c){return Object.getOwnPropertyDescriptor(t,c).enumerable}))),s.forEach(function(c){pt(n,c,t[c])})}return n}function pt(n,e,t){return e in n?Object.defineProperty(n,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):n[e]=t,n}var de=function(e,t){var s=ye({},e,t.attrs);return l(q,ye({},s,{icon:mt}),null)};de.displayName="VerticalRightOutlined";de.inheritAttrs=!1;const ze=de;const ft={class:"music-box"},gt={key:0,class:"info"},ht={key:1,class:"info"},_t=["src"],yt={class:"center"},bt={class:"prev-next"},Ct={class:"progress-box"},Ot={class:"ctrl"},$t=["title"],Lt={class:"mode"},xt={__name:"MusicCtrl",props:{musicCurrentTime:{type:Number,default:0},musicDuration:{type:Number,default:0},prevMusic:{type:String,default:""},nextMusic:{type:String,default:""},musicMode:{type:String,default:""}},emits:["toggleMusicList","showSearch","handleDurationChange","handlePlay","handlePause","handlePrev","handleNext","showLyric"],setup(n,{emit:e}){const t=n,{useMusicStore:s}=Z(),c=P(0);Y(()=>t.musicCurrentTime,o=>{c.value=o},{immediate:!0,deep:!0});const b=()=>{e("toggleMusicList")},z=()=>{e("showSearch")},M=o=>{s.changeMode(o)},L=o=>{s.toggleMute(o)},g=P({});Y(()=>[s.activeIndex,s.settings.playing],()=>{g.value=s.musicList[s.activeIndex]||{}},{immediate:!0,deep:!0});const H=o=>J(o),T=o=>{e("handleDurationChange",o)},k=()=>{e("handlePlay")},V=()=>{e("handlePause")},N=()=>{e("handlePrev")},F=()=>{e("handleNext")},j=()=>{e("showLyric")};return(o,r)=>{const f=y("a-tooltip"),C=y("a-slider"),m=y("a-divider");return v(),h("div",ft,[a(s).musicList.length?(v(),h("div",ht,[i("div",{class:"cover",onClick:j},[i("img",{class:U({playing:a(s).settings.playing}),src:g.value.cover,onerror:"this.src='./images/music.png'",alt:""},null,10,_t)]),B(" "+x(g.value.name)+" - "+x(g.value.singer),1)])):(v(),h("div",gt,[B(" 暂无音乐，请选择"),i("span",{class:"add",onClick:z},"添加")])),i("div",yt,[i("div",bt,[l(f,{title:`上一首${n.prevMusic?"：":""}${n.prevMusic}`},{default:d(()=>[l(a(ze),{onClick:N})]),_:1},8,["title"]),l(f,{title:a(s).settings.playing?"点击暂停":"点击播放"},{default:d(()=>[a(s).settings.playing?(v(),A(a(Ie),{key:1,class:"pause",onClick:V})):(v(),A(a(De),{key:0,class:"play",onClick:k}))]),_:1},8,["title"]),l(f,{title:`下一首${n.nextMusic?"：":""}${n.nextMusic}`},{default:d(()=>[l(a(je),{onClick:F})]),_:1},8,["title"])]),i("div",Ct,[i("p",null,x(a(J)(c.value)),1),l(C,{class:"play-slider",min:0,max:n.musicDuration,onChange:T,value:c.value,"onUpdate:value":r[0]||(r[0]=u=>c.value=u),tipFormatter:H},null,8,["max","value"]),i("p",null,x(a(J)(n.musicDuration)),1)])]),i("div",Ot,[i("div",{class:"volume",title:`当前音量：${a(s).settings.volume}`},[a(s).settings.mute||a(s).settings.volume===0?(v(),h("i",{key:0,class:"ifishfont ifish-volumeDisable",onClick:r[1]||(r[1]=u=>L(!0))})):a(s).settings.volume>=0&&a(s).settings.volume<30?(v(),h("i",{key:1,class:"ifishfont ifish-volumeLow",onClick:r[2]||(r[2]=u=>L(!1))})):a(s).settings.volume>=30&&a(s).settings.volume<60?(v(),h("i",{key:2,class:"ifishfont ifish-volumeMiddle",onClick:r[3]||(r[3]=u=>L(!1))})):(v(),h("i",{key:3,class:"ifishfont ifish-volumeHigh",onClick:r[4]||(r[4]=u=>L(!1))})),l(C,{class:"volume-slider",min:0,max:100,value:a(s).settings.volume,"onUpdate:value":r[5]||(r[5]=u=>a(s).settings.volume=u)},null,8,["value"])],8,$t),i("div",Lt,[l(f,{title:n.musicMode},{default:d(()=>[a(s).settings.mode==="listCycle"?(v(),h("i",{key:0,class:"ifishfont ifish-musicListLoop",title:"列表循环",onClick:r[6]||(r[6]=u=>M("singleCycle"))})):R("",!0),a(s).settings.mode==="singleCycle"?(v(),h("i",{key:1,class:"ifishfont ifish-musicSingleCycle",title:"单曲循环",onClick:r[7]||(r[7]=u=>M("randomPlay"))})):R("",!0),a(s).settings.mode==="randomPlay"?(v(),h("i",{key:2,class:"ifishfont ifish-musicRandomPlay",title:"随机播放",onClick:r[8]||(r[8]=u=>M("listCycle"))})):R("",!0)]),_:1},8,["title"])]),l(m,{type:"vertical"}),l(f,{title:"播放列表",placement:"topRight"},{default:d(()=>[l(a(we),{onClick:b})]),_:1})])])}}},Pt=X(xt,[["__scopeId","data-v-1b8fd605"]]);const Mt={class:"music-box"},St={class:"title"},kt={class:"music-list"},wt=["onClick"],It={class:"music-cover"},Dt=["src"],jt={class:"music-info"},zt=["onClick"],Tt=["onClick"],Nt=["onClick"],Ht={__name:"MusicList",props:{open:{type:Boolean,default:!1}},emits:["close","showSearch"],setup(n,{emit:e}){const{useMusicStore:t}=Z(),s=()=>{e("close")},c=()=>{e("showSearch")},b=()=>{t.musicList=[]},z=g=>{t.playMusic(g)},M=g=>{g<t.activeIndex?(t.musicList.splice(g,1),t.activeIndex--):(g===t.activeIndex&&(t.settings.currentTime=0,t.activeIndex===t.musicList.length-1&&(t.activeIndex=0),t.activeIndex++,t.activeIndex--),t.musicList.splice(g,1))},L=g=>{ke(g.url)};return(g,H)=>{const T=y("a-input"),k=y("a-popconfirm"),V=y("a-empty"),N=y("a-menu-item"),F=y("a-menu"),j=y("a-dropdown"),o=y("perfect-scrollbar"),r=y("a-drawer");return v(),A(r,{width:"360px",title:"播放列表",placement:"right",open:n.open,onClose:s,rootClassName:"disclaimers-root"},{default:d(()=>[i("div",Mt,[l(T,{onClick:c,readonly:"",placeholder:"搜索",style:{"border-radius":"20px"}},{prefix:d(()=>[l(a(Ce))]),_:1}),i("div",null,[i("p",St,[i("span",null,[l(a(ot)),B("播放列表（共 "+x(a(t).musicList.length)+" 首）",1)]),l(k,{title:"确认清空列表？",onConfirm:b},{default:d(()=>[i("span",null,[l(a(Oe)),B("清空列表")])]),_:1})]),a(t).musicList.length?R("",!0):(v(),A(V,{key:0,class:"list-empty"},{description:d(()=>[i("span",{class:"description"},[B(" 暂无歌曲，请"),i("a",{onClick:c},"搜索添加")])]),_:1})),l(o,{class:"scroll-bar"},{default:d(()=>[i("div",kt,[(v(!0),h(Q,null,W(a(t).musicList,(f,C)=>(v(),h("div",{class:U(["music-item",{active:a(t).activeIndex===C}]),key:C,onClick:m=>z(C)},[i("div",It,[i("img",{src:f.cover,onerror:"this.src='./images/music.png'",alt:""},null,8,Dt)]),i("div",jt,[i("p",null,x(f.name),1),i("span",null,x(f.singer),1)]),i("div",{class:"music-action",onClick:H[0]||(H[0]=$e(()=>{},["stop"]))},[l(j,{placement:"bottomLeft",arrow:""},{overlay:d(()=>[l(F,null,{default:d(()=>[l(N,null,{default:d(()=>[i("a",{href:"javascript:;",onClick:m=>z(C)},"播放",8,zt)]),_:2},1024),l(N,null,{default:d(()=>[i("a",{href:"javascript:;",onClick:m=>M(C)},"移除",8,Tt)]),_:2},1024),l(N,null,{default:d(()=>[i("a",{href:"javascript:;",onClick:m=>L(f)},"下载",8,Nt)]),_:2},1024)]),_:2},1024)]),default:d(()=>[l(a(Le))]),_:2},1024)])],10,wt))),128))])]),_:1})])])]),_:1},8,["open"])}}},Vt=X(Ht,[["__scopeId","data-v-5a8bf248"]]);const Ft=n=>(xe("data-v-2f05ab74"),n=n(),Pe(),n),Et={class:"search"},Rt={key:0,class:"search-history"},At={class:"title"},Bt={class:"search-history-box"},Ut=["onClick"],qt={class:"text",title:"点击搜索"},Gt={class:"search-list"},Jt=Ft(()=>i("p",{class:"title"},"搜索结果：",-1)),Yt=["onClick"],Qt={title:"立即播放"},Wt={class:"search-action"},Xt=["onClick"],Zt=["onClick"],Kt=["onClick"],en=["onClick"],be=15,tn={__name:"MusicSearch",setup(n){const{useMusicStore:e}=Z(),t=P(""),s=P([]),c=P(!1),b=o=>{e.searchHistory.indexOf(o)<0&&e.searchHistory.unshift(o),L(o)};let z=P(1),M=P(!1);const L=o=>{t.value=o,c.value=!0;const r=`https://api.lolimi.cn/API/qqdg/api.php?msg=${o}&p=${z.value}&sc=${be}`;ee.get(r).then(f=>{f.data.code===1?(s.value=[...s.value,...f.data.data],f.data.data.length<be&&(M.value=!0)):M.value=!0,c.value=!1})},g=o=>{if(M.value)return;let r=o.target;r.scrollTop+r.clientHeight>=r.scrollHeight&&(z.value++,L(t.value))},H=()=>{e.searchHistory=[]},T=o=>{const r=e.searchHistory.indexOf(o);e.searchHistory.splice(r,1)},k=async(o,r)=>{const{cover:f,name:C,singer:m,url:u,content:S}=await j(o);e.musicList.push({id:se(21),cover:f,name:C,singer:m,url:u,content:S}),e.playMusic(e.musicList.length-1)},V=async(o,r)=>{const{cover:f,name:C,singer:m,url:u,content:S}=await j(o);e.musicList.push({id:se(21),cover:f,name:C,singer:m,url:u,content:S})},N=async(o,r)=>{const{cover:f,name:C,singer:m,url:u,content:S}=await j(o);e.musicList.splice(e.activeIndex+1,0,{id:se(21),cover:f,name:C,singer:m,url:u,content:S})},F=async(o,r)=>{const{url:f}=await j(o);f&&ke(f)},j=async(o,r)=>{const f=new Promise((u,S)=>{ee.get(`https://xiaoapi.cn/API/yy_sq.php?msg=${o.song}-${o.singer}&n=1`).then(I=>{I.data.code===200?u(I.data):S()})}),C=new Promise((u,S)=>{ee.get(`https://api.lolimi.cn/API/kggc/api.php?msg=${o.song}-${o.singer}&n=1`).then(I=>{I.data.code===1?u(I.data.data):S()})}),m=await Promise.all([f,C]);return{...m[0],...m[1]}};return(o,r)=>{const f=y("a-input"),C=y("a-col"),m=y("a-button"),u=y("a-row"),S=y("a-empty"),I=y("a-menu-item"),p=y("a-menu"),O=y("a-dropdown"),E=y("perfect-scrollbar"),D=y("a-spin");return v(),h("div",Et,[l(u,{gutter:12},{default:d(()=>[l(C,{span:20},{default:d(()=>[l(f,{value:t.value,"onUpdate:value":r[0]||(r[0]=_=>t.value=_),onPressEnter:r[1]||(r[1]=_=>b(_.target.value)),placeholder:"输入歌曲、歌手",allowClear:"",style:{"border-radius":"16px"}},{prefix:d(()=>[l(a(Ce))]),_:1},8,["value"])]),_:1}),l(C,{span:3},{default:d(()=>[l(m,{type:"primary",shape:"round",onClick:r[2]||(r[2]=_=>b(t.value))},{default:d(()=>[B("搜索")]),_:1})]),_:1})]),_:1}),a(e).searchHistory.length?(v(),h("div",Rt,[i("p",At,[B(" 搜索历史： "),i("span",{class:"clear",onClick:H},[l(a(Oe)),B("清空历史搜索")])]),i("div",Bt,[(v(!0),h(Q,null,W(a(e).searchHistory,(_,w)=>(v(),h("p",{key:w,onClick:$=>L(_)},[i("span",qt,x(_),1),l(a(Ne),{title:"点击移除",onClick:$e($=>T(_),["stop"])},null,8,["onClick"])],8,Ut))),128))])])):R("",!0),i("div",Gt,[Jt,l(D,{spinning:c.value,tip:"加载中..."},{default:d(()=>[l(E,{class:"scroll-bar",onPsScrollY:g},{default:d(()=>[s.value.length?R("",!0):(v(),A(S,{key:0})),i("ul",null,[(v(!0),h(Q,null,W(s.value,(_,w)=>(v(),h("li",{key:w,onClick:$=>k(_,w)},[i("p",Qt,x(_.song)+" - "+x(_.singers),1),i("div",Wt,[l(O,{placement:"bottomLeft",arrow:""},{overlay:d(()=>[l(p,null,{default:d(()=>[l(I,null,{default:d(()=>[i("a",{href:"javascript:;",onClick:$=>V(_,w)},"添加到播放列表",8,Xt)]),_:2},1024),l(I,null,{default:d(()=>[i("a",{href:"javascript:;",onClick:$=>k(_,w)},"立即播放",8,Zt)]),_:2},1024),l(I,null,{default:d(()=>[i("a",{href:"javascript:;",onClick:$=>N(_,w)},"下一首播放",8,Kt)]),_:2},1024),l(I,null,{default:d(()=>[i("a",{href:"javascript:;",onClick:$=>F(_,w)},"下载",8,en)]),_:2},1024)]),_:2},1024)]),default:d(()=>[l(a(Le))]),_:2},1024)])],8,Yt))),128))])]),_:1})]),_:1},8,["spinning"])])])}}},nn=X(tn,[["__scopeId","data-v-2f05ab74"]]);const sn=n=>(xe("data-v-ac87a071"),n=n(),Pe(),n),ln={class:"bg"},an=["src"],cn=sn(()=>i("div",{class:"mask"},null,-1)),on={class:"music-info"},rn=["src"],un={class:"progress-box"},dn={class:"prev-next"},vn={class:"mode"},mn={class:"music-list"},pn=["onClick"],fn={class:"music-cover"},gn=["src"],hn={class:"music-info"},_n={class:"music-lyric"},yn={key:0,class:"no-lyric"},bn=["onClick"],Cn={class:"action"},On={__name:"MusicFullScreen",props:{open:{type:Boolean,default:!1},musicCurrentTime:{type:Number,default:0},musicDuration:{type:Number,default:0},prevMusic:{type:String,default:""},nextMusic:{type:String,default:""},musicMode:{type:String,default:""}},emits:["close","handleDurationChange","handlePlay","handlePause","handlePrev","handleNext"],setup(n,{emit:e}){const t=n,{useMusicStore:s}=Z(),c=P(!1),b=P(null),{isFullscreen:z,toggle:M,exit:L}=He(b),g=P({});Y(()=>[s.activeIndex,s.settings.playing],()=>{g.value=s.musicList[s.activeIndex]||{}},{immediate:!0,deep:!0});const H=p=>{const O=[];return p.split(`
`).map(D=>{let _=D.match(/\[(.*?)\]/);if(_){let w=_[1];/^(0\d|1\d|2[0-3]):([0-5]\d)\.(?:\d{2})$/.test(w)&&O.push({time:w,lyric:D.replace(/\[.*?\]/g,"")})}}),O},T=te(()=>{var O,E,D;let p=[];return(E=(O=g.value)==null?void 0:O.content)!=null&&E.length?p=H((D=g.value)==null?void 0:D.content):N(),p}),k=P(0);Y(()=>t.musicCurrentTime,p=>{k.value=p},{immediate:!0,deep:!0});const V=p=>{var w;const O=K(T.value[p].time),E=K((w=T.value[p+1])==null?void 0:w.time),D=k.value>=O&&(k.value<E||!E),_=document.getElementById("lyric-list");if(D&&_){const $=_.querySelector(".active");console.log("listActive: ",$.scrollTop),_.scrollTo({top:60*p,behavior:"smooth"})}return D},N=()=>{ee.get(`https://api.lolimi.cn/API/kggc/api.php?msg=${g.value.name}-${g.value.singer}&n=1`).then(p=>{const{content:O}=p.data.data||{};p.data.code===1&&(s.musicList[s.activeIndex].content=O)})},F=()=>{L(),e("close")},j=p=>{s.playMusic(p)},o=p=>{s.changeMode(p)},r=p=>J(p),f=p=>{e("handleDurationChange",p)},C=()=>{e("handlePlay")},m=()=>{e("handlePause")},u=()=>{e("handlePrev")},S=()=>{e("handleNext")},I=(p,O)=>{e("handleDurationChange",K(p.time))};return(p,O)=>{const E=y("a-slider"),D=y("a-tooltip"),_=y("perfect-scrollbar"),w=y("a-popover");return v(),h("div",{ref_key:"fullscreenRef",ref:b,class:U(["music-fullscreen",{open:n.open}])},[i("div",ln,[i("img",{src:g.value.cover,alt:""},null,8,an),cn]),i("div",on,[i("img",{class:U(["cover",{playing:c.value||a(s).settings.playing}]),onClick:O[0]||(O[0]=$=>c.value=!c.value),src:g.value.cover,alt:""},null,10,rn),i("p",null,x(g.value.name),1),i("span",null,x(g.value.singer),1),i("div",un,[i("p",null,x(a(J)(k.value)),1),l(E,{class:"play-slider",min:0,max:n.musicDuration,onChange:f,value:k.value,"onUpdate:value":O[1]||(O[1]=$=>k.value=$),tipFormatter:r},null,8,["max","value"]),i("p",null,x(a(J)(n.musicDuration)),1)]),i("div",dn,[i("div",vn,[l(D,{title:n.musicMode},{default:d(()=>[a(s).settings.mode==="listCycle"?(v(),h("i",{key:0,class:"ifishfont ifish-musicListLoop",title:"列表循环",onClick:O[2]||(O[2]=$=>o("singleCycle"))})):R("",!0),a(s).settings.mode==="singleCycle"?(v(),h("i",{key:1,class:"ifishfont ifish-musicSingleCycle",title:"单曲循环",onClick:O[3]||(O[3]=$=>o("randomPlay"))})):R("",!0),a(s).settings.mode==="randomPlay"?(v(),h("i",{key:2,class:"ifishfont ifish-musicRandomPlay",title:"随机播放",onClick:O[4]||(O[4]=$=>o("listCycle"))})):R("",!0)]),_:1},8,["title"])]),l(D,{title:`上一首${n.prevMusic?"：":""}${n.prevMusic}`},{default:d(()=>[l(a(ze),{onClick:u})]),_:1},8,["title"]),l(D,{title:a(s).settings.playing?"点击暂停":"点击播放"},{default:d(()=>[a(s).settings.playing?(v(),A(a(Ie),{key:1,class:"pause",onClick:m})):(v(),A(a(De),{key:0,class:"play",onClick:C}))]),_:1},8,["title"]),l(D,{title:`下一首${n.nextMusic?"：":""}${n.nextMusic}`},{default:d(()=>[l(a(je),{onClick:S})]),_:1},8,["title"]),l(w,{title:"播放列表",placement:"rightBottom"},{content:d(()=>[l(_,{class:"scroll-music"},{default:d(()=>[i("div",mn,[(v(!0),h(Q,null,W(a(s).musicList,($,G)=>(v(),h("div",{class:U(["music-item",{active:a(s).activeIndex===G}]),key:G,onClick:Te=>j(G)},[i("div",fn,[i("img",{src:$.cover,onerror:"this.src='./images/music.png'",alt:""},null,8,gn)]),i("div",hn,[i("p",null,x($.name),1),i("span",null,x($.singer),1)])],10,pn))),128))])]),_:1})]),default:d(()=>[l(a(we))]),_:1})])]),i("div",_n,[T.value.length?R("",!0):(v(),h("p",yn,"暂无歌词")),l(_,{class:"scroll-bar",id:"lyric-list"},{default:d(()=>[(v(!0),h(Q,null,W(T.value,($,G)=>(v(),h("p",{class:U({active:V(G)}),key:G,onClick:Te=>I($,G)},[Me(i("span",null,x(a(K)($.time)),513),[[Se,!1]]),B(" "+x($.lyric),1)],10,bn))),128))]),_:1})]),i("div",Cn,[l(a(Ve),{class:"close",title:"关闭歌词",onClick:F}),a(z)?(v(),A(a(qe),{key:0,title:"关闭全屏",onClick:a(M)},null,8,["onClick"])):(v(),A(a(Qe),{key:1,title:"开启全屏",onClick:a(M)},null,8,["onClick"]))])],2)}}},$n=X(On,[["__scopeId","data-v-ac87a071"]]);const Ln={class:"music"},xn=["src","loop"],Pn=["title"],Mn={__name:"Index",setup(n){const{useMusicStore:e}=Z();Fe(()=>{e.settings.playing=!1});const t=P(!1),s=P(!1),c=P(!1),b=P(null),z=P({});Y(()=>[e.activeIndex,e.settings.playing],()=>{z.value=e.musicList[e.activeIndex]||{},ne(()=>{b.value&&(L.value=parseInt(b.value.duration),b.value.volume=e.settings.volume/100,e.settings.playing&&b.value.play())})},{immediate:!0,deep:!0}),Y(()=>[e.settings.volume,e.settings.mute],()=>{b.value&&ne(()=>{b.value.volume=e.settings.volume/100,b.value.muted=e.settings.mute})},{immediate:!0,deep:!0});const M=P(0),L=P(1e3),g=()=>{L.value=parseInt(b.value.duration),M.value=b.value.currentTime=e.settings.currentTime},H=m=>{const{currentTime:u,duration:S}=m.target;M.value=e.settings.currentTime=parseInt(u),L.value=parseInt(S)},T=()=>{e.toggleVisible()},k=()=>{!e.musicList.length||e.activeIndex<0||(e.settings.playing=!0,b.value.play())},V=()=>{!e.musicList.length||e.activeIndex<0||(e.settings.playing=!1,b.value.pause())},N=te(()=>{if(!e.musicList.length||e.activeIndex<0)return"";let m=e.activeIndex===0?e.musicList.length-1:e.activeIndex-1;return e.musicList[m]?e.musicList[m].name:""}),F=()=>{if(!e.musicList.length||e.activeIndex<0)return;let m=e.activeIndex===0?e.musicList.length-1:e.activeIndex-1;e.playMusic(m)},j=te(()=>{if(!e.musicList.length||e.activeIndex<0)return"";let m=e.activeIndex===e.musicList.length-1?0:e.activeIndex+1;return e.musicList[m]?e.musicList[m].name:""}),o=()=>{if(!e.musicList.length||e.activeIndex<0)return;let m=e.activeIndex===e.musicList.length-1?0:e.activeIndex+1;e.playMusic(m)},r=()=>{e.settings.mode==="listCycle"?(e.musicList.length===1&&(e.activeIndex--,e.activeIndex++),o()):e.settings.mode==="singleCycle"?e.playMusic(e.activeIndex):e.settings.mode==="randomPlay"&&e.playMusic(Re(0,e.musicList.length-1,e.activeIndex))},f=m=>{e.settings.currentTime=m,b.value&&ne(()=>{b.value.currentTime=m})},C=te(()=>({listCycle:"列表循环",singleCycle:"单曲循环",randomPlay:"随机播放"})[e.settings.mode]);return(m,u)=>{var I;const S=y("IDialog");return v(),h("div",Ln,[Me(i("audio",{ref_key:"audioRef",ref:b,controls:"",src:(I=z.value)==null?void 0:I.url,loop:a(e).settings.mode==="singleCycle",onTimeupdate:H,onLoadeddata:g,onEnded:r,onError:r},null,40,xn),[[Se,!1]]),i("div",{class:U(["toggle-icon bf",[a(e).visible?"down":"up"]]),title:a(e).visible?"隐藏播放器":"显示播放器",onClick:T},[l(a(Ee))],10,Pn),i("div",{class:U(["music-ctrl bf",[a(e).visible?"show":""]])},[l(Pt,{musicCurrentTime:M.value,musicDuration:L.value,prevMusic:N.value,nextMusic:j.value,musicMode:C.value,onShowSearch:u[0]||(u[0]=p=>s.value=!0),onToggleMusicList:u[1]||(u[1]=p=>t.value=!t.value),onShowLyric:u[2]||(u[2]=p=>c.value=!0),onHandlePlay:k,onHandlePause:V,onHandlePrev:F,onHandleNext:o,onHandleDurationChange:f},null,8,["musicCurrentTime","musicDuration","prevMusic","nextMusic","musicMode"])],2),l(Vt,{open:t.value,onShowSearch:u[3]||(u[3]=p=>s.value=!0),onClose:u[4]||(u[4]=p=>t.value=!1)},null,8,["open"]),l(S,{title:"搜索音乐",visible:s.value,zIndex:1002,onOk:u[5]||(u[5]=p=>s.value=!1),onCancel:u[6]||(u[6]=p=>s.value=!1)},{default:d(()=>[l(nn)]),_:1},8,["visible"]),l($n,{open:c.value,musicCurrentTime:M.value,musicDuration:L.value,prevMusic:N.value,nextMusic:j.value,musicMode:C.value,onClose:u[7]||(u[7]=p=>c.value=!1),onHandlePlay:k,onHandlePause:V,onHandlePrev:F,onHandleNext:o,onHandleDurationChange:f},null,8,["open","musicCurrentTime","musicDuration","prevMusic","nextMusic","musicMode"])])}}},wn=X(Mn,[["__scopeId","data-v-20054128"]]);export{wn as default};
