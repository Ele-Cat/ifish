import{q as C,E as S,b as o,w as x,r as l,h as c,i as w,s as u,D as B,B as E,j as s,k as i,F as y,t as N,C as U,z as g,M as j,N as q}from"./index-01bd0d93.js";import{_ as O,u as z,c as A}from"./App-738f8d73.js";const F=m=>(j("data-v-443080aa"),m=m(),q(),m),$={class:"offwork-text"},L={key:0},M=F(()=>u("img",{src:"https://i.postimg.cc/pVzqwjn0/qipao.png",alt:""},null,-1)),R={__name:"OffWorkCountdown",setup(m){const{useAppStore:t}=z(),k=C(!1),H=S(["周日","周一","周二","周三","周四","周五","周六"]),r=S({workDays:t.offWorkCountdown.workDays,workTimeStart:t.offWorkCountdown.workTimeStart?o(t.offWorkCountdown.workTimeStart,"HH:mm"):null,workTimeEnd:t.offWorkCountdown.workTimeEnd?o(t.offWorkCountdown.workTimeEnd,"HH:mm"):null}),d=C("");let p=null;const W=()=>{p&&clearInterval(p)};return x(()=>r,a=>{let e="点击配置";console.log("newVal.workTimeEnd: ",a.workTimeEnd),W(),a.workTimeEnd?(t.offWorkCountdown.workTimeStart=o(a.workTimeStart).format("HH:mm"),t.offWorkCountdown.workTimeEnd=o(a.workTimeEnd).format("HH:mm"),t.offWorkCountdown.workDays[o().day()]?o().isBefore(o(a.workTimeStart))?e="还没上班呢~":o().isAfter(o(a.workTimeEnd))?e="已经下班啦~":p=setInterval(()=>{const _=o(a.workTimeEnd),f=o();e=_.diff(f),d.value=A(e)},1e3):e="今天是休息日~"):t.offWorkCountdown.workTimeEnd=null,a.workTimeStart||(t.offWorkCountdown.workTimeStart=null),d.value=e},{immediate:!0,deep:!0}),(a,e)=>{const _=l("a-checkable-tag"),f=l("a-form-item"),v=l("a-time-picker"),h=l("a-space"),D=l("a-form"),b=l("IDialog");return c(),w(y,null,[u("div",{class:"offwork",onClick:e[0]||(e[0]=n=>k.value=!0)},[u("div",$,[d.value.includes(":")?(c(),w("p",L,"距离下班时间还有")):B("",!0),u("p",null,E(d.value),1)]),M]),s(b,{title:"配置",width:480,visible:k.value,onCancel:e[3]||(e[3]=n=>k.value=!1)},{default:i(()=>[s(D,{model:r,layout:"vertical",style:{"padding-top":"20px"}},{default:i(()=>[s(f,{label:"选择工作日"},{default:i(()=>[(c(!0),w(y,null,N(H,(n,T)=>(c(),U(_,{key:n,checked:r.workDays[T],"onUpdate:checked":I=>r.workDays[T]=I},{default:i(()=>[g(E(n),1)]),_:2},1032,["checked","onUpdate:checked"]))),128))]),_:1}),s(f,{label:"上下班时间"},{default:i(()=>[s(h,null,{default:i(()=>[s(v,{value:r.workTimeStart,"onUpdate:value":e[1]||(e[1]=n=>r.workTimeStart=n),placeholder:"上班时间","minute-step":10,format:"HH:mm"},null,8,["value"]),g("~ "),s(v,{value:r.workTimeEnd,"onUpdate:value":e[2]||(e[2]=n=>r.workTimeEnd=n),placeholder:"下班时间","minute-step":10,format:"HH:mm"},null,8,["value"])]),_:1})]),_:1})]),_:1},8,["model"])]),_:1},8,["visible"])],64)}}},K=O(R,[["__scopeId","data-v-443080aa"]]);export{K as default};
