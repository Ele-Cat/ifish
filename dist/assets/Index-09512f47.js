import{c as l,A as G,_ as te,u as K,r as x,w as Y,a as C,o as d,b,d as a,e as U,f as i,n as q,t as P,g as u,h as B,i as R,S as Oe,D as $e,F as X,j as Z,k as Le,E as xe,C as je,l as W,p as ze,m as Te,q as Ne,s as ee,v as He,x as Ve,y as ne,z as Ee,B as Fe,G as Re}from"./index-33672e0d.js";import{s as Q,d as Pe,u as se,m as le,g as Ae}from"./utils-7dc22624.js";var Be={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M391 240.9c-.8-6.6-8.9-9.4-13.6-4.7l-43.7 43.7L200 146.3a8.03 8.03 0 00-11.3 0l-42.4 42.3a8.03 8.03 0 000 11.3L280 333.6l-43.9 43.9a8.01 8.01 0 004.7 13.6L401 410c5.1.6 9.5-3.7 8.9-8.9L391 240.9zm10.1 373.2L240.8 633c-6.6.8-9.4 8.9-4.7 13.6l43.9 43.9L146.3 824a8.03 8.03 0 000 11.3l42.4 42.3c3.1 3.1 8.2 3.1 11.3 0L333.7 744l43.7 43.7A8.01 8.01 0 00391 783l18.9-160.1c.6-5.1-3.7-9.4-8.8-8.8zm221.8-204.2L783.2 391c6.6-.8 9.4-8.9 4.7-13.6L744 333.6 877.7 200c3.1-3.1 3.1-8.2 0-11.3l-42.4-42.3a8.03 8.03 0 00-11.3 0L690.3 279.9l-43.7-43.7a8.01 8.01 0 00-13.6 4.7L614.1 401c-.6 5.2 3.7 9.5 8.8 8.9zM744 690.4l43.9-43.9a8.01 8.01 0 00-4.7-13.6L623 614c-5.1-.6-9.5 3.7-8.9 8.9L633 783.1c.8 6.6 8.9 9.4 13.6 4.7l43.7-43.7L824 877.7c3.1 3.1 8.2 3.1 11.3 0l42.4-42.3c3.1-3.1 3.1-8.2 0-11.3L744 690.4z"}}]},name:"fullscreen-exit",theme:"outlined"};const Ue=Be;function me(s){for(var e=1;e<arguments.length;e++){var t=arguments[e]!=null?Object(arguments[e]):{},n=Object.keys(t);typeof Object.getOwnPropertySymbols=="function"&&(n=n.concat(Object.getOwnPropertySymbols(t).filter(function(c){return Object.getOwnPropertyDescriptor(t,c).enumerable}))),n.forEach(function(c){qe(s,c,t[c])})}return s}function qe(s,e,t){return e in s?Object.defineProperty(s,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):s[e]=t,s}var ie=function(e,t){var n=me({},e,t.attrs);return l(G,me({},n,{icon:Ue}),null)};ie.displayName="FullscreenExitOutlined";ie.inheritAttrs=!1;const Ge=ie;var Je={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M290 236.4l43.9-43.9a8.01 8.01 0 00-4.7-13.6L169 160c-5.1-.6-9.5 3.7-8.9 8.9L179 329.1c.8 6.6 8.9 9.4 13.6 4.7l43.7-43.7L370 423.7c3.1 3.1 8.2 3.1 11.3 0l42.4-42.3c3.1-3.1 3.1-8.2 0-11.3L290 236.4zm352.7 187.3c3.1 3.1 8.2 3.1 11.3 0l133.7-133.6 43.7 43.7a8.01 8.01 0 0013.6-4.7L863.9 169c.6-5.1-3.7-9.5-8.9-8.9L694.8 179c-6.6.8-9.4 8.9-4.7 13.6l43.9 43.9L600.3 370a8.03 8.03 0 000 11.3l42.4 42.4zM845 694.9c-.8-6.6-8.9-9.4-13.6-4.7l-43.7 43.7L654 600.3a8.03 8.03 0 00-11.3 0l-42.4 42.3a8.03 8.03 0 000 11.3L734 787.6l-43.9 43.9a8.01 8.01 0 004.7 13.6L855 864c5.1.6 9.5-3.7 8.9-8.9L845 694.9zm-463.7-94.6a8.03 8.03 0 00-11.3 0L236.3 733.9l-43.7-43.7a8.01 8.01 0 00-13.6 4.7L160.1 855c-.6 5.1 3.7 9.5 8.9 8.9L329.2 845c6.6-.8 9.4-8.9 4.7-13.6L290 787.6 423.7 654c3.1-3.1 3.1-8.2 0-11.3l-42.4-42.4z"}}]},name:"fullscreen",theme:"outlined"};const Ye=Je;function pe(s){for(var e=1;e<arguments.length;e++){var t=arguments[e]!=null?Object(arguments[e]):{},n=Object.keys(t);typeof Object.getOwnPropertySymbols=="function"&&(n=n.concat(Object.getOwnPropertySymbols(t).filter(function(c){return Object.getOwnPropertyDescriptor(t,c).enumerable}))),n.forEach(function(c){Qe(s,c,t[c])})}return s}function Qe(s,e,t){return e in s?Object.defineProperty(s,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):s[e]=t,s}var ae=function(e,t){var n=pe({},e,t.attrs);return l(G,pe({},n,{icon:Ye}),null)};ae.displayName="FullscreenOutlined";ae.inheritAttrs=!1;const We=ae;var Xe={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M408 442h480c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8H408c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8zm-8 204c0 4.4 3.6 8 8 8h480c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8H408c-4.4 0-8 3.6-8 8v56zm504-486H120c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8h784c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8zm0 632H120c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8h784c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8zM142.4 642.1L298.7 519a8.84 8.84 0 000-13.9L142.4 381.9c-5.8-4.6-14.4-.5-14.4 6.9v246.3a8.9 8.9 0 0014.4 7z"}}]},name:"menu-unfold",theme:"outlined"};const Ze=Xe;function fe(s){for(var e=1;e<arguments.length;e++){var t=arguments[e]!=null?Object(arguments[e]):{},n=Object.keys(t);typeof Object.getOwnPropertySymbols=="function"&&(n=n.concat(Object.getOwnPropertySymbols(t).filter(function(c){return Object.getOwnPropertyDescriptor(t,c).enumerable}))),n.forEach(function(c){Ke(s,c,t[c])})}return s}function Ke(s,e,t){return e in s?Object.defineProperty(s,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):s[e]=t,s}var ce=function(e,t){var n=fe({},e,t.attrs);return l(G,fe({},n,{icon:Ze}),null)};ce.displayName="MenuUnfoldOutlined";ce.inheritAttrs=!1;const Me=ce;var et={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M512 64C264.6 64 64 264.6 64 512s200.6 448 448 448 448-200.6 448-448S759.4 64 512 64zm0 820c-205.4 0-372-166.6-372-372s166.6-372 372-372 372 166.6 372 372-166.6 372-372 372zm-88-532h-48c-4.4 0-8 3.6-8 8v304c0 4.4 3.6 8 8 8h48c4.4 0 8-3.6 8-8V360c0-4.4-3.6-8-8-8zm224 0h-48c-4.4 0-8 3.6-8 8v304c0 4.4 3.6 8 8 8h48c4.4 0 8-3.6 8-8V360c0-4.4-3.6-8-8-8z"}}]},name:"pause-circle",theme:"outlined"};const tt=et;function ge(s){for(var e=1;e<arguments.length;e++){var t=arguments[e]!=null?Object(arguments[e]):{},n=Object.keys(t);typeof Object.getOwnPropertySymbols=="function"&&(n=n.concat(Object.getOwnPropertySymbols(t).filter(function(c){return Object.getOwnPropertyDescriptor(t,c).enumerable}))),n.forEach(function(c){nt(s,c,t[c])})}return s}function nt(s,e,t){return e in s?Object.defineProperty(s,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):s[e]=t,s}var oe=function(e,t){var n=ge({},e,t.attrs);return l(G,ge({},n,{icon:tt}),null)};oe.displayName="PauseCircleOutlined";oe.inheritAttrs=!1;const Se=oe;var st={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M512 64C264.6 64 64 264.6 64 512s200.6 448 448 448 448-200.6 448-448S759.4 64 512 64zm0 820c-205.4 0-372-166.6-372-372s166.6-372 372-372 372 166.6 372 372-166.6 372-372 372z"}},{tag:"path",attrs:{d:"M719.4 499.1l-296.1-215A15.9 15.9 0 00398 297v430c0 13.1 14.8 20.5 25.3 12.9l296.1-215a15.9 15.9 0 000-25.8zm-257.6 134V390.9L628.5 512 461.8 633.1z"}}]},name:"play-circle",theme:"outlined"};const lt=st;function he(s){for(var e=1;e<arguments.length;e++){var t=arguments[e]!=null?Object(arguments[e]):{},n=Object.keys(t);typeof Object.getOwnPropertySymbols=="function"&&(n=n.concat(Object.getOwnPropertySymbols(t).filter(function(c){return Object.getOwnPropertyDescriptor(t,c).enumerable}))),n.forEach(function(c){it(s,c,t[c])})}return s}function it(s,e,t){return e in s?Object.defineProperty(s,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):s[e]=t,s}var re=function(e,t){var n=he({},e,t.attrs);return l(G,he({},n,{icon:lt}),null)};re.displayName="PlayCircleOutlined";re.inheritAttrs=!1;const ke=re;var at={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M912 192H328c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8h584c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8zm0 284H328c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8h584c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8zm0 284H328c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8h584c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8zM104 228a56 56 0 10112 0 56 56 0 10-112 0zm0 284a56 56 0 10112 0 56 56 0 10-112 0zm0 284a56 56 0 10112 0 56 56 0 10-112 0z"}}]},name:"unordered-list",theme:"outlined"};const ct=at;function _e(s){for(var e=1;e<arguments.length;e++){var t=arguments[e]!=null?Object(arguments[e]):{},n=Object.keys(t);typeof Object.getOwnPropertySymbols=="function"&&(n=n.concat(Object.getOwnPropertySymbols(t).filter(function(c){return Object.getOwnPropertyDescriptor(t,c).enumerable}))),n.forEach(function(c){ot(s,c,t[c])})}return s}function ot(s,e,t){return e in s?Object.defineProperty(s,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):s[e]=t,s}var ue=function(e,t){var n=_e({},e,t.attrs);return l(G,_e({},n,{icon:ct}),null)};ue.displayName="UnorderedListOutlined";ue.inheritAttrs=!1;const rt=ue;var ut={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M762 164h-64c-4.4 0-8 3.6-8 8v688c0 4.4 3.6 8 8 8h64c4.4 0 8-3.6 8-8V172c0-4.4-3.6-8-8-8zm-508 0v72.4c0 9.5 4.2 18.4 11.4 24.5L564.6 512 265.4 763.1c-7.2 6.1-11.4 15-11.4 24.5V860c0 6.8 7.9 10.5 13.1 6.1L689 512 267.1 157.9A7.95 7.95 0 00254 164z"}}]},name:"vertical-left",theme:"outlined"};const dt=ut;function ye(s){for(var e=1;e<arguments.length;e++){var t=arguments[e]!=null?Object(arguments[e]):{},n=Object.keys(t);typeof Object.getOwnPropertySymbols=="function"&&(n=n.concat(Object.getOwnPropertySymbols(t).filter(function(c){return Object.getOwnPropertyDescriptor(t,c).enumerable}))),n.forEach(function(c){vt(s,c,t[c])})}return s}function vt(s,e,t){return e in s?Object.defineProperty(s,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):s[e]=t,s}var de=function(e,t){var n=ye({},e,t.attrs);return l(G,ye({},n,{icon:dt}),null)};de.displayName="VerticalLeftOutlined";de.inheritAttrs=!1;const we=de;var mt={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M326 164h-64c-4.4 0-8 3.6-8 8v688c0 4.4 3.6 8 8 8h64c4.4 0 8-3.6 8-8V172c0-4.4-3.6-8-8-8zm444 72.4V164c0-6.8-7.9-10.5-13.1-6.1L335 512l421.9 354.1c5.2 4.4 13.1.7 13.1-6.1v-72.4c0-9.4-4.2-18.4-11.4-24.5L459.4 512l299.2-251.1c7.2-6.1 11.4-15.1 11.4-24.5z"}}]},name:"vertical-right",theme:"outlined"};const pt=mt;function be(s){for(var e=1;e<arguments.length;e++){var t=arguments[e]!=null?Object(arguments[e]):{},n=Object.keys(t);typeof Object.getOwnPropertySymbols=="function"&&(n=n.concat(Object.getOwnPropertySymbols(t).filter(function(c){return Object.getOwnPropertyDescriptor(t,c).enumerable}))),n.forEach(function(c){ft(s,c,t[c])})}return s}function ft(s,e,t){return e in s?Object.defineProperty(s,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):s[e]=t,s}var ve=function(e,t){var n=be({},e,t.attrs);return l(G,be({},n,{icon:pt}),null)};ve.displayName="VerticalRightOutlined";ve.inheritAttrs=!1;const Ie=ve;const gt={class:"music-box"},ht={key:0,class:"info"},_t={key:1,class:"info"},yt=["src"],bt={class:"center"},Ct={class:"prev-next"},Ot={class:"progress-box"},$t={class:"ctrl"},Lt=["title"],xt={class:"mode"},Pt={__name:"MusicCtrl",props:{musicCurrentTime:{type:Number,default:0},musicDuration:{type:Number,default:0},prevMusic:{type:String,default:""},nextMusic:{type:String,default:""},musicMode:{type:String,default:""}},emits:["toggleMusicList","showSearch","handleDurationChange","handlePlay","handlePause","handlePrev","handleNext","showLyric"],setup(s,{emit:e}){const t=s,{useMusicStore:n}=K(),c=x(0);Y(()=>t.musicCurrentTime,r=>{c.value=r},{immediate:!0,deep:!0});const j=()=>{e("toggleMusicList")},O=()=>{e("showSearch")},k=r=>{n.changeMode(r)},M=r=>{n.toggleMute(r)},g=x({});Y(()=>[n.activeIndex,n.settings.playing],()=>{g.value=n.musicList[n.activeIndex]||{}},{immediate:!0,deep:!0});const E=r=>Q(r),T=r=>{e("handleDurationChange",r)},w=()=>{e("handlePlay")},V=()=>{e("handlePause")},N=()=>{e("handlePrev")},F=()=>{e("handleNext")},z=()=>{e("showLyric")};return(r,o)=>{const h=C("a-tooltip"),$=C("a-slider"),L=C("a-divider");return d(),b("div",gt,[a(n).musicList.length?(d(),b("div",_t,[i("div",{class:"cover",onClick:z},[i("img",{class:q({playing:a(n).settings.playing}),src:g.value.cover,onerror:"this.src='./images/music.png'",alt:""},null,10,yt)]),U(" "+P(g.value.name)+" - "+P(g.value.singer),1)])):(d(),b("div",ht,[U(" 暂无音乐，请选择"),i("span",{class:"add",onClick:O},"添加")])),i("div",bt,[i("div",Ct,[l(h,{title:`上一首${s.prevMusic?"：":""}${s.prevMusic}`},{default:u(()=>[l(a(Ie),{onClick:N})]),_:1},8,["title"]),l(h,{title:a(n).settings.playing?"点击暂停":"点击播放"},{default:u(()=>[a(n).settings.playing?(d(),B(a(Se),{key:1,class:"pause",onClick:V})):(d(),B(a(ke),{key:0,class:"play",onClick:w}))]),_:1},8,["title"]),l(h,{title:`下一首${s.nextMusic?"：":""}${s.nextMusic}`},{default:u(()=>[l(a(we),{onClick:F})]),_:1},8,["title"])]),i("div",Ot,[i("p",null,P(a(Q)(c.value)),1),l($,{class:"play-slider",min:0,max:s.musicDuration,onChange:T,value:c.value,"onUpdate:value":o[0]||(o[0]=y=>c.value=y),tipFormatter:E},null,8,["max","value"]),i("p",null,P(a(Q)(s.musicDuration)),1)])]),i("div",$t,[i("div",{class:"volume",title:`当前音量：${a(n).settings.volume}`},[a(n).settings.mute||a(n).settings.volume===0?(d(),b("i",{key:0,class:"ifishfont ifish-volumeDisable",onClick:o[1]||(o[1]=y=>M(!0))})):a(n).settings.volume>=0&&a(n).settings.volume<30?(d(),b("i",{key:1,class:"ifishfont ifish-volumeLow",onClick:o[2]||(o[2]=y=>M(!1))})):a(n).settings.volume>=30&&a(n).settings.volume<60?(d(),b("i",{key:2,class:"ifishfont ifish-volumeMiddle",onClick:o[3]||(o[3]=y=>M(!1))})):(d(),b("i",{key:3,class:"ifishfont ifish-volumeHigh",onClick:o[4]||(o[4]=y=>M(!1))})),l($,{class:"volume-slider",min:0,max:100,value:a(n).settings.volume,"onUpdate:value":o[5]||(o[5]=y=>a(n).settings.volume=y)},null,8,["value"])],8,Lt),i("div",xt,[l(h,{title:s.musicMode},{default:u(()=>[a(n).settings.mode==="listCycle"?(d(),b("i",{key:0,class:"ifishfont ifish-musicListLoop",title:"列表循环",onClick:o[6]||(o[6]=y=>k("singleCycle"))})):R("",!0),a(n).settings.mode==="singleCycle"?(d(),b("i",{key:1,class:"ifishfont ifish-musicSingleCycle",title:"单曲循环",onClick:o[7]||(o[7]=y=>k("randomPlay"))})):R("",!0),a(n).settings.mode==="randomPlay"?(d(),b("i",{key:2,class:"ifishfont ifish-musicRandomPlay",title:"随机播放",onClick:o[8]||(o[8]=y=>k("listCycle"))})):R("",!0)]),_:1},8,["title"])]),l(L,{type:"vertical"}),l(h,{title:"播放列表",placement:"topRight"},{default:u(()=>[l(a(Me),{onClick:j})]),_:1})])])}}},Mt=te(Pt,[["__scopeId","data-v-bf59f9b2"]]);const St={class:"music-box"},kt={class:"title"},wt={class:"music-list"},It=["onClick"],Dt={class:"music-cover"},jt=["src"],zt={class:"music-info"},Tt=["onClick"],Nt=["onClick"],Ht=["onClick"],Vt={__name:"MusicList",props:{open:{type:Boolean,default:!1}},emits:["close","showSearch"],setup(s,{emit:e}){const{useMusicStore:t}=K(),n=()=>{e("close")},c=()=>{e("showSearch")},j=()=>{t.musicList=[]},O=g=>{t.playMusic(g)},k=g=>{g<t.activeIndex?(t.musicList.splice(g,1),t.activeIndex--):(g===t.activeIndex&&(t.settings.currentTime=0,t.activeIndex===t.musicList.length-1&&(t.activeIndex=0),t.activeIndex++,t.activeIndex--),t.musicList.splice(g,1))},M=g=>{Pe(g.url)};return(g,E)=>{const T=C("a-input"),w=C("a-popconfirm"),V=C("a-empty"),N=C("a-menu-item"),F=C("a-menu"),z=C("a-dropdown"),r=C("perfect-scrollbar"),o=C("a-drawer");return d(),B(o,{width:"360px",title:"播放列表",placement:"right",open:s.open,onClose:n,rootClassName:"disclaimers-root"},{default:u(()=>[i("div",St,[l(T,{onClick:c,readonly:"",placeholder:"搜索",style:{"border-radius":"20px"}},{prefix:u(()=>[l(a(Oe))]),_:1}),i("div",null,[i("p",kt,[i("span",null,[l(a(rt)),U("播放列表（共 "+P(a(t).musicList.length)+" 首）",1)]),l(w,{title:"确认清空列表？",onConfirm:j},{default:u(()=>[i("span",null,[l(a($e)),U("清空列表")])]),_:1})]),a(t).musicList.length?R("",!0):(d(),B(V,{key:0,class:"list-empty"},{description:u(()=>[i("span",{class:"description"},[U(" 暂无歌曲，请"),i("a",{onClick:c},"搜索添加")])]),_:1})),l(r,{class:"scroll-bar"},{default:u(()=>[i("div",wt,[(d(!0),b(X,null,Z(a(t).musicList,(h,$)=>(d(),b("div",{class:q(["music-item",{active:a(t).activeIndex===$}]),key:$,onClick:L=>O($)},[i("div",Dt,[i("img",{src:h.cover,onerror:"this.src='./images/music.png'",alt:""},null,8,jt)]),i("div",zt,[i("p",null,P(h.name),1),i("span",null,P(h.singer),1)]),i("div",{class:"music-action",onClick:E[0]||(E[0]=Le(()=>{},["stop"]))},[l(z,{placement:"bottomLeft",arrow:""},{overlay:u(()=>[l(F,null,{default:u(()=>[l(N,null,{default:u(()=>[i("a",{href:"javascript:;",onClick:L=>O($)},"播放",8,Tt)]),_:2},1024),l(N,null,{default:u(()=>[i("a",{href:"javascript:;",onClick:L=>k($)},"移除",8,Nt)]),_:2},1024),l(N,null,{default:u(()=>[i("a",{href:"javascript:;",onClick:L=>M(h)},"下载",8,Ht)]),_:2},1024)]),_:2},1024)]),default:u(()=>[l(a(xe))]),_:2},1024)])],10,It))),128))])]),_:1})])])]),_:1},8,["open"])}}},Et=te(Vt,[["__scopeId","data-v-5a8bf248"]]);const Ft=s=>(ze("data-v-5ada0861"),s=s(),Te(),s),Rt={class:"search"},At={key:0,class:"search-history"},Bt={class:"title"},Ut={class:"search-history-box"},qt=["onClick"],Gt={class:"text",title:"点击搜索"},Jt={class:"search-list"},Yt=Ft(()=>i("p",{class:"title"},"搜索结果：",-1)),Qt=["onClick"],Wt={title:"立即播放"},Xt={class:"search-action"},Zt=["onClick"],Kt=["onClick"],en=["onClick"],tn=["onClick"],Ce=15,nn={__name:"MusicSearch",setup(s){const{useMusicStore:e}=K(),t=x(""),n=x([]),c=x(!1),j=r=>{e.searchHistory.indexOf(r)<0&&e.searchHistory.unshift(r),M(r)};let O=x(1),k=x(!1);const M=r=>{t.value=r,c.value=!0;const o=`https://api.lolimi.cn/API/qqdg/api.php?msg=${r}&p=${O.value}&sc=${Ce}`;W.get(o).then(h=>{h.data.code===1?(n.value=[...n.value,...h.data.data],h.data.data.length<Ce&&(k.value=!0)):k.value=!0,c.value=!1})},g=r=>{if(k.value)return;let o=r.target;o.scrollTop+o.clientHeight>=o.scrollHeight&&(O.value++,M(t.value))},E=()=>{e.searchHistory=[]},T=r=>{const o=e.searchHistory.indexOf(r);e.searchHistory.splice(o,1)},w=async(r,o)=>{const{cover:h,name:$,singer:L,url:y,content:m}=await z(r);e.musicList.push({id:se(21),cover:h,name:$,singer:L,url:y,content:m}),e.playMusic(e.musicList.length-1)},V=async(r,o)=>{const{cover:h,name:$,singer:L,url:y,content:m}=await z(r);e.musicList.push({id:se(21),cover:h,name:$,singer:L,url:y,content:m})},N=async(r,o)=>{const{cover:h,name:$,singer:L,url:y,content:m}=await z(r);e.musicList.splice(e.activeIndex+1,0,{id:se(21),cover:h,name:$,singer:L,url:y,content:m})},F=async(r,o)=>{const{url:h}=await z(r);h&&Pe(h)},z=async(r,o)=>{const h=new Promise((y,m)=>{W.get(`https://xiaoapi.cn/API/yy_sq.php?msg=${r.song}-${r.singer}&n=1`).then(p=>{p.data.code===200?y(p.data):y({})})}),$=new Promise((y,m)=>{W.get(`https://api.lolimi.cn/API/kggc/api.php?msg=${r.song}-${r.singer}&n=1`).then(p=>{p.data.code===1?y(p.data.data):y({})})}),L=await Promise.all([h,$]);return{...L[0],...L[1]}};return(r,o)=>{const h=C("a-input"),$=C("a-col"),L=C("a-button"),y=C("a-row"),m=C("a-empty"),p=C("a-menu-item"),H=C("a-menu"),v=C("a-dropdown"),f=C("perfect-scrollbar"),A=C("a-spin");return d(),b("div",Rt,[l(y,{gutter:12},{default:u(()=>[l($,{span:20},{default:u(()=>[l(h,{value:t.value,"onUpdate:value":o[0]||(o[0]=_=>t.value=_),onPressEnter:o[1]||(o[1]=_=>j(_.target.value)),placeholder:"输入歌曲、歌手",allowClear:"",style:{"border-radius":"16px"}},{prefix:u(()=>[l(a(Oe))]),_:1},8,["value"])]),_:1}),l($,{span:3},{default:u(()=>[l(L,{type:"primary",shape:"round",onClick:o[2]||(o[2]=_=>j(t.value))},{default:u(()=>[U("搜索")]),_:1})]),_:1})]),_:1}),a(e).searchHistory.length?(d(),b("div",At,[i("p",Bt,[U(" 搜索历史： "),i("span",{class:"clear",onClick:E},[l(a($e)),U("清空历史搜索")])]),i("div",Ut,[(d(!0),b(X,null,Z(a(e).searchHistory,(_,S)=>(d(),b("p",{key:S,onClick:I=>M(_)},[i("span",Gt,P(_),1),l(a(je),{title:"点击移除",onClick:Le(I=>T(_),["stop"])},null,8,["onClick"])],8,qt))),128))])])):R("",!0),i("div",Jt,[Yt,l(A,{spinning:c.value,tip:"加载中..."},{default:u(()=>[l(f,{class:"scroll-bar",onPsScrollY:g},{default:u(()=>[n.value.length?R("",!0):(d(),B(m,{key:0})),i("ul",null,[(d(!0),b(X,null,Z(n.value,(_,S)=>(d(),b("li",{key:S,onClick:I=>w(_,S)},[i("p",Wt,P(_.song)+" - "+P(_.singers),1),i("div",Xt,[l(v,{placement:"bottomLeft",arrow:""},{overlay:u(()=>[l(H,null,{default:u(()=>[l(p,null,{default:u(()=>[i("a",{href:"javascript:;",onClick:I=>V(_,S)},"添加到播放列表",8,Zt)]),_:2},1024),l(p,null,{default:u(()=>[i("a",{href:"javascript:;",onClick:I=>w(_,S)},"立即播放",8,Kt)]),_:2},1024),l(p,null,{default:u(()=>[i("a",{href:"javascript:;",onClick:I=>N(_,S)},"下一首播放",8,en)]),_:2},1024),l(p,null,{default:u(()=>[i("a",{href:"javascript:;",onClick:I=>F(_,S)},"下载",8,tn)]),_:2},1024)]),_:2},1024)]),default:u(()=>[l(a(xe))]),_:2},1024)])],8,Qt))),128))])]),_:1})]),_:1},8,["spinning"])])])}}},sn=te(nn,[["__scopeId","data-v-5ada0861"]]);const ln={class:"bg"},an=["src"],cn=i("div",{class:"mask"},null,-1),on={class:"music-info"},rn=["src"],un={class:"progress-box"},dn={class:"prev-next"},vn={class:"mode"},mn={class:"music-list"},pn=["onClick"],fn={class:"music-cover"},gn=["src"],hn={class:"music-info"},_n={class:"music-lyric"},yn={key:0,class:"no-lyric"},bn=["onClick"],Cn={class:"action"},On={__name:"MusicFullScreen",props:{open:{type:Boolean,default:!1},musicCurrentTime:{type:Number,default:0},musicDuration:{type:Number,default:0},prevMusic:{type:String,default:""},nextMusic:{type:String,default:""},musicMode:{type:String,default:""}},emits:["close","handleDurationChange","handlePlay","handlePause","handlePrev","handleNext"],setup(s,{emit:e}){const t=s,{useMusicStore:n}=K(),c=x(!1),j=x(null),{isFullscreen:O,toggle:k,exit:M}=Ne(j),g=x({});Y(()=>[n.activeIndex,n.settings.playing],()=>{g.value=n.musicList[n.activeIndex]||{}},{immediate:!0,deep:!0});const E=v=>{const f=[];return v.split(`
`).map(_=>{let S=_.match(/\[(.*?)\]/);if(S){let I=S[1];/^(0\d|1\d|2[0-3]):([0-5]\d)\.(?:\d{2})$/.test(I)&&f.push({time:I,lyric:_.replace(/\[.*?\]/g,"")})}}),f},T=ee(()=>{var f,A,_;let v=[];return n.activeIndex<0?[]:((A=(f=g.value)==null?void 0:f.content)!=null&&A.length?v=E((_=g.value)==null?void 0:_.content):F(),v)}),w=x(0);Y(()=>t.musicCurrentTime,v=>{w.value=v},{immediate:!0,deep:!0});const V=x(0),N=v=>{var I;const A=le(T.value[v].time),_=le((I=T.value[v+1])==null?void 0:I.time),S=w.value+1>=A&&(w.value+1<_||!_);return S&&(V.value=v),S};Y(()=>V.value,()=>{let v=document.getElementById("lyric-list");if(v){let f=v.querySelector(".active");f&&v.scrollTo({top:f.offsetTop-v.clientHeight/2+f.clientHeight/2,behavior:"smooth"})}},{immediate:!0,deep:!0});const F=()=>{W.get(`https://api.lolimi.cn/API/kggc/api.php?msg=${g.value.name}-${g.value.singer}&n=1`).then(v=>{const{content:f}=v.data.data||{};v.data.code===1&&(n.musicList[n.activeIndex].content=f)})},z=()=>{M(),e("close")},r=v=>{n.playMusic(v)},o=v=>{n.changeMode(v)},h=v=>Q(v),$=v=>{e("handleDurationChange",v)},L=()=>{e("handlePlay")},y=()=>{e("handlePause")},m=()=>{e("handlePrev")},p=()=>{e("handleNext")},H=(v,f)=>{e("handleDurationChange",le(v.time)),e("handlePlay")};return(v,f)=>{const A=C("a-slider"),_=C("a-tooltip"),S=C("perfect-scrollbar"),I=C("a-popover");return d(),b("div",{ref_key:"fullscreenRef",ref:j,class:q(["music-fullscreen",{open:s.open}])},[i("div",ln,[i("img",{src:g.value.cover,alt:""},null,8,an),cn]),i("div",on,[i("img",{class:q(["cover",{playing:c.value||a(n).settings.playing}]),onClick:f[0]||(f[0]=D=>c.value=!c.value),src:g.value.cover,alt:""},null,10,rn),i("p",null,P(g.value.name),1),i("span",null,P(g.value.singer),1),i("div",un,[i("p",null,P(a(Q)(w.value)),1),l(A,{class:"play-slider",min:0,max:s.musicDuration,onChange:$,value:w.value,"onUpdate:value":f[1]||(f[1]=D=>w.value=D),tipFormatter:h},null,8,["max","value"]),i("p",null,P(a(Q)(s.musicDuration)),1)]),i("div",dn,[i("div",vn,[l(_,{title:s.musicMode},{default:u(()=>[a(n).settings.mode==="listCycle"?(d(),b("i",{key:0,class:"ifishfont ifish-musicListLoop",title:"列表循环",onClick:f[2]||(f[2]=D=>o("singleCycle"))})):R("",!0),a(n).settings.mode==="singleCycle"?(d(),b("i",{key:1,class:"ifishfont ifish-musicSingleCycle",title:"单曲循环",onClick:f[3]||(f[3]=D=>o("randomPlay"))})):R("",!0),a(n).settings.mode==="randomPlay"?(d(),b("i",{key:2,class:"ifishfont ifish-musicRandomPlay",title:"随机播放",onClick:f[4]||(f[4]=D=>o("listCycle"))})):R("",!0)]),_:1},8,["title"])]),l(_,{title:`上一首${s.prevMusic?"：":""}${s.prevMusic}`},{default:u(()=>[l(a(Ie),{onClick:m})]),_:1},8,["title"]),l(_,{title:a(n).settings.playing?"点击暂停":"点击播放"},{default:u(()=>[a(n).settings.playing?(d(),B(a(Se),{key:1,class:"pause",onClick:y})):(d(),B(a(ke),{key:0,class:"play",onClick:L}))]),_:1},8,["title"]),l(_,{title:`下一首${s.nextMusic?"：":""}${s.nextMusic}`},{default:u(()=>[l(a(we),{onClick:p})]),_:1},8,["title"]),l(I,{title:"播放列表",placement:"rightBottom"},{content:u(()=>[l(S,{class:"scroll-music"},{default:u(()=>[i("div",mn,[(d(!0),b(X,null,Z(a(n).musicList,(D,J)=>(d(),b("div",{class:q(["music-item",{active:a(n).activeIndex===J}]),key:J,onClick:De=>r(J)},[i("div",fn,[i("img",{src:D.cover,onerror:"this.src='./images/music.png'",alt:""},null,8,gn)]),i("div",hn,[i("p",null,P(D.name),1),i("span",null,P(D.singer),1)])],10,pn))),128))])]),_:1})]),default:u(()=>[l(a(Me))]),_:1})])]),i("div",_n,[T.value.length?R("",!0):(d(),b("p",yn,"暂无歌词")),l(S,{class:"scroll-bar",id:"lyric-list"},{default:u(()=>[(d(!0),b(X,null,Z(T.value,(D,J)=>(d(),b("p",{class:q({active:N(J)}),key:J,onClick:De=>H(D,J)},[i("span",null,P(D.time),1),U(" "+P(D.lyric),1)],10,bn))),128))]),_:1})]),i("div",Cn,[l(a(He),{class:"close",title:"关闭歌词",onClick:z}),a(O)?(d(),B(a(Ge),{key:0,title:"关闭全屏",onClick:a(k)},null,8,["onClick"])):(d(),B(a(We),{key:1,title:"开启全屏",onClick:a(k)},null,8,["onClick"]))])],2)}}};const $n={class:"music"},Ln=["src","loop"],xn=["title"],Pn={__name:"Index",setup(s){const{useMusicStore:e}=K();Ve(()=>{e.settings.playing=!1,e.musicList&&e.musicList.map((m,p)=>{let H=new Audio(m.url);H.onerror=function(){t(m)},H.load()})});const t=m=>{W.get(`https://xiaoapi.cn/API/yy_sq.php?msg=${m.name}-${m.singer}&n=1`).then(p=>{const{code:H,url:v}=p.data;H===200&&(m.url=v)})},n=x(!1),c=x(!1),j=x(!1),O=x(null),k=x({});Y(()=>[e.activeIndex,e.settings.playing],()=>{k.value=e.musicList[e.activeIndex]||{},ne(()=>{O.value&&(g.value=parseInt(O.value.duration),O.value.volume=e.settings.volume/100,e.settings.playing&&O.value.play())})},{immediate:!0,deep:!0}),Y(()=>[e.settings.volume,e.settings.mute],()=>{O.value&&ne(()=>{O.value.volume=e.settings.volume/100,O.value.muted=e.settings.mute})},{immediate:!0,deep:!0});const M=x(0),g=x(1e3),E=()=>{g.value=parseInt(O.value.duration),M.value=O.value.currentTime=e.settings.currentTime},T=m=>{const{currentTime:p,duration:H}=m.target;M.value=e.settings.currentTime=parseInt(p),g.value=parseInt(H)},w=()=>{e.toggleVisible()},V=()=>{!e.musicList.length||e.activeIndex<0||(e.settings.playing=!0,O.value.play())},N=()=>{!e.musicList.length||e.activeIndex<0||(e.settings.playing=!1,O.value.pause())},F=ee(()=>{if(!e.musicList.length||e.activeIndex<0)return"";let m=e.activeIndex===0?e.musicList.length-1:e.activeIndex-1;return e.musicList[m]?e.musicList[m].name:""}),z=()=>{if(!e.musicList.length||e.activeIndex<0)return;let m=e.activeIndex===0?e.musicList.length-1:e.activeIndex-1;e.playMusic(m)},r=ee(()=>{if(!e.musicList.length||e.activeIndex<0)return"";let m=e.activeIndex===e.musicList.length-1?0:e.activeIndex+1;return e.musicList[m]?e.musicList[m].name:""}),o=()=>{if(!e.musicList.length||e.activeIndex<0)return;let m=e.activeIndex===e.musicList.length-1?0:e.activeIndex+1;e.playMusic(m)},h=()=>{e.settings.mode==="listCycle"?(e.musicList.length===1&&(e.activeIndex--,e.activeIndex++),o()):e.settings.mode==="singleCycle"?e.playMusic(e.activeIndex):e.settings.mode==="randomPlay"&&e.playMusic(Ae(0,e.musicList.length-1,e.activeIndex))},$=()=>{console.log("播放出错")},L=m=>{e.settings.currentTime=m,O.value&&ne(()=>{O.value.currentTime=m})},y=ee(()=>({listCycle:"列表循环",singleCycle:"单曲循环",randomPlay:"随机播放"})[e.settings.mode]);return(m,p)=>{var v;const H=C("IDialog");return d(),b("div",$n,[Ee(i("audio",{ref_key:"audioRef",ref:O,controls:"",src:(v=k.value)==null?void 0:v.url,loop:a(e).settings.mode==="singleCycle",onTimeupdate:T,onLoadeddata:E,onEnded:h,onError:$},null,40,Ln),[[Fe,!1]]),i("div",{class:q(["toggle-icon bf",[a(e).visible?"down":"up"]]),title:a(e).visible?"隐藏播放器":"显示播放器",onClick:w},[l(a(Re))],10,xn),i("div",{class:q(["music-ctrl bf",[a(e).visible?"show":""]])},[l(Mt,{musicCurrentTime:M.value,musicDuration:g.value,prevMusic:F.value,nextMusic:r.value,musicMode:y.value,onShowSearch:p[0]||(p[0]=f=>c.value=!0),onToggleMusicList:p[1]||(p[1]=f=>n.value=!n.value),onShowLyric:p[2]||(p[2]=f=>j.value=!0),onHandlePlay:V,onHandlePause:N,onHandlePrev:z,onHandleNext:o,onHandleDurationChange:L},null,8,["musicCurrentTime","musicDuration","prevMusic","nextMusic","musicMode"])],2),l(Et,{open:n.value,onShowSearch:p[3]||(p[3]=f=>c.value=!0),onClose:p[4]||(p[4]=f=>n.value=!1)},null,8,["open"]),l(H,{title:"搜索音乐",visible:c.value,zIndex:1002,onOk:p[5]||(p[5]=f=>c.value=!1),onCancel:p[6]||(p[6]=f=>c.value=!1)},{default:u(()=>[l(sn)]),_:1},8,["visible"]),l(On,{open:j.value,musicCurrentTime:M.value,musicDuration:g.value,prevMusic:F.value,nextMusic:r.value,musicMode:y.value,onClose:p[7]||(p[7]=f=>j.value=!1),onHandlePlay:V,onHandlePause:N,onHandlePrev:z,onHandleNext:o,onHandleDurationChange:L},null,8,["open","musicCurrentTime","musicDuration","prevMusic","nextMusic","musicMode"])])}}},kn=te(Pn,[["__scopeId","data-v-84a49507"]]);export{kn as default};
