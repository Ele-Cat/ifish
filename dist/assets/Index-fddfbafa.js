import{c as l,A as J,_ as ee,u as X,r as Te,a as C,o as d,b as O,w as o,d as N,t as P,e as a,f as M,g as Y,h as i,n as q,i as U,j as A,F as W,S as $e,D as xe,k as K,l as Le,E as Pe,C as He,m as Ne,p as Z,q as Ve,s as Ee,v as Me,x as Fe,y as te,z as Re,B as ne,G as se,H as Ae,I as Be,J as Ue}from"./index-c9e4a597.js";import{s as Q,d as ke,u as le,m as ie,g as qe}from"./utils-7dc22624.js";var Je={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M391 240.9c-.8-6.6-8.9-9.4-13.6-4.7l-43.7 43.7L200 146.3a8.03 8.03 0 00-11.3 0l-42.4 42.3a8.03 8.03 0 000 11.3L280 333.6l-43.9 43.9a8.01 8.01 0 004.7 13.6L401 410c5.1.6 9.5-3.7 8.9-8.9L391 240.9zm10.1 373.2L240.8 633c-6.6.8-9.4 8.9-4.7 13.6l43.9 43.9L146.3 824a8.03 8.03 0 000 11.3l42.4 42.3c3.1 3.1 8.2 3.1 11.3 0L333.7 744l43.7 43.7A8.01 8.01 0 00391 783l18.9-160.1c.6-5.1-3.7-9.4-8.8-8.8zm221.8-204.2L783.2 391c6.6-.8 9.4-8.9 4.7-13.6L744 333.6 877.7 200c3.1-3.1 3.1-8.2 0-11.3l-42.4-42.3a8.03 8.03 0 00-11.3 0L690.3 279.9l-43.7-43.7a8.01 8.01 0 00-13.6 4.7L614.1 401c-.6 5.2 3.7 9.5 8.8 8.9zM744 690.4l43.9-43.9a8.01 8.01 0 00-4.7-13.6L623 614c-5.1-.6-9.5 3.7-8.9 8.9L633 783.1c.8 6.6 8.9 9.4 13.6 4.7l43.7-43.7L824 877.7c3.1 3.1 8.2 3.1 11.3 0l42.4-42.3c3.1-3.1 3.1-8.2 0-11.3L744 690.4z"}}]},name:"fullscreen-exit",theme:"outlined"};const Ge=Je;function pe(s){for(var e=1;e<arguments.length;e++){var t=arguments[e]!=null?Object(arguments[e]):{},n=Object.keys(t);typeof Object.getOwnPropertySymbols=="function"&&(n=n.concat(Object.getOwnPropertySymbols(t).filter(function(c){return Object.getOwnPropertyDescriptor(t,c).enumerable}))),n.forEach(function(c){Ye(s,c,t[c])})}return s}function Ye(s,e,t){return e in s?Object.defineProperty(s,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):s[e]=t,s}var ae=function(e,t){var n=pe({},e,t.attrs);return l(J,pe({},n,{icon:Ge}),null)};ae.displayName="FullscreenExitOutlined";ae.inheritAttrs=!1;const Qe=ae;var We={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M290 236.4l43.9-43.9a8.01 8.01 0 00-4.7-13.6L169 160c-5.1-.6-9.5 3.7-8.9 8.9L179 329.1c.8 6.6 8.9 9.4 13.6 4.7l43.7-43.7L370 423.7c3.1 3.1 8.2 3.1 11.3 0l42.4-42.3c3.1-3.1 3.1-8.2 0-11.3L290 236.4zm352.7 187.3c3.1 3.1 8.2 3.1 11.3 0l133.7-133.6 43.7 43.7a8.01 8.01 0 0013.6-4.7L863.9 169c.6-5.1-3.7-9.5-8.9-8.9L694.8 179c-6.6.8-9.4 8.9-4.7 13.6l43.9 43.9L600.3 370a8.03 8.03 0 000 11.3l42.4 42.4zM845 694.9c-.8-6.6-8.9-9.4-13.6-4.7l-43.7 43.7L654 600.3a8.03 8.03 0 00-11.3 0l-42.4 42.3a8.03 8.03 0 000 11.3L734 787.6l-43.9 43.9a8.01 8.01 0 004.7 13.6L855 864c5.1.6 9.5-3.7 8.9-8.9L845 694.9zm-463.7-94.6a8.03 8.03 0 00-11.3 0L236.3 733.9l-43.7-43.7a8.01 8.01 0 00-13.6 4.7L160.1 855c-.6 5.1 3.7 9.5 8.9 8.9L329.2 845c6.6-.8 9.4-8.9 4.7-13.6L290 787.6 423.7 654c3.1-3.1 3.1-8.2 0-11.3l-42.4-42.4z"}}]},name:"fullscreen",theme:"outlined"};const Xe=We;function fe(s){for(var e=1;e<arguments.length;e++){var t=arguments[e]!=null?Object(arguments[e]):{},n=Object.keys(t);typeof Object.getOwnPropertySymbols=="function"&&(n=n.concat(Object.getOwnPropertySymbols(t).filter(function(c){return Object.getOwnPropertyDescriptor(t,c).enumerable}))),n.forEach(function(c){Ze(s,c,t[c])})}return s}function Ze(s,e,t){return e in s?Object.defineProperty(s,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):s[e]=t,s}var ce=function(e,t){var n=fe({},e,t.attrs);return l(J,fe({},n,{icon:Xe}),null)};ce.displayName="FullscreenOutlined";ce.inheritAttrs=!1;const Ke=ce;var et={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M408 442h480c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8H408c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8zm-8 204c0 4.4 3.6 8 8 8h480c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8H408c-4.4 0-8 3.6-8 8v56zm504-486H120c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8h784c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8zm0 632H120c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8h784c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8zM142.4 642.1L298.7 519a8.84 8.84 0 000-13.9L142.4 381.9c-5.8-4.6-14.4-.5-14.4 6.9v246.3a8.9 8.9 0 0014.4 7z"}}]},name:"menu-unfold",theme:"outlined"};const tt=et;function ge(s){for(var e=1;e<arguments.length;e++){var t=arguments[e]!=null?Object(arguments[e]):{},n=Object.keys(t);typeof Object.getOwnPropertySymbols=="function"&&(n=n.concat(Object.getOwnPropertySymbols(t).filter(function(c){return Object.getOwnPropertyDescriptor(t,c).enumerable}))),n.forEach(function(c){nt(s,c,t[c])})}return s}function nt(s,e,t){return e in s?Object.defineProperty(s,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):s[e]=t,s}var oe=function(e,t){var n=ge({},e,t.attrs);return l(J,ge({},n,{icon:tt}),null)};oe.displayName="MenuUnfoldOutlined";oe.inheritAttrs=!1;const Se=oe;var st={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M512 64C264.6 64 64 264.6 64 512s200.6 448 448 448 448-200.6 448-448S759.4 64 512 64zm0 820c-205.4 0-372-166.6-372-372s166.6-372 372-372 372 166.6 372 372-166.6 372-372 372zm-88-532h-48c-4.4 0-8 3.6-8 8v304c0 4.4 3.6 8 8 8h48c4.4 0 8-3.6 8-8V360c0-4.4-3.6-8-8-8zm224 0h-48c-4.4 0-8 3.6-8 8v304c0 4.4 3.6 8 8 8h48c4.4 0 8-3.6 8-8V360c0-4.4-3.6-8-8-8z"}}]},name:"pause-circle",theme:"outlined"};const lt=st;function he(s){for(var e=1;e<arguments.length;e++){var t=arguments[e]!=null?Object(arguments[e]):{},n=Object.keys(t);typeof Object.getOwnPropertySymbols=="function"&&(n=n.concat(Object.getOwnPropertySymbols(t).filter(function(c){return Object.getOwnPropertyDescriptor(t,c).enumerable}))),n.forEach(function(c){it(s,c,t[c])})}return s}function it(s,e,t){return e in s?Object.defineProperty(s,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):s[e]=t,s}var re=function(e,t){var n=he({},e,t.attrs);return l(J,he({},n,{icon:lt}),null)};re.displayName="PauseCircleOutlined";re.inheritAttrs=!1;const we=re;var at={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M512 64C264.6 64 64 264.6 64 512s200.6 448 448 448 448-200.6 448-448S759.4 64 512 64zm0 820c-205.4 0-372-166.6-372-372s166.6-372 372-372 372 166.6 372 372-166.6 372-372 372z"}},{tag:"path",attrs:{d:"M719.4 499.1l-296.1-215A15.9 15.9 0 00398 297v430c0 13.1 14.8 20.5 25.3 12.9l296.1-215a15.9 15.9 0 000-25.8zm-257.6 134V390.9L628.5 512 461.8 633.1z"}}]},name:"play-circle",theme:"outlined"};const ct=at;function _e(s){for(var e=1;e<arguments.length;e++){var t=arguments[e]!=null?Object(arguments[e]):{},n=Object.keys(t);typeof Object.getOwnPropertySymbols=="function"&&(n=n.concat(Object.getOwnPropertySymbols(t).filter(function(c){return Object.getOwnPropertyDescriptor(t,c).enumerable}))),n.forEach(function(c){ot(s,c,t[c])})}return s}function ot(s,e,t){return e in s?Object.defineProperty(s,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):s[e]=t,s}var ue=function(e,t){var n=_e({},e,t.attrs);return l(J,_e({},n,{icon:ct}),null)};ue.displayName="PlayCircleOutlined";ue.inheritAttrs=!1;const Ie=ue;var rt={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M912 192H328c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8h584c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8zm0 284H328c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8h584c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8zm0 284H328c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8h584c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8zM104 228a56 56 0 10112 0 56 56 0 10-112 0zm0 284a56 56 0 10112 0 56 56 0 10-112 0zm0 284a56 56 0 10112 0 56 56 0 10-112 0z"}}]},name:"unordered-list",theme:"outlined"};const ut=rt;function ye(s){for(var e=1;e<arguments.length;e++){var t=arguments[e]!=null?Object(arguments[e]):{},n=Object.keys(t);typeof Object.getOwnPropertySymbols=="function"&&(n=n.concat(Object.getOwnPropertySymbols(t).filter(function(c){return Object.getOwnPropertyDescriptor(t,c).enumerable}))),n.forEach(function(c){dt(s,c,t[c])})}return s}function dt(s,e,t){return e in s?Object.defineProperty(s,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):s[e]=t,s}var de=function(e,t){var n=ye({},e,t.attrs);return l(J,ye({},n,{icon:ut}),null)};de.displayName="UnorderedListOutlined";de.inheritAttrs=!1;const vt=de;var mt={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M762 164h-64c-4.4 0-8 3.6-8 8v688c0 4.4 3.6 8 8 8h64c4.4 0 8-3.6 8-8V172c0-4.4-3.6-8-8-8zm-508 0v72.4c0 9.5 4.2 18.4 11.4 24.5L564.6 512 265.4 763.1c-7.2 6.1-11.4 15-11.4 24.5V860c0 6.8 7.9 10.5 13.1 6.1L689 512 267.1 157.9A7.95 7.95 0 00254 164z"}}]},name:"vertical-left",theme:"outlined"};const pt=mt;function be(s){for(var e=1;e<arguments.length;e++){var t=arguments[e]!=null?Object(arguments[e]):{},n=Object.keys(t);typeof Object.getOwnPropertySymbols=="function"&&(n=n.concat(Object.getOwnPropertySymbols(t).filter(function(c){return Object.getOwnPropertyDescriptor(t,c).enumerable}))),n.forEach(function(c){ft(s,c,t[c])})}return s}function ft(s,e,t){return e in s?Object.defineProperty(s,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):s[e]=t,s}var ve=function(e,t){var n=be({},e,t.attrs);return l(J,be({},n,{icon:pt}),null)};ve.displayName="VerticalLeftOutlined";ve.inheritAttrs=!1;const De=ve;var gt={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M326 164h-64c-4.4 0-8 3.6-8 8v688c0 4.4 3.6 8 8 8h64c4.4 0 8-3.6 8-8V172c0-4.4-3.6-8-8-8zm444 72.4V164c0-6.8-7.9-10.5-13.1-6.1L335 512l421.9 354.1c5.2 4.4 13.1.7 13.1-6.1v-72.4c0-9.4-4.2-18.4-11.4-24.5L459.4 512l299.2-251.1c7.2-6.1 11.4-15.1 11.4-24.5z"}}]},name:"vertical-right",theme:"outlined"};const ht=gt;function Ce(s){for(var e=1;e<arguments.length;e++){var t=arguments[e]!=null?Object(arguments[e]):{},n=Object.keys(t);typeof Object.getOwnPropertySymbols=="function"&&(n=n.concat(Object.getOwnPropertySymbols(t).filter(function(c){return Object.getOwnPropertyDescriptor(t,c).enumerable}))),n.forEach(function(c){_t(s,c,t[c])})}return s}function _t(s,e,t){return e in s?Object.defineProperty(s,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):s[e]=t,s}var me=function(e,t){var n=Ce({},e,t.attrs);return l(J,Ce({},n,{icon:ht}),null)};me.displayName="VerticalRightOutlined";me.inheritAttrs=!1;const je=me;const yt={class:"music-shortkey"},bt={__name:"MusicShortkey",setup(s){const{useSystemStore:e}=X(),t=Te({}),n={style:{width:"100px"}};return(c,j)=>{const b=C("a-form-item"),k=C("a-form");return d(),O("div",yt,[l(k,{model:t,"label-col":n},{default:o(()=>[l(b,{label:"播放、暂停"},{default:o(()=>[N(" Space ")]),_:1}),l(b,{label:"上一首"},{default:o(()=>[N(P(a(e).ctrlOrCommand())+" + ← ",1)]),_:1}),l(b,{label:"下一首"},{default:o(()=>[N(P(a(e).ctrlOrCommand())+" + → ",1)]),_:1}),l(b,{label:"关闭歌词"},{default:o(()=>[N(" Esc ")]),_:1})]),_:1},8,["model"])])}}},Ct=ee(bt,[["__scopeId","data-v-aba3aed9"]]);const Ot={class:"music-box"},$t={key:0,class:"info"},xt={key:1,class:"info"},Lt=["src"],Pt={class:"center"},Mt={class:"prev-next"},kt={class:"progress-box"},St={class:"ctrl"},wt=["title"],It={class:"mode"},Dt={__name:"MusicCtrl",props:{musicCurrentTime:{type:Number,default:0},musicDuration:{type:Number,default:0},prevMusic:{type:String,default:""},nextMusic:{type:String,default:""},musicMode:{type:String,default:""}},emits:["toggleMusicList","showSearch","handleDurationChange","handlePlay","handlePause","handlePrev","handleNext","showLyric"],setup(s,{emit:e}){const t=s,{useMusicStore:n}=X(),c=M(0);Y(()=>t.musicCurrentTime,p=>{c.value=p},{immediate:!0,deep:!0});const j=()=>{e("toggleMusicList")},b=()=>{e("showSearch")},k=p=>{n.changeMode(p)},S=p=>{n.toggleMute(p)},h=M({});Y(()=>[n.activeIndex,n.settings.playing],()=>{h.value=n.musicList[n.activeIndex]||{}},{immediate:!0,deep:!0});const F=p=>Q(p),V=p=>{e("handleDurationChange",p)},D=()=>{e("handlePlay")},E=()=>{e("handlePause")},H=()=>{e("handlePrev")},R=()=>{e("handleNext")},I=()=>{e("showLyric")},v=M(!1),_=()=>{v.value=!0};return(p,r)=>{const $=C("a-tooltip"),L=C("a-slider"),m=C("a-divider"),f=C("IDialog");return d(),O(W,null,[i("div",Ot,[a(n).musicList.length?(d(),O("div",xt,[i("div",{class:"cover",onClick:I},[i("img",{class:q({playing:a(n).settings.playing}),src:h.value.cover,onerror:"this.src='./images/music.png'",alt:""},null,10,Lt)]),N(" "+P(h.value.name)+" - "+P(h.value.singer),1)])):(d(),O("div",$t,[N(" 暂无音乐，请选择"),i("span",{class:"add",onClick:b},"添加")])),i("div",Pt,[i("div",Mt,[l($,{title:"查看快捷键"},{default:o(()=>[i("i",{class:"ifishfont ifish-music-shortkey",onClick:r[0]||(r[0]=x=>_())})]),_:1}),l($,{title:`上一首${s.prevMusic?"：":""}${s.prevMusic}`},{default:o(()=>[l(a(je),{onClick:H})]),_:1},8,["title"]),l($,{title:a(n).settings.playing?"点击暂停":"点击播放"},{default:o(()=>[a(n).settings.playing?(d(),U(a(we),{key:1,class:"pause",onClick:E})):(d(),U(a(Ie),{key:0,class:"play",onClick:D}))]),_:1},8,["title"]),l($,{title:`下一首${s.nextMusic?"：":""}${s.nextMusic}`},{default:o(()=>[l(a(De),{onClick:R})]),_:1},8,["title"]),l($,{title:"展开歌词"},{default:o(()=>[i("i",{class:"ifishfont ifish-music-lyric",onClick:I})]),_:1})]),i("div",kt,[i("p",null,P(a(Q)(c.value)),1),l(L,{class:"play-slider",min:0,max:s.musicDuration,onChange:V,value:c.value,"onUpdate:value":r[1]||(r[1]=x=>c.value=x),tipFormatter:F},null,8,["max","value"]),i("p",null,P(a(Q)(s.musicDuration)),1)])]),i("div",St,[i("div",{class:"volume",title:`当前音量：${a(n).settings.volume}`},[a(n).settings.mute||a(n).settings.volume===0?(d(),O("i",{key:0,class:"ifishfont ifish-volumeDisable",onClick:r[2]||(r[2]=x=>S(!0))})):a(n).settings.volume>=0&&a(n).settings.volume<30?(d(),O("i",{key:1,class:"ifishfont ifish-volumeLow",onClick:r[3]||(r[3]=x=>S(!1))})):a(n).settings.volume>=30&&a(n).settings.volume<60?(d(),O("i",{key:2,class:"ifishfont ifish-volumeMiddle",onClick:r[4]||(r[4]=x=>S(!1))})):(d(),O("i",{key:3,class:"ifishfont ifish-volumeHigh",onClick:r[5]||(r[5]=x=>S(!1))})),l(L,{class:"volume-slider",min:0,max:100,value:a(n).settings.volume,"onUpdate:value":r[6]||(r[6]=x=>a(n).settings.volume=x)},null,8,["value"])],8,wt),i("div",It,[l($,{title:s.musicMode},{default:o(()=>[a(n).settings.mode==="listCycle"?(d(),O("i",{key:0,class:"ifishfont ifish-musicListLoop",title:"列表循环",onClick:r[7]||(r[7]=x=>k("singleCycle"))})):A("",!0),a(n).settings.mode==="singleCycle"?(d(),O("i",{key:1,class:"ifishfont ifish-musicSingleCycle",title:"单曲循环",onClick:r[8]||(r[8]=x=>k("randomPlay"))})):A("",!0),a(n).settings.mode==="randomPlay"?(d(),O("i",{key:2,class:"ifishfont ifish-musicRandomPlay",title:"随机播放",onClick:r[9]||(r[9]=x=>k("listCycle"))})):A("",!0)]),_:1},8,["title"])]),l(m,{type:"vertical"}),l($,{title:"播放列表",placement:"topRight"},{default:o(()=>[l(a(Se),{onClick:j})]),_:1})])]),l(f,{title:"音乐快捷键",visible:v.value,zIndex:1003,onOk:r[10]||(r[10]=x=>v.value=!1),onCancel:r[11]||(r[11]=x=>v.value=!1)},{default:o(()=>[l(Ct)]),_:1},8,["visible"])],64)}}},jt=ee(Dt,[["__scopeId","data-v-b495b25f"]]);const zt={class:"music-box"},Tt={class:"title"},Ht={class:"music-list"},Nt=["onClick"],Vt={class:"music-cover"},Et=["src"],Ft={class:"music-info"},Rt=["onClick"],At=["onClick"],Bt=["onClick"],Ut={__name:"MusicList",props:{open:{type:Boolean,default:!1}},emits:["close","showSearch"],setup(s,{emit:e}){const{useMusicStore:t}=X(),n=()=>{e("close")},c=()=>{e("showSearch")},j=()=>{t.musicList=[]},b=h=>{t.playMusic(h)},k=h=>{h<t.activeIndex?(t.musicList.splice(h,1),t.activeIndex--):(h===t.activeIndex&&(t.settings.currentTime=0,t.activeIndex===t.musicList.length-1&&(t.activeIndex=0),t.activeIndex++,t.activeIndex--),t.musicList.splice(h,1))},S=h=>{ke(h.url)};return(h,F)=>{const V=C("a-input"),D=C("a-popconfirm"),E=C("a-empty"),H=C("a-menu-item"),R=C("a-menu"),I=C("a-dropdown"),v=C("perfect-scrollbar"),_=C("a-drawer");return d(),U(_,{width:"360px",title:"播放列表",placement:"right",open:s.open,onClose:n,rootClassName:"disclaimers-root"},{default:o(()=>[i("div",zt,[l(V,{onClick:c,readonly:"",placeholder:"搜索",style:{"border-radius":"20px"}},{prefix:o(()=>[l(a($e))]),_:1}),i("div",null,[i("p",Tt,[i("span",null,[l(a(vt)),N("播放列表（共 "+P(a(t).musicList.length)+" 首）",1)]),l(D,{title:"确认清空列表？",onConfirm:j},{default:o(()=>[i("span",null,[l(a(xe)),N("清空列表")])]),_:1})]),a(t).musicList.length?A("",!0):(d(),U(E,{key:0,class:"list-empty"},{description:o(()=>[i("span",{class:"description"},[N(" 暂无歌曲，请"),i("a",{onClick:c},"搜索添加")])]),_:1})),l(v,{class:"scroll-bar"},{default:o(()=>[i("div",Ht,[(d(!0),O(W,null,K(a(t).musicList,(p,r)=>(d(),O("div",{class:q(["music-item",{active:a(t).activeIndex===r}]),key:r,onClick:$=>b(r)},[i("div",Vt,[i("img",{src:p.cover,onerror:"this.src='./images/music.png'",alt:""},null,8,Et)]),i("div",Ft,[i("p",null,P(p.name),1),i("span",null,P(p.singer),1)]),i("div",{class:"music-action",onClick:F[0]||(F[0]=Le(()=>{},["stop"]))},[l(I,{placement:"bottomLeft",arrow:""},{overlay:o(()=>[l(R,null,{default:o(()=>[l(H,null,{default:o(()=>[i("a",{href:"javascript:;",onClick:$=>b(r)},"播放",8,Rt)]),_:2},1024),l(H,null,{default:o(()=>[i("a",{href:"javascript:;",onClick:$=>k(r)},"移除",8,At)]),_:2},1024),l(H,null,{default:o(()=>[i("a",{href:"javascript:;",onClick:$=>S(p)},"下载",8,Bt)]),_:2},1024)]),_:2},1024)]),default:o(()=>[l(a(Pe))]),_:2},1024)])],10,Nt))),128))])]),_:1})])])]),_:1},8,["open"])}}},qt=ee(Ut,[["__scopeId","data-v-5a8bf248"]]);const Jt=s=>(Ve("data-v-110f9282"),s=s(),Ee(),s),Gt={class:"search"},Yt={key:0,class:"search-history"},Qt={class:"title"},Wt={class:"search-history-box"},Xt=["onClick"],Zt={class:"text",title:"点击搜索"},Kt={class:"search-list"},en=Jt(()=>i("p",{class:"title"},"搜索结果：",-1)),tn=["onClick"],nn={title:"立即播放"},sn={class:"search-action"},ln=["onClick"],an=["onClick"],cn=["onClick"],on=["onClick"],Oe=15,rn={__name:"MusicSearch",setup(s){const{useMusicStore:e}=X(),t=M(""),n=M([]),c=M(!1),j=v=>{if(n.value=[],!v){Ne({type:"warning",content:"请输入歌曲、歌手后搜索"});return}e.searchHistory.indexOf(v)<0&&e.searchHistory.unshift(v),S(v)};let b=M(1),k=M(!1);const S=v=>{t.value=v,c.value=!0;const _=`https://api.lolimi.cn/API/qqdg/api.php?msg=${v}&p=${b.value}&sc=${Oe}`;Z.get(_).then(p=>{p.data.code===1?(n.value=[...n.value,...p.data.data],p.data.data.length<Oe&&(k.value=!0)):k.value=!0,c.value=!1})},h=v=>{if(k.value)return;let _=v.target;_.scrollTop+_.clientHeight>=_.scrollHeight&&(b.value++,S(t.value))},F=()=>{e.searchHistory=[]},V=v=>{const _=e.searchHistory.indexOf(v);e.searchHistory.splice(_,1)},D=async(v,_)=>{const{cover:p,name:r,singer:$,url:L,content:m}=await I(v);e.musicList.push({id:le(21),cover:p,name:r,singer:$,url:L,content:m}),e.playMusic(e.musicList.length-1)},E=async(v,_)=>{const{cover:p,name:r,singer:$,url:L,content:m}=await I(v);e.musicList.push({id:le(21),cover:p,name:r,singer:$,url:L,content:m})},H=async(v,_)=>{const{cover:p,name:r,singer:$,url:L,content:m}=await I(v);e.musicList.splice(e.activeIndex+1,0,{id:le(21),cover:p,name:r,singer:$,url:L,content:m})},R=async(v,_)=>{const{url:p}=await I(v);p&&ke(p)},I=async(v,_)=>{const p=new Promise((L,m)=>{Z.get(`https://xiaoapi.cn/API/yy_sq.php?msg=${v.song} ${v.singer}&n=1`).then(f=>{f.data.code===200?L(f.data):L({})})}),r=new Promise((L,m)=>{Z.get(`https://api.lolimi.cn/API/kggc/api.php?msg=${v.song} ${v.singer}&n=1`).then(f=>{f.data.code===1?L(f.data.data):L({})})}),$=await Promise.all([p,r]);return{...$[0],...$[1]}};return(v,_)=>{const p=C("a-input"),r=C("a-col"),$=C("a-button"),L=C("a-row"),m=C("a-empty"),f=C("a-menu-item"),x=C("a-menu"),u=C("a-dropdown"),g=C("perfect-scrollbar"),B=C("a-spin");return d(),O("div",Gt,[l(L,{gutter:12},{default:o(()=>[l(r,{span:20},{default:o(()=>[l(p,{value:t.value,"onUpdate:value":_[0]||(_[0]=y=>t.value=y),onPressEnter:_[1]||(_[1]=y=>j(y.target.value)),placeholder:"输入歌曲、歌手",allowClear:"",style:{"border-radius":"16px"}},{prefix:o(()=>[l(a($e))]),_:1},8,["value"])]),_:1}),l(r,{span:3},{default:o(()=>[l($,{type:"primary",shape:"round",onClick:_[2]||(_[2]=y=>j(t.value))},{default:o(()=>[N("搜索")]),_:1})]),_:1})]),_:1}),a(e).searchHistory.length?(d(),O("div",Yt,[i("p",Qt,[N(" 搜索历史： "),i("span",{class:"clear",onClick:F},[l(a(xe)),N("清空历史搜索")])]),i("div",Wt,[(d(!0),O(W,null,K(a(e).searchHistory,(y,w)=>(d(),O("p",{key:w,onClick:z=>S(y)},[i("span",Zt,P(y),1),l(a(He),{title:"点击移除",onClick:Le(z=>V(y),["stop"])},null,8,["onClick"])],8,Xt))),128))])])):A("",!0),i("div",Kt,[en,l(B,{spinning:c.value,tip:"加载中..."},{default:o(()=>[l(g,{class:"scroll-bar",onPsScrollY:h},{default:o(()=>[n.value.length?A("",!0):(d(),U(m,{key:0})),i("ul",null,[(d(!0),O(W,null,K(n.value,(y,w)=>(d(),O("li",{key:w,onClick:z=>D(y,w)},[i("p",nn,P(y.song)+" - "+P(y.singers),1),i("div",sn,[l(u,{placement:"bottomLeft",arrow:""},{overlay:o(()=>[l(x,null,{default:o(()=>[l(f,null,{default:o(()=>[i("a",{href:"javascript:;",onClick:z=>E(y,w)},"添加到播放列表",8,ln)]),_:2},1024),l(f,null,{default:o(()=>[i("a",{href:"javascript:;",onClick:z=>D(y,w)},"立即播放",8,an)]),_:2},1024),l(f,null,{default:o(()=>[i("a",{href:"javascript:;",onClick:z=>H(y,w)},"下一首播放",8,cn)]),_:2},1024),l(f,null,{default:o(()=>[i("a",{href:"javascript:;",onClick:z=>R(y,w)},"下载",8,on)]),_:2},1024)]),_:2},1024)]),default:o(()=>[l(a(Pe))]),_:2},1024)])],8,tn))),128))])]),_:1})]),_:1},8,["spinning"])])])}}},un=ee(rn,[["__scopeId","data-v-110f9282"]]);const dn={class:"bg"},vn=["src"],mn=i("div",{class:"mask"},null,-1),pn={class:"music-info"},fn=["src"],gn={class:"progress-box"},hn={class:"prev-next"},_n={class:"mode"},yn={class:"music-list"},bn=["onClick"],Cn={class:"music-cover"},On=["src"],$n={class:"music-info"},xn={class:"music-lyric"},Ln={key:0,class:"no-lyric"},Pn=["onClick"],Mn={class:"action"},kn={__name:"MusicFullScreen",props:{open:{type:Boolean,default:!1},musicCurrentTime:{type:Number,default:0},musicDuration:{type:Number,default:0},prevMusic:{type:String,default:""},nextMusic:{type:String,default:""},musicMode:{type:String,default:""}},emits:["close","handleDurationChange","handlePlay","handlePause","handlePrev","handleNext"],setup(s,{emit:e}){const t=s,{useMusicStore:n}=X();Me(()=>{window.onkeydown=u=>{const{keyCode:g}=u;g===27&&I()}});const c=M(!1),j=M(null),{isFullscreen:b,toggle:k,exit:S}=Fe(j),h=M({});Y(()=>[n.activeIndex,n.settings.playing],()=>{h.value=n.musicList[n.activeIndex]||{}},{immediate:!0,deep:!0});const F=u=>{const g=[];return u.split(`
`).map(y=>{let w=y.match(/\[(.*?)\]/);if(w){let z=w[1];/^(0\d|1\d|2[0-3]):([0-5]\d)\.(?:\d{2})$/.test(z)&&g.push({time:z,lyric:y.replace(/\[.*?\]/g,"")})}}),g},V=te(()=>{var g,B,y;let u=[];return n.activeIndex<0?[]:((B=(g=h.value)==null?void 0:g.content)!=null&&B.length?u=F((y=h.value)==null?void 0:y.content):R(),u)}),D=M(0);Y(()=>t.musicCurrentTime,u=>{D.value=u},{immediate:!0,deep:!0});const E=M(0),H=u=>{var z;const B=ie(V.value[u].time),y=ie((z=V.value[u+1])==null?void 0:z.time),w=D.value+1>=B&&(D.value+1<y||!y);return w&&(E.value=u),w};Y(()=>E.value,()=>{let u=document.getElementById("lyric-list");if(u){let g=u.querySelector(".active");g&&u.scrollTo({top:g.offsetTop-u.clientHeight/2+g.clientHeight/2,behavior:"smooth"})}},{immediate:!0,deep:!0});const R=()=>{Z.get(`https://api.lolimi.cn/API/kggc/api.php?msg=${h.value.name}-${h.value.singer}&n=1`).then(u=>{const{content:g}=u.data.data||{};u.data.code===1&&(n.musicList[n.activeIndex].content=g)})},I=()=>{S(),e("close")},v=u=>{n.playMusic(u)},_=u=>{n.changeMode(u)},p=u=>Q(u),r=u=>{e("handleDurationChange",u)},$=()=>{e("handlePlay")},L=()=>{e("handlePause")},m=()=>{e("handlePrev")},f=()=>{e("handleNext")},x=(u,g)=>{e("handleDurationChange",ie(u.time)),e("handlePlay")};return(u,g)=>{const B=C("a-slider"),y=C("a-tooltip"),w=C("perfect-scrollbar"),z=C("a-popover");return d(),O("div",{ref_key:"fullscreenRef",ref:j,class:q(["music-fullscreen",{open:s.open}])},[i("div",dn,[i("img",{src:h.value.cover,alt:""},null,8,vn),mn]),i("div",pn,[i("img",{class:q(["cover",{playing:c.value||a(n).settings.playing}]),onClick:g[0]||(g[0]=T=>c.value=!c.value),src:h.value.cover,alt:""},null,10,fn),i("p",null,P(h.value.name),1),i("span",null,P(h.value.singer),1),i("div",gn,[i("p",null,P(a(Q)(D.value)),1),l(B,{class:"play-slider",min:0,max:s.musicDuration,onChange:r,value:D.value,"onUpdate:value":g[1]||(g[1]=T=>D.value=T),tipFormatter:p},null,8,["max","value"]),i("p",null,P(a(Q)(s.musicDuration)),1)]),i("div",hn,[i("div",_n,[l(y,{title:s.musicMode},{default:o(()=>[a(n).settings.mode==="listCycle"?(d(),O("i",{key:0,class:"ifishfont ifish-musicListLoop",title:"列表循环",onClick:g[2]||(g[2]=T=>_("singleCycle"))})):A("",!0),a(n).settings.mode==="singleCycle"?(d(),O("i",{key:1,class:"ifishfont ifish-musicSingleCycle",title:"单曲循环",onClick:g[3]||(g[3]=T=>_("randomPlay"))})):A("",!0),a(n).settings.mode==="randomPlay"?(d(),O("i",{key:2,class:"ifishfont ifish-musicRandomPlay",title:"随机播放",onClick:g[4]||(g[4]=T=>_("listCycle"))})):A("",!0)]),_:1},8,["title"])]),l(y,{title:`上一首${s.prevMusic?"：":""}${s.prevMusic}`},{default:o(()=>[l(a(je),{onClick:m})]),_:1},8,["title"]),l(y,{title:a(n).settings.playing?"点击暂停":"点击播放"},{default:o(()=>[a(n).settings.playing?(d(),U(a(we),{key:1,class:"pause",onClick:L})):(d(),U(a(Ie),{key:0,class:"play",onClick:$}))]),_:1},8,["title"]),l(y,{title:`下一首${s.nextMusic?"：":""}${s.nextMusic}`},{default:o(()=>[l(a(De),{onClick:f})]),_:1},8,["title"]),l(z,{title:"播放列表",placement:"rightBottom"},{content:o(()=>[l(w,{class:"scroll-music"},{default:o(()=>[i("div",yn,[(d(!0),O(W,null,K(a(n).musicList,(T,G)=>(d(),O("div",{class:q(["music-item",{active:a(n).activeIndex===G}]),key:G,onClick:ze=>v(G)},[i("div",Cn,[i("img",{src:T.cover,onerror:"this.src='./images/music.png'",alt:""},null,8,On)]),i("div",$n,[i("p",null,P(T.name),1),i("span",null,P(T.singer),1)])],10,bn))),128))])]),_:1})]),default:o(()=>[l(a(Se))]),_:1})])]),i("div",xn,[V.value.length?A("",!0):(d(),O("p",Ln,"暂无歌词")),l(w,{class:"scroll-bar",id:"lyric-list"},{default:o(()=>[(d(!0),O(W,null,K(V.value,(T,G)=>(d(),O("p",{class:q({active:H(G)}),key:G,onClick:ze=>x(T,G)},[i("span",null,P(T.time),1),N(" "+P(T.lyric),1)],10,Pn))),128))]),_:1})]),i("div",Mn,[l(a(Re),{class:"close",title:"关闭歌词",onClick:I}),a(b)?(d(),U(a(Qe),{key:0,title:"关闭全屏",onClick:a(k)},null,8,["onClick"])):(d(),U(a(Ke),{key:1,title:"开启全屏",onClick:a(k)},null,8,["onClick"]))])],2)}}};const Sn={class:"music"},wn=["src","loop"],In=["title"],Dn={__name:"Index",setup(s){const{useMusicStore:e}=X();Me(()=>{e.settings.playing=!1,e.musicList&&e.musicList.map((m,f)=>{let x=new Audio(m.url);x.onerror=function(){t(m)},x.load()}),ne.on("playOrPause",()=>{e.settings.playing?H():E()}),ne.on("prevMusic",()=>{I()}),ne.on("nextMusic",()=>{_()})});const t=m=>{Z.get(`https://xiaoapi.cn/API/yy_sq.php?msg=${m.name} ${m.singer}&n=1`).then(f=>{const{code:x,url:u}=f.data;x===200&&(m.url=u)})},n=M(!1),c=M(!1),j=M(!1),b=M(null),k=M({});Y(()=>[e.activeIndex,e.settings.playing],()=>{k.value=e.musicList[e.activeIndex]||{},se(()=>{b.value&&(h.value=parseInt(b.value.duration),b.value.volume=e.settings.volume/100,e.settings.playing&&b.value.play())})},{immediate:!0,deep:!0}),Y(()=>[e.settings.volume,e.settings.mute],()=>{b.value&&se(()=>{b.value.volume=e.settings.volume/100,b.value.muted=e.settings.mute})},{immediate:!0,deep:!0});const S=M(0),h=M(1e3),F=()=>{h.value=parseInt(b.value.duration),S.value=b.value.currentTime=e.settings.currentTime},V=m=>{const{currentTime:f,duration:x}=m.target;S.value=e.settings.currentTime=parseInt(f),h.value=parseInt(x)},D=()=>{e.toggleVisible()},E=()=>{!e.musicList.length||e.activeIndex<0||(e.settings.playing=!0,b.value.play())},H=()=>{!e.musicList.length||e.activeIndex<0||(e.settings.playing=!1,b.value.pause())},R=te(()=>{if(!e.musicList.length||e.activeIndex<0)return"";let m=e.activeIndex===0?e.musicList.length-1:e.activeIndex-1;return e.musicList[m]?e.musicList[m].name:""}),I=()=>{if(!e.musicList.length||e.activeIndex<0)return;let m=e.activeIndex===0?e.musicList.length-1:e.activeIndex-1;e.playMusic(m)},v=te(()=>{if(!e.musicList.length||e.activeIndex<0)return"";let m=e.activeIndex===e.musicList.length-1?0:e.activeIndex+1;return e.musicList[m]?e.musicList[m].name:""}),_=()=>{if(!e.musicList.length||e.activeIndex<0)return;let m=e.activeIndex===e.musicList.length-1?0:e.activeIndex+1;e.playMusic(m)},p=()=>{e.settings.mode==="listCycle"?(e.musicList.length===1&&(e.activeIndex--,e.activeIndex++),_()):e.settings.mode==="singleCycle"?e.playMusic(e.activeIndex):e.settings.mode==="randomPlay"&&e.playMusic(qe(0,e.musicList.length-1,e.activeIndex))},r=()=>{console.log("播放出错")},$=m=>{e.settings.currentTime=m,b.value&&se(()=>{b.value.currentTime=m})},L=te(()=>({listCycle:"列表循环",singleCycle:"单曲循环",randomPlay:"随机播放"})[e.settings.mode]);return(m,f)=>{var u;const x=C("IDialog");return d(),O("div",Sn,[Ae(i("audio",{ref_key:"audioRef",ref:b,controls:"",src:(u=k.value)==null?void 0:u.url,loop:a(e).settings.mode==="singleCycle",onTimeupdate:V,onLoadeddata:F,onEnded:p,onError:r},null,40,wn),[[Be,!1]]),i("div",{class:q(["toggle-icon bf",[a(e).visible?"down":"up"]]),title:a(e).visible?"隐藏播放器":"显示播放器",onClick:D},[l(a(Ue))],10,In),i("div",{class:q(["music-ctrl bf",[a(e).visible?"show":""]])},[l(jt,{musicCurrentTime:S.value,musicDuration:h.value,prevMusic:R.value,nextMusic:v.value,musicMode:L.value,onShowSearch:f[0]||(f[0]=g=>c.value=!0),onToggleMusicList:f[1]||(f[1]=g=>n.value=!n.value),onShowLyric:f[2]||(f[2]=g=>j.value=!0),onHandlePlay:E,onHandlePause:H,onHandlePrev:I,onHandleNext:_,onHandleDurationChange:$},null,8,["musicCurrentTime","musicDuration","prevMusic","nextMusic","musicMode"])],2),l(qt,{open:n.value,onShowSearch:f[3]||(f[3]=g=>c.value=!0),onClose:f[4]||(f[4]=g=>n.value=!1)},null,8,["open"]),l(x,{title:"搜索音乐",visible:c.value,zIndex:1002,onOk:f[5]||(f[5]=g=>c.value=!1),onCancel:f[6]||(f[6]=g=>c.value=!1)},{default:o(()=>[l(un)]),_:1},8,["visible"]),l(kn,{open:j.value,musicCurrentTime:S.value,musicDuration:h.value,prevMusic:R.value,nextMusic:v.value,musicMode:L.value,onClose:f[7]||(f[7]=g=>j.value=!1),onHandlePlay:E,onHandlePause:H,onHandlePrev:I,onHandleNext:_,onHandleDurationChange:$},null,8,["open","musicCurrentTime","musicDuration","prevMusic","nextMusic","musicMode"])])}}},Tn=ee(Dn,[["__scopeId","data-v-e9d410c4"]]);export{Tn as default};
