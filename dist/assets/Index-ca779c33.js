import{c as s,A,_ as U,u as F,a as q,r as M,w as W,n as G,b as f,o as d,d as g,e as l,f as N,g as o,h as B,t as P,i as c,j as R,k as T,l as pe,v as me,S as re,F as X,m as Y,p as ue,E as de,D as fe,C as _e,q as se,s as ge,x as he,y as ye,z as be,B as Ce}from"./index-de1a6977.js";import{s as J,g as Oe,d as ve,u as Q}from"./utils-5dfaf7e4.js";var $e={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M408 442h480c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8H408c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8zm-8 204c0 4.4 3.6 8 8 8h480c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8H408c-4.4 0-8 3.6-8 8v56zm504-486H120c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8h784c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8zm0 632H120c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8h784c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8zM142.4 642.1L298.7 519a8.84 8.84 0 000-13.9L142.4 381.9c-5.8-4.6-14.4-.5-14.4 6.9v246.3a8.9 8.9 0 0014.4 7z"}}]},name:"menu-unfold",theme:"outlined"};const xe=$e;function ie(n){for(var t=1;t<arguments.length;t++){var e=arguments[t]!=null?Object(arguments[t]):{},i=Object.keys(e);typeof Object.getOwnPropertySymbols=="function"&&(i=i.concat(Object.getOwnPropertySymbols(e).filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable}))),i.forEach(function(a){Le(n,a,e[a])})}return n}function Le(n,t,e){return t in n?Object.defineProperty(n,t,{value:e,enumerable:!0,configurable:!0,writable:!0}):n[t]=e,n}var Z=function(t,e){var i=ie({},t,e.attrs);return s(A,ie({},i,{icon:xe}),null)};Z.displayName="MenuUnfoldOutlined";Z.inheritAttrs=!1;const we=Z;var Se={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M512 64C264.6 64 64 264.6 64 512s200.6 448 448 448 448-200.6 448-448S759.4 64 512 64zm0 820c-205.4 0-372-166.6-372-372s166.6-372 372-372 372 166.6 372 372-166.6 372-372 372zm-88-532h-48c-4.4 0-8 3.6-8 8v304c0 4.4 3.6 8 8 8h48c4.4 0 8-3.6 8-8V360c0-4.4-3.6-8-8-8zm224 0h-48c-4.4 0-8 3.6-8 8v304c0 4.4 3.6 8 8 8h48c4.4 0 8-3.6 8-8V360c0-4.4-3.6-8-8-8z"}}]},name:"pause-circle",theme:"outlined"};const ke=Se;function le(n){for(var t=1;t<arguments.length;t++){var e=arguments[t]!=null?Object(arguments[t]):{},i=Object.keys(e);typeof Object.getOwnPropertySymbols=="function"&&(i=i.concat(Object.getOwnPropertySymbols(e).filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable}))),i.forEach(function(a){Pe(n,a,e[a])})}return n}function Pe(n,t,e){return t in n?Object.defineProperty(n,t,{value:e,enumerable:!0,configurable:!0,writable:!0}):n[t]=e,n}var K=function(t,e){var i=le({},t,e.attrs);return s(A,le({},i,{icon:ke}),null)};K.displayName="PauseCircleOutlined";K.inheritAttrs=!1;const Ie=K;var Me={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M512 64C264.6 64 64 264.6 64 512s200.6 448 448 448 448-200.6 448-448S759.4 64 512 64zm0 820c-205.4 0-372-166.6-372-372s166.6-372 372-372 372 166.6 372 372-166.6 372-372 372z"}},{tag:"path",attrs:{d:"M719.4 499.1l-296.1-215A15.9 15.9 0 00398 297v430c0 13.1 14.8 20.5 25.3 12.9l296.1-215a15.9 15.9 0 000-25.8zm-257.6 134V390.9L628.5 512 461.8 633.1z"}}]},name:"play-circle",theme:"outlined"};const je=Me;function ae(n){for(var t=1;t<arguments.length;t++){var e=arguments[t]!=null?Object(arguments[t]):{},i=Object.keys(e);typeof Object.getOwnPropertySymbols=="function"&&(i=i.concat(Object.getOwnPropertySymbols(e).filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable}))),i.forEach(function(a){Ve(n,a,e[a])})}return n}function Ve(n,t,e){return t in n?Object.defineProperty(n,t,{value:e,enumerable:!0,configurable:!0,writable:!0}):n[t]=e,n}var ee=function(t,e){var i=ae({},t,e.attrs);return s(A,ae({},i,{icon:je}),null)};ee.displayName="PlayCircleOutlined";ee.inheritAttrs=!1;const ze=ee;var De={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M762 164h-64c-4.4 0-8 3.6-8 8v688c0 4.4 3.6 8 8 8h64c4.4 0 8-3.6 8-8V172c0-4.4-3.6-8-8-8zm-508 0v72.4c0 9.5 4.2 18.4 11.4 24.5L564.6 512 265.4 763.1c-7.2 6.1-11.4 15-11.4 24.5V860c0 6.8 7.9 10.5 13.1 6.1L689 512 267.1 157.9A7.95 7.95 0 00254 164z"}}]},name:"vertical-left",theme:"outlined"};const Te=De;function oe(n){for(var t=1;t<arguments.length;t++){var e=arguments[t]!=null?Object(arguments[t]):{},i=Object.keys(e);typeof Object.getOwnPropertySymbols=="function"&&(i=i.concat(Object.getOwnPropertySymbols(e).filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable}))),i.forEach(function(a){Ne(n,a,e[a])})}return n}function Ne(n,t,e){return t in n?Object.defineProperty(n,t,{value:e,enumerable:!0,configurable:!0,writable:!0}):n[t]=e,n}var te=function(t,e){var i=oe({},t,e.attrs);return s(A,oe({},i,{icon:Te}),null)};te.displayName="VerticalLeftOutlined";te.inheritAttrs=!1;const Re=te;var Ae={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M326 164h-64c-4.4 0-8 3.6-8 8v688c0 4.4 3.6 8 8 8h64c4.4 0 8-3.6 8-8V172c0-4.4-3.6-8-8-8zm444 72.4V164c0-6.8-7.9-10.5-13.1-6.1L335 512l421.9 354.1c5.2 4.4 13.1.7 13.1-6.1v-72.4c0-9.4-4.2-18.4-11.4-24.5L459.4 512l299.2-251.1c7.2-6.1 11.4-15.1 11.4-24.5z"}}]},name:"vertical-right",theme:"outlined"};const Ee=Ae;function ce(n){for(var t=1;t<arguments.length;t++){var e=arguments[t]!=null?Object(arguments[t]):{},i=Object.keys(e);typeof Object.getOwnPropertySymbols=="function"&&(i=i.concat(Object.getOwnPropertySymbols(e).filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable}))),i.forEach(function(a){He(n,a,e[a])})}return n}function He(n,t,e){return t in n?Object.defineProperty(n,t,{value:e,enumerable:!0,configurable:!0,writable:!0}):n[t]=e,n}var ne=function(t,e){var i=ce({},t,e.attrs);return s(A,ce({},i,{icon:Ee}),null)};ne.displayName="VerticalRightOutlined";ne.inheritAttrs=!1;const Be=ne;const Ue={class:"music-box"},Fe={key:0,class:"info"},qe={key:1,class:"info"},Ge=["src"],Je={class:"progress-box"},Qe={class:"ctrl"},We={class:"mode"},Xe=["title"],Ye=["src","loop"],Ze={__name:"MusicCtrl",emits:["toggleMusicList","showSearch"],setup(n,{emit:t}){const{useMusicStore:e}=F(),i=()=>{t("toggleMusicList")},a=()=>{t("showSearch")},S=q(()=>({listCycle:"列表循环",singleCycle:"单曲循环",randomPlay:"随机播放"})[e.settings.mode]),k=u=>{e.changeMode(u)},b=u=>{e.toggleMute(u)},m=M({}),$=M(0),I=M(1e3),h=M(null);W(()=>[e.activeIndex,e.settings.playing],()=>{m.value=e.musicList[e.activeIndex],G(()=>{h.value&&(I.value=parseInt(h.value.duration),h.value.volume=e.settings.volume/100,e.settings.playing&&h.value.play())})},{immediate:!0,deep:!0});const V=()=>{I.value=parseInt(h.value.duration),$.value=h.value.currentTime=e.settings.currentTime},j=u=>{const{currentTime:v,duration:D}=u.target;$.value=e.settings.currentTime=parseInt(v),I.value=parseInt(D)},r=u=>J(u),_=u=>{e.settings.currentTime=u,h.value&&G(()=>{h.value.currentTime=u})};W(()=>[e.settings.volume,e.settings.mute],()=>{h.value&&G(()=>{h.value.volume=e.settings.volume/100,h.value.muted=e.settings.mute})},{immediate:!0,deep:!0});const y=()=>{!e.musicList.length||e.activeIndex<0||(e.settings.playing=!0,h.value.play())},x=()=>{!e.musicList.length||e.activeIndex<0||(e.settings.playing=!1,h.value.pause())},O=q(()=>{if(!e.musicList.length||e.activeIndex<0)return"";let u=e.activeIndex===0?e.musicList.length-1:e.activeIndex-1;return e.musicList[u]?e.musicList[u].name:""}),L=()=>{if(!e.musicList.length||e.activeIndex<0)return;let u=e.activeIndex===0?e.musicList.length-1:e.activeIndex-1;e.playMusic(u)},E=q(()=>{if(!e.musicList.length||e.activeIndex<0)return"";let u=e.activeIndex===e.musicList.length-1?0:e.activeIndex+1;return e.musicList[u]?e.musicList[u].name:""}),z=()=>{if(!e.musicList.length||e.activeIndex<0)return;let u=e.activeIndex===e.musicList.length-1?0:e.activeIndex+1;e.playMusic(u)},H=()=>{e.settings.mode==="listCycle"?z():e.settings.mode==="singleCycle"?e.playMusic(e.activeIndex):e.settings.mode==="randomPlay"&&e.playMusic(Oe(0,e.musicList.length-1,e.activeIndex))};return(u,v)=>{var w;const D=f("a-slider"),p=f("a-tooltip");return d(),g("div",Ue,[l(e).musicList.length?(d(),g("div",qe,[o("img",{class:B(["cover",{playing:l(e).settings.playing}]),src:m.value.cover,onerror:"this.src='./images/music.png'",alt:""},null,10,Ge),N(" "+P(m.value.name)+" - "+P(m.value.singer)+" ",1),o("div",Je,[o("p",null,P(l(J)($.value)),1),s(D,{class:"play-slider",min:0,max:I.value,onChange:_,value:$.value,"onUpdate:value":v[0]||(v[0]=C=>$.value=C),tipFormatter:r},null,8,["max","value"]),o("p",null,P(l(J)(I.value)),1)])])):(d(),g("div",Fe,[N(" 暂无音乐，请选择"),o("span",{class:"add",onClick:a},"添加")])),o("div",Qe,[s(p,{title:`上一首${O.value?"：":""}${O.value}`},{default:c(()=>[s(l(Be),{onClick:L})]),_:1},8,["title"]),s(p,{title:l(e).settings.playing?"点击暂停":"点击播放"},{default:c(()=>[l(e).settings.playing?(d(),R(l(Ie),{key:1,class:"pause",onClick:x})):(d(),R(l(ze),{key:0,class:"play",onClick:y}))]),_:1},8,["title"]),s(p,{title:`下一首${E.value?"：":""}${E.value}`},{default:c(()=>[s(l(Re),{onClick:z})]),_:1},8,["title"]),s(p,{title:"播放列表"},{default:c(()=>[s(l(we),{onClick:i})]),_:1}),o("div",We,[s(p,{title:S.value},{default:c(()=>[l(e).settings.mode==="listCycle"?(d(),g("i",{key:0,class:"ifishfont ifish-musicListLoop",title:"列表循环",onClick:v[1]||(v[1]=C=>k("singleCycle"))})):T("",!0),l(e).settings.mode==="singleCycle"?(d(),g("i",{key:1,class:"ifishfont ifish-musicSingleCycle",title:"单曲循环",onClick:v[2]||(v[2]=C=>k("randomPlay"))})):T("",!0),l(e).settings.mode==="randomPlay"?(d(),g("i",{key:2,class:"ifishfont ifish-musicRandomPlay",title:"随机播放",onClick:v[3]||(v[3]=C=>k("listCycle"))})):T("",!0)]),_:1},8,["title"])]),o("div",{class:"volume",title:`当前音量：${l(e).settings.volume}`},[l(e).settings.mute||l(e).settings.volume===0?(d(),g("i",{key:0,class:"ifishfont ifish-volumeDisable",onClick:v[4]||(v[4]=C=>b(!0))})):l(e).settings.volume>=0&&l(e).settings.volume<30?(d(),g("i",{key:1,class:"ifishfont ifish-volumeLow",onClick:v[5]||(v[5]=C=>b(!1))})):l(e).settings.volume>=30&&l(e).settings.volume<60?(d(),g("i",{key:2,class:"ifishfont ifish-volumeMiddle",onClick:v[6]||(v[6]=C=>b(!1))})):(d(),g("i",{key:3,class:"ifishfont ifish-volumeHigh",onClick:v[7]||(v[7]=C=>b(!1))})),s(D,{class:"volume-slider",min:0,max:100,value:l(e).settings.volume,"onUpdate:value":v[8]||(v[8]=C=>l(e).settings.volume=C)},null,8,["value"])],8,Xe),pe(o("audio",{ref_key:"audioRef",ref:h,controls:"",src:(w=m.value)==null?void 0:w.url,loop:l(e).settings.mode==="singleCycle",onTimeupdate:j,onLoadeddata:V,onEnded:H,onError:H},null,40,Ye),[[me,!1]])])])}}},Ke=U(Ze,[["__scopeId","data-v-b775c6c3"]]);const et={class:"music-box"},tt={class:"title"},nt={class:"music-list"},st=["onClick"],it={class:"music-cover"},lt=["src"],at={class:"music-info"},ot=["onClick"],ct=["onClick"],rt=["onClick"],ut={__name:"MusicList",props:{open:{type:Boolean,default:!1}},emits:["close","showSearch"],setup(n,{emit:t}){const{useMusicStore:e}=F(),i=()=>{t("close")},a=()=>{t("showSearch")},S=m=>{e.playMusic(m)},k=m=>{m<e.activeIndex?(e.musicList.splice(m,1),e.activeIndex--):(m===e.activeIndex&&(e.settings.currentTime=0,e.activeIndex++,e.activeIndex--),e.musicList.splice(m,1))},b=m=>{ve(m.url)};return(m,$)=>{const I=f("a-input"),h=f("a-empty"),V=f("a-menu-item"),j=f("a-menu"),r=f("a-dropdown"),_=f("perfect-scrollbar"),y=f("a-drawer");return d(),R(y,{width:"80vw",title:"播放列表",placement:"right",open:n.open,onClose:i,rootClassName:"disclaimers-root"},{default:c(()=>[o("div",et,[s(I,{onClick:a,readonly:"",placeholder:"搜索",style:{"border-radius":"20px"}},{prefix:c(()=>[s(l(re))]),_:1}),o("div",null,[o("p",tt,"播放列表（共"+P(l(e).musicList.length)+"首）",1),l(e).musicList.length?T("",!0):(d(),R(h,{key:0,description:"暂无歌曲，请搜索添加"})),s(_,{class:"scroll-bar"},{default:c(()=>[o("div",nt,[(d(!0),g(X,null,Y(l(e).musicList,(x,O)=>(d(),g("div",{class:B(["music-item",{active:l(e).activeIndex===O}]),key:O,onClick:L=>S(O)},[o("div",it,[o("img",{src:x.cover,onerror:"this.src='./images/music.png'",alt:""},null,8,lt)]),o("div",at,[o("p",null,P(x.name),1),o("span",null,P(x.singer),1)]),o("div",{class:"music-action",onClick:$[0]||($[0]=ue(()=>{},["stop"]))},[s(r,{placement:"bottomLeft",arrow:""},{overlay:c(()=>[s(j,null,{default:c(()=>[s(V,null,{default:c(()=>[o("a",{href:"javascript:;",onClick:L=>S(O)},"播放",8,ot)]),_:2},1024),s(V,null,{default:c(()=>[o("a",{href:"javascript:;",onClick:L=>k(O)},"移除",8,ct)]),_:2},1024),s(V,null,{default:c(()=>[o("a",{href:"javascript:;",onClick:L=>b(x)},"下载",8,rt)]),_:2},1024)]),_:2},1024)]),default:c(()=>[s(l(de))]),_:2},1024)])],10,st))),128))])]),_:1})])])]),_:1},8,["open"])}}},dt=U(ut,[["__scopeId","data-v-5397f01c"]]);const vt=n=>(he("data-v-c8be3285"),n=n(),ye(),n),pt={class:"search"},mt={key:0,class:"search-history"},ft={class:"title"},_t={class:"search-history-box"},gt=["onClick"],ht={class:"text",title:"点击搜索"},yt={class:"search-list"},bt=vt(()=>o("p",{class:"title"},"搜索结果：",-1)),Ct=["onClick"],Ot={title:"立即播放"},$t={class:"search-action"},xt=["onClick"],Lt=["onClick"],wt=["onClick"],St=["onClick"],kt={__name:"MusicSearch",setup(n){const{useMusicStore:t}=F(),e=M(""),i=M([]),a=M(!1),S=r=>{t.searchHistory.indexOf(r)<0&&t.searchHistory.unshift(r),k(r)},k=r=>{e.value=r,a.value=!0,se.get(`https://xiaoapi.cn/API/yy_sq.php?msg=${r}`).then(_=>{i.value=_.data.list||[],a.value=!1})},b=()=>{t.searchHistory=[]},m=r=>{const _=t.searchHistory.indexOf(r);t.searchHistory.splice(_,1)},$=async(r,_)=>{const{cover:y,name:x,singer:O,url:L}=await j(r);t.musicList.push({id:Q(21),cover:y,name:x,singer:O,url:L}),t.playMusic(t.musicList.length-1)},I=async(r,_)=>{const{cover:y,name:x,singer:O,url:L}=await j(r);t.musicList.push({id:Q(21),cover:y,name:x,singer:O,url:L})},h=async(r,_)=>{const{cover:y,name:x,singer:O,url:L}=await j(r);t.musicList.splice(t.activeIndex,0,{id:Q(21),cover:y,name:x,singer:O,url:L})},V=async(r,_)=>{const{url:y}=await j(r);y&&ve(y)},j=async(r,_)=>{const{data:y}=await se.get(`https://xiaoapi.cn/API/yy_sq.php?msg=${r.name}-${r.singer}&n=1`);return y.code===200?y:(ge({type:"warning",content:y.msg}),{})};return(r,_)=>{const y=f("a-input"),x=f("a-col"),O=f("a-button"),L=f("a-row"),E=f("a-empty"),z=f("a-menu-item"),H=f("a-menu"),u=f("a-dropdown"),v=f("perfect-scrollbar"),D=f("a-spin");return d(),g("div",pt,[s(L,{gutter:12},{default:c(()=>[s(x,{span:20},{default:c(()=>[s(y,{value:e.value,"onUpdate:value":_[0]||(_[0]=p=>e.value=p),onPressEnter:_[1]||(_[1]=p=>S(p.target.value)),placeholder:"输入歌曲、歌手",allowClear:"",style:{"border-radius":"16px"}},{prefix:c(()=>[s(l(re))]),_:1},8,["value"])]),_:1}),s(x,{span:3},{default:c(()=>[s(O,{type:"primary",shape:"round",onClick:_[2]||(_[2]=p=>S(e.value))},{default:c(()=>[N("搜索")]),_:1})]),_:1})]),_:1}),l(t).searchHistory.length?(d(),g("div",mt,[o("p",ft,[N("搜索历史： "),o("span",{class:"clear",onClick:b},[s(l(fe)),N("清空历史搜索")])]),o("div",_t,[(d(!0),g(X,null,Y(l(t).searchHistory,(p,w)=>(d(),g("p",{key:w,onClick:C=>k(p)},[o("span",ht,P(p),1),s(l(_e),{title:"点击移除",onClick:ue(C=>m(p),["stop"])},null,8,["onClick"])],8,gt))),128))])])):T("",!0),o("div",yt,[bt,s(D,{spinning:a.value,tip:"加载中..."},{default:c(()=>[s(v,{class:"scroll-bar"},{default:c(()=>[i.value.length?T("",!0):(d(),R(E,{key:0})),o("ul",null,[(d(!0),g(X,null,Y(i.value,(p,w)=>(d(),g("li",{key:w,onClick:C=>$(p,w)},[o("p",Ot,P(p.name)+" - "+P(p.singer),1),o("div",$t,[s(u,{placement:"bottomLeft",arrow:""},{overlay:c(()=>[s(H,null,{default:c(()=>[s(z,null,{default:c(()=>[o("a",{href:"javascript:;",onClick:C=>I(p,w)},"添加到播放列表",8,xt)]),_:2},1024),s(z,null,{default:c(()=>[o("a",{href:"javascript:;",onClick:C=>$(p,w)},"立即播放",8,Lt)]),_:2},1024),s(z,null,{default:c(()=>[o("a",{href:"javascript:;",onClick:C=>h(p,w)},"下一首播放",8,wt)]),_:2},1024),s(z,null,{default:c(()=>[o("a",{href:"javascript:;",onClick:C=>V(p,w)},"下载",8,St)]),_:2},1024)]),_:2},1024)]),default:c(()=>[s(l(de))]),_:2},1024)])],8,Ct))),128))])]),_:1})]),_:1},8,["spinning"])])])}}},Pt=U(kt,[["__scopeId","data-v-c8be3285"]]);const It={class:"music"},Mt=["title"],jt={__name:"Index",setup(n){const{useMusicStore:t}=F();be(()=>{t.settings.playing=!1});const e=()=>{t.toggleVisible()},i=M(!1);W(()=>t.visible,k=>{},{immediate:!0});const a=M(!1),S=()=>{a.value=!0};return(k,b)=>{const m=f("IDialog");return d(),g("div",It,[o("div",{class:B(["toggle-icon bf",[l(t).visible?"down":"up"]]),title:l(t).visible?"关闭播放器":"打开播放器",onClick:e},[s(l(Ce))],10,Mt),o("div",{class:B(["music-ctrl bf",[l(t).visible?"show":""]])},[s(Ke,{onShowSearch:S,onToggleMusicList:b[0]||(b[0]=$=>i.value=!i.value)})],2),s(dt,{open:i.value,onShowSearch:S,onClose:b[1]||(b[1]=$=>i.value=!1)},null,8,["open"]),s(m,{title:"搜索音乐",visible:a.value,zIndex:1002,onOk:b[2]||(b[2]=$=>a.value=!1),onCancel:b[3]||(b[3]=$=>a.value=!1)},{default:c(()=>[s(Pt)]),_:1},8,["visible"])])}}},Dt=U(jt,[["__scopeId","data-v-000cb98a"]]);export{Dt as default};
