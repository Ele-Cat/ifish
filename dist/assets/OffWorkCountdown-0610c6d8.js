import{q as C,E as S,b as o,w as I,r as l,h as c,i as w,s as u,D as B,B as y,j as s,k as d,F as E,t as N,C as O,z as H,M as U,N as j}from"./index-fbf18cb4.js";import{_ as A,u as F,c as $}from"./App-692a8045.js";const q=i=>(U("data-v-3282dd9c"),i=i(),j(),i),z={class:"offwork-text"},L={key:0},M=q(()=>u("img",{src:"https://tucdn.wpon.cn/2024/05/28/d895272cf7406.png",alt:""},null,-1)),R={__name:"OffWorkCountdown",setup(i){const{useAppStore:t}=F(),k=C(!1),W=S(["周日","周一","周二","周三","周四","周五","周六"]),a=S({workDays:t.offWorkCountdown.workDays,workTimeStart:t.offWorkCountdown.workTimeStart?o(t.offWorkCountdown.workTimeStart,"HH:mm"):null,workTimeEnd:t.offWorkCountdown.workTimeEnd?o(t.offWorkCountdown.workTimeEnd,"HH:mm"):null}),m=C("");let p=null;const g=()=>{p&&clearInterval(p)};return I(()=>a,n=>{let e="点击配置";g(),n.workTimeEnd?(t.offWorkCountdown.workTimeStart=o(n.workTimeStart).format("HH:mm"),t.offWorkCountdown.workTimeEnd=o(n.workTimeEnd).format("HH:mm"),p=setInterval(()=>{if(t.offWorkCountdown.workDays[o().day()])if(o().isBefore(o(n.workTimeStart)))e="还没上班呢~";else if(o().isAfter(o(n.workTimeEnd)))e="已经下班啦~";else{const _=o(n.workTimeEnd),f=o();e=$(_.diff(f))}else e="今天是休息日~";m.value=e},1e3)):t.offWorkCountdown.workTimeEnd=null,n.workTimeStart||(t.offWorkCountdown.workTimeStart=null),m.value=e},{immediate:!0,deep:!0}),(n,e)=>{const _=l("a-checkable-tag"),f=l("a-form-item"),v=l("a-time-picker"),h=l("a-space"),D=l("a-form"),b=l("IDialog");return c(),w(E,null,[u("div",{class:"offwork",onClick:e[0]||(e[0]=r=>k.value=!0)},[u("div",z,[m.value.indexOf(":")>=0?(c(),w("p",L,"距离下班时间还有")):B("",!0),u("p",null,y(m.value),1)]),M]),s(b,{title:"配置",width:480,visible:k.value,onCancel:e[3]||(e[3]=r=>k.value=!1)},{default:d(()=>[s(D,{model:a,layout:"vertical",style:{"padding-top":"20px"}},{default:d(()=>[s(f,{label:"选择工作日"},{default:d(()=>[(c(!0),w(E,null,N(W,(r,T)=>(c(),O(_,{key:r,checked:a.workDays[T],"onUpdate:checked":x=>a.workDays[T]=x},{default:d(()=>[H(y(r),1)]),_:2},1032,["checked","onUpdate:checked"]))),128))]),_:1}),s(f,{label:"上下班时间"},{default:d(()=>[s(h,null,{default:d(()=>[s(v,{value:a.workTimeStart,"onUpdate:value":e[1]||(e[1]=r=>a.workTimeStart=r),placeholder:"上班时间","minute-step":10,format:"HH:mm"},null,8,["value"]),H("~ "),s(v,{value:a.workTimeEnd,"onUpdate:value":e[2]||(e[2]=r=>a.workTimeEnd=r),placeholder:"下班时间","minute-step":10,format:"HH:mm"},null,8,["value"])]),_:1})]),_:1})]),_:1},8,["model"])]),_:1},8,["visible"])],64)}}},K=A(R,[["__scopeId","data-v-3282dd9c"]]);export{K as default};
